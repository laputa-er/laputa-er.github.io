<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>3 音频视频处理 | Laputa</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="do things for fun">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="3 音频视频处理 | Laputa">
    <meta name="twitter:description" content="do things for fun">

    <meta property="og:type" content="article">
    <meta property="og:title" content="3 音频视频处理 | Laputa">
    <meta property="og:description" content="do things for fun">

    
    <meta name="author" content="Sean">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/favicon.png">
    

    <meta name="generator" content="hexo"/>
    

    <link rel="canonical" href="http://laputa-er.github.io/2016/05/14/JK_IOS高级_3  音频视频处理/"/>

    
</head>

<body class="home-template no-js">

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/mengxiang.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
      <span class="panel-arrow panel-left-arrow disabled">
        <i class="fa fa-angle-left"></i>
      </span>
      <span class="panel-arrow panel-right-arrow">
        <i class="fa fa-angle-right"></i>
      </span>

      <div class="panel-animation-container">
        <div class="panel-content panel-main__content">
            <a href="/" title="前往 Laputa 的主页"><img src="/images/logo2.jpg" width="80" alt="Laputa logo" class="panel-cover__logo logo" /></a>
            <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for Laputa">Laputa</a></h1>
            
            <span class="panel-cover__subtitle panel-subtitle">已然在路上</span>
            
            <hr class="panel-cover__divider" />
            <p class="panel-cover__description">If you can not act the way you want to live, you will one day live in accordance with the way to think about.</p>
            <hr class="panel-cover__divider panel-cover__divider--secondary" />

            <div class="navigation-wrapper">
              <div>
              <nav class="cover-navigation cover-navigation--primary">
                <ul class="navigation">
                  <li class="navigation__item"><a href="/#blog" title="访问笔记" class="blog-button">笔记</a></li>
                  <li style="display: none;">
                    <textarea>
                      
                        <li class="navigation__item"><a href="/projects">项目作品</a></li>
                      
                        <li class="navigation__item"><a href="/aboutme">关于我</a></li>
                      
                    </textarea>
                  </li>
                </ul>
              </nav>
              </div>
              <div>
              <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  

  <!-- Github -->
  

<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  

<!-- Facebook -->

  
<!-- Twitter -->

  



  </ul>
</nav>

              </div>
            </div>

          </div>
          <div class="panel-content panel-tagcloud_content">
            
              <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">笔记分类</h3>
    <div class="widget tagcloud">
      <a href="/tags/Objective-C基础教程第二版/">Objective-C基础教程第二版</a> <a href="/tags/The-Swift-Program-Language-2/">The Swift Program Language 2</a> <a href="/tags/c语言程序设计－现代方法/">c语言程序设计－现代方法</a> <a href="/tags/极客学院-ios中级/">极客学院_ios中级</a> <a href="/tags/极客学院-ios初级/">极客学院_ios初级</a> <a href="/tags/极客学院-ios高级/">极客学院_ios高级</a>
    </div>
  </div>

  
</aside>
            
          </div>
        </div>  

      </div>
      <div class="panel-cover--overlay cover-blue"></div>
  </div>
  </header>
    
    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2016-05-14T01:03:52.000Z" class="post-list__meta--date date">2016-05-14</time> &#8226; <span class="post-meta__tags tags">于&nbsp;
  <a class="tag-link" href="/tags/极客学院-ios高级/">极客学院_ios高级</a>
</span>
    </div>
    <h1 class="post-title">3 音频视频处理</h1>
  </header>

  <section class="post">
    <!-- Table of Contents -->
    
    <div id="top-toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-iOS-API视频的播放和录制"><span class="toc-number">1.</span> <span class="toc-text">3.1    iOS API视频的播放和录制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-播放视频"><span class="toc-number">1.1.</span> <span class="toc-text">3.1.1    播放视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-录制视频"><span class="toc-number">1.2.</span> <span class="toc-text">3.1.2    录制视频</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-iOS音频相关-API-的使用"><span class="toc-number">2.</span> <span class="toc-text">3.2    iOS音频相关 API 的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-播放声音"><span class="toc-number">2.1.</span> <span class="toc-text">3.2.1    播放声音</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-播放乐库音乐"><span class="toc-number">2.2.</span> <span class="toc-text">3.2.2    播放乐库音乐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-录制声音"><span class="toc-number">2.3.</span> <span class="toc-text">3.2.3    录制声音</span></a></li></ol></li></ol>
    </div>
    <div id="tocShell"></div>
    <div id="toc" class="toc-article">
      <div class="btn-group drag-me">
        <i class="social fa fa-ellipsis-v"></i>
      </div>
      <div class="btn-group dropup-catelog">
        <button class="btn"><i class="social fa fa-list-ol"></i></button>
        <div class="catelog-content">
          <p class="toc-title-wrap">
            <strong class="toc-title">文章目录</strong>
          </p>
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-iOS-API视频的播放和录制"><span class="toc-number">1.</span> <span class="toc-text">3.1    iOS API视频的播放和录制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-播放视频"><span class="toc-number">1.1.</span> <span class="toc-text">3.1.1    播放视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2-录制视频"><span class="toc-number">1.2.</span> <span class="toc-text">3.1.2    录制视频</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-iOS音频相关-API-的使用"><span class="toc-number">2.</span> <span class="toc-text">3.2    iOS音频相关 API 的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-播放声音"><span class="toc-number">2.1.</span> <span class="toc-text">3.2.1    播放声音</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-播放乐库音乐"><span class="toc-number">2.2.</span> <span class="toc-text">3.2.2    播放乐库音乐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3-录制声音"><span class="toc-number">2.3.</span> <span class="toc-text">3.2.3    录制声音</span></a></li></ol></li></ol>
        </div>
      </div>
    </div>
    
    <h2 id="3-1-iOS-API视频的播放和录制"><a href="#3-1-iOS-API视频的播放和录制" class="headerlink" title="3.1    iOS API视频的播放和录制"></a>3.1    iOS API视频的播放和录制</h2><blockquote>
<p><strong>注意：</strong><code>MPMoviePlayerViewController</code>在<code>iOS9中</code>过时了</p>
</blockquote>
<h3 id="3-1-1-播放视频"><a href="#3-1-1-播放视频" class="headerlink" title="3.1.1    播放视频"></a>3.1.1    播放视频</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/JK_IOS_video1.gif" alt="Alt text|200x350"></p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MediaPlayer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> pc:<span class="type">MPMoviePlayerViewController</span>!</span><br><span class="line"></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">playVideoBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        </span><br><span class="line">        pc = <span class="type">MPMoviePlayerViewController</span>(contentURL: <span class="type">NSBundle</span>.mainBundle().<span class="type">URLForResource</span>(<span class="string">"video"</span>, withExtension: <span class="string">"mp4"</span>))</span><br><span class="line">        presentViewController(pc, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-1-2-录制视频"><a href="#3-1-2-录制视频" class="headerlink" title="3.1.2    录制视频"></a>3.1.2    录制视频</h3><blockquote>
<p><strong>注意：</strong> xcode 的虚拟机不支持使用相机，模拟使用相机只能选择真机！<br><strong>技巧：</strong>调试时可以通过<code>window-&gt;Devices</code>，在设备管理面板选择要管理的设备进行操作（比如截屏）。</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MobileCoreServices<span class="comment">// 录制视频使用到的库</span></span><br><span class="line"><span class="keyword">import</span> MediaPlayer<span class="comment">// 播放视频用到的库</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">UIImagePickerControllerDelegate</span>, <span class="title">UINavigationControllerDelegate</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 图片选择器</span></span><br><span class="line">    <span class="keyword">var</span> picker:<span class="type">UIImagePickerController</span>!<span class="comment">// 可以选择从图库或摄像头中选择图片或视频（源为摄像头意味着拍照或视频）</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> videoUrl:<span class="type">NSURL</span>?</span><br><span class="line">    <span class="keyword">var</span> player:<span class="type">MPMoviePlayerViewController</span>!</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始录制</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">recVideoBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        picker = <span class="type">UIImagePickerController</span>()</span><br><span class="line">        picker.mediaTypes = [kUTTypeMovie <span class="keyword">as</span> <span class="type">String</span>]</span><br><span class="line">        picker.sourceType = <span class="type">UIImagePickerControllerSourceType</span>.<span class="type">Camera</span><span class="comment">// 设置源通过摄像头</span></span><br><span class="line">        picker.cameraCaptureMode = <span class="type">UIImagePickerControllerCameraCaptureMode</span>.<span class="type">Video</span><span class="comment">// 设置摄像头为录制视频模式</span></span><br><span class="line">        picker.delegate = <span class="keyword">self</span></span><br><span class="line">        presentViewController(picker, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始播放</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">playVideoBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> url = videoUrl &#123;</span><br><span class="line">            player = <span class="type">MPMoviePlayerViewController</span>(contentURL: url)</span><br><span class="line">            presentViewController(player, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 选中了视频时（录制完成后）被调用</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">imagePickerController</span><span class="params">(picker: UIImagePickerController, didFinishPickingImage image: UIImage, editingInfo: [String : AnyObject]?)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 获取录制好的视频资源的url地址</span></span><br><span class="line">        videoUrl = editingInfo![<span class="type">UIImagePickerControllerMediaURL</span>] <span class="keyword">as</span>? <span class="type">NSURL</span></span><br><span class="line">        <span class="comment">// 关闭录制视频的视图控制器</span></span><br><span class="line">        picker.dismissViewControllerAnimated(<span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 取消录制视频时被调用</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">imagePickerControllerDidCancel</span><span class="params">(picker: UIImagePickerController)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 关闭录制视频的视图控制器</span></span><br><span class="line">        picker.dismissViewControllerAnimated(<span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-2-iOS音频相关-API-的使用"><a href="#3-2-iOS音频相关-API-的使用" class="headerlink" title="3.2    iOS音频相关 API 的使用"></a>3.2    iOS音频相关 API 的使用</h2><h3 id="3-2-1-播放声音"><a href="#3-2-1-播放声音" class="headerlink" title="3.2.1    播放声音"></a>3.2.1    播放声音</h3><blockquote>
<p><strong>说明：</strong>给出两种方式</p>
<ul>
<li>使用<code>AVAudioPlayer</code>播放音乐文件</li>
<li>使用<code>MediaPlayer</code>播放音乐</li>
</ul>
</blockquote>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> AVFoundation</span><br><span class="line"><span class="keyword">import</span> MediaPlayer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> aPlayer:<span class="type">AVAudioPlayer</span>!</span><br><span class="line">    <span class="comment">// 播放</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">playBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        aPlayer.play()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 暂定</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">pauseBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        aPlayer.pause()<span class="comment">// 暂停后音乐仍然处在准备播放的状态</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 停止</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">stopBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        aPlayer.stop()<span class="comment">// 通知后音乐不会处在准备播放状态，但会记住停止时的位置</span></span><br><span class="line">        aPlayer.currentTime = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 另一种方式播放音乐</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">playSongBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 初始化播放控制器</span></span><br><span class="line">        <span class="keyword">let</span> p = <span class="type">MPMoviePlayerViewController</span>(contentURL: <span class="type">NSURL</span>(fileURLWithPath: <span class="type">NSBundle</span>.mainBundle().pathForResource(<span class="string">"sound"</span>, ofType: <span class="string">"mp3"</span>)!))</span><br><span class="line">        <span class="comment">// 开始播放</span></span><br><span class="line">        presentViewController(p, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="comment">// 初始化 AVAudioPlayer</span></span><br><span class="line">            aPlayer = <span class="keyword">try</span> <span class="type">AVAudioPlayer</span>(contentsOfURL: <span class="type">NSURL</span>(fileURLWithPath: <span class="type">NSBundle</span>.mainBundle().pathForResource(<span class="string">"sound"</span>, ofType: <span class="string">"mp3"</span>)!))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"failed"</span>)</span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-2-2-播放乐库音乐"><a href="#3-2-2-播放乐库音乐" class="headerlink" title="3.2.2    播放乐库音乐"></a>3.2.2    播放乐库音乐</h3><blockquote>
<p><strong>说明：</strong>要点如下</p>
<ol>
<li>（<code>ViewController</code>）采纳<code>MPMediaPickerControllerDelegate</code>协议</li>
<li>初始化媒体选择控制器（<code>MPMediaPickerController</code>）和音乐播放控制器（<code>MPMusicPlayerController</code>）</li>
<li>实现采纳协议的相关方法</li>
</ol>
<p><strong>注意：</strong>在虚拟机中是不能使用音乐库的</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MediaPlayer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">MPMediaPickerControllerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> picker:<span class="type">MPMediaPickerController</span>!<span class="comment">// 选择音乐控制器</span></span><br><span class="line">    <span class="keyword">var</span> player:<span class="type">MPMusicPlayerController</span>!<span class="comment">// 播放音乐控制器</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 选择音乐</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">btnSelectMusicClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        presentViewController(picker, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 选择音乐完成后调用</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mediaPicker</span><span class="params">(mediaPicker: MPMediaPickerController, didPickMediaItems mediaItemCollection: MPMediaItemCollection)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 关闭视频选择控制器</span></span><br><span class="line">        mediaPicker.dismissViewControllerAnimated(<span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">        <span class="comment">// 将选中的音乐加入到播放列表</span></span><br><span class="line">        player.setQueueWithItemCollection(mediaItemCollection)</span><br><span class="line">        <span class="comment">// 开始播放</span></span><br><span class="line">        player.play()</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 获取选中的第一首歌的名字</span></span><br><span class="line">        <span class="keyword">let</span> firstName:<span class="type">AnyObject</span> = mediaItemCollection.items[<span class="number">0</span>].valueForProperty(<span class="type">MPMediaItemPropertyTitle</span>)!</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\(firstName)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 取消播放时调用</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mediaPickerDidCancel</span><span class="params">(mediaPicker: MPMediaPickerController)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Cancel"</span>)</span><br><span class="line">        mediaPicker.dismissViewControllerAnimated(<span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">        picker = <span class="type">MPMediaPickerController</span>(mediaTypes: <span class="type">MPMediaType</span>.<span class="type">Music</span>)</span><br><span class="line">        picker.allowsPickingMultipleItems = <span class="literal">true</span><span class="comment">// 可以选择多个</span></span><br><span class="line">        picker.delegate = <span class="keyword">self</span></span><br><span class="line">        </span><br><span class="line">        player = <span class="type">MPMusicPlayerController</span>.systemMusicPlayer()<span class="comment">// 创建全局音乐播放器(程序退出后仍可以播放)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-2-3-录制声音"><a href="#3-2-3-录制声音" class="headerlink" title="3.2.3    录制声音"></a>3.2.3    录制声音</h3><blockquote>
<p><strong>疑问：</strong>下面程序找到的<code>Documents</code>文件夹路径不可用，竟然在<code>Library</code>下面，但下面其实没有<code>Documents</code></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#file:///Users/tonyearth/Library/Developer/CoreSimulator/Devices/5A05DBF7-F5EC-4B5B-ABF0-EA396DA417DB/data/Containers/Data/Application/3483064B-0B9F-4E73-B193-D0829300D43E/Library/Documentation/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$cd</span> /Users/tonyearth/Library/Developer/CoreSimulator/Devices/5A05DBF7-F5EC-4B5B-ABF0-EA396DA417DB/data/Containers/Data/Application/3483064B-0B9F-4E73-B193-D0829300D43E</span><br><span class="line"></span><br><span class="line">$ tree</span><br><span class="line">.</span><br><span class="line">├── Documents</span><br><span class="line">├── Library</span><br><span class="line">│   ├── Caches</span><br><span class="line">│   │   └── Snapshots</span><br><span class="line">│   │       └── com.earth.L0204-----</span><br><span class="line">│   │           ├── 50998B49-4017-4DAA-A8BB-49F0A32325DD@2x.png</span><br><span class="line">│   │           └── C0EB8483-DCD1-41F9-8F4D-1AADC05666E1@2x.png</span><br><span class="line">│   └── Preferences</span><br><span class="line">└── tmp</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> AVFoundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> avRec:<span class="type">AVAudioRecorder</span>!<span class="comment">// 录音器</span></span><br><span class="line">    <span class="keyword">var</span> audioFileUrl:<span class="type">NSURL</span>!<span class="comment">// 保存地址</span></span><br><span class="line">    <span class="keyword">var</span> avPlayer:<span class="type">AVAudioPlayer</span>!<span class="comment">// 播放器</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 开始录音</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">startRectBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"start rec"</span>)</span><br><span class="line">        avRec.record()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 停止录音</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">stopRecBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"stop rec"</span>)</span><br><span class="line">        avRec.stop()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 播放音乐</span></span><br><span class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">playRectBtnClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"play rec：\(audioFileUrl)"</span>)</span><br><span class="line">        avPlayer = <span class="keyword">try</span>? <span class="type">AVAudioPlayer</span>(contentsOfURL: audioFileUrl)</span><br><span class="line">        avPlayer.prepareToPlay()</span><br><span class="line">        avPlayer.play()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></span><br><span class="line">        audioFileUrl = (<span class="type">NSFileManager</span>.defaultManager().<span class="type">URLsForDirectory</span>(<span class="type">NSSearchPathDirectory</span>.<span class="type">DocumentationDirectory</span>, inDomains: <span class="type">NSSearchPathDomainMask</span>.<span class="type">AllDomainsMask</span>)[<span class="number">0</span>] <span class="keyword">as</span> <span class="type">NSURL</span>).<span class="type">URLByAppendingPathComponent</span>(<span class="string">"rec"</span>)</span><br><span class="line">        avRec = <span class="keyword">try</span>? <span class="type">AVAudioRecorder</span>(<span class="type">URL</span>: audioFileUrl,</span><br><span class="line">                                        settings: [:])</span><br><span class="line">        avRec.prepareToRecord()</span><br><span class="line"><span class="comment">// 查看文件路径</span></span><br><span class="line">        <span class="keyword">let</span> sp = <span class="type">NSFileManager</span>.defaultManager().<span class="type">URLsForDirectory</span>(<span class="type">NSSearchPathDirectory</span>.<span class="type">DocumentationDirectory</span>, inDomains: <span class="type">NSSearchPathDomainMask</span>.<span class="type">AllDomainsMask</span>)</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> sp &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\(item)"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

  </section>

</article>




            <footer class="footer">
    <span class="footer__copyright">
        本站点采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
    </span>
    <span class="footer__copyright">
        基于 <a href="http://hexo.io">Hexo</a> 搭建，感谢 <a href="https://pages.github.com/">GitHub Pages</a> 提供免费的托管服务
    </span>
    <span class="footer__copyright">
        &copy; 2016 - 
        本站修改自<a href="https://github.com/lenbo-ma/hexo-theme-vno" target="_blank">hexo-theme-vno</a>
    </span>
</footer>

        </div>
    </div>

    <script src="http://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>

     
</body>
</html>
