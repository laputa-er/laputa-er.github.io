<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="MongoDB,ReactNative,nodejs," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="课程网址
0 课程介绍0.1 谁需要这门课程？课程价值
即将工作，需要一个足够打动面试官的求职作品。
职业发展遇到瓶颈，需要一个打通前后端任督二脉的超车技术栈。
想独立创业，但公司技术人员有限，需要一种能力通吃前后端开发。

适用人群

0.2 实战项目介绍完整的 APP 开发流程

0.3 APP 功能介绍桌面图标和启动画面
过度页面和轮播效果
注册登录和账户管理  
视频的配音制作页面
​">
<meta property="og:type" content="article">
<meta property="og:title" content="React Native 贯穿全栈开发 APP">
<meta property="og:url" content="http://laputa-er.github.io/2017/05/01/慕课网/imooc_React-Native-贯穿全栈开发-APP/index.html">
<meta property="og:site_name" content="Sean">
<meta property="og:description" content="课程网址
0 课程介绍0.1 谁需要这门课程？课程价值
即将工作，需要一个足够打动面试官的求职作品。
职业发展遇到瓶颈，需要一个打通前后端任督二脉的超车技术栈。
想独立创业，但公司技术人员有限，需要一种能力通吃前后端开发。

适用人群

0.2 实战项目介绍完整的 APP 开发流程

0.3 APP 功能介绍桌面图标和启动画面
过度页面和轮播效果
注册登录和账户管理  
视频的配音制作页面
​">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-882D0CDB-DB4D-4AC5-B1A1-92C80B1CFB19.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-AED8B097-DB89-4C53-8CB2-E3139B18D44A.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-570D9EFE-A0CC-469F-BCA4-91C211CA3979.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-2F3BB186-3327-4570-9A2E-E5A045F7B577.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-18A3986C-D085-4AB6-9ADF-840A6F430F78.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-130F9764-04B8-4F04-9ED5-AF3AB490607C.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-52A268EC-E64E-4474-9165-F49A79918AAD.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-F9E03C12-AB29-4BC0-85DD-39C1CD318FCD.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-D01D4730-8B82-4239-BBE2-36F344EC6C70.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-673134D8-1109-491F-8847-F350D1C15D21.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-DDB6085D-A10F-4F77-B3DD-88CA39E4B307.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-1AC37DB1-5952-4F98-948A-652E76AA26F1.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-9D5AE200-A2A3-493F-98F7-E556D9A0E7F6.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-F5A2E11D-8BCE-41F9-910B-ED6ED175665A.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-CAE44957-D7E2-49C9-9AFF-C62A01C947BD.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-A91AFC02-5CD0-4503-9F50-0D7FD254E490.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-557CE284-84C8-48C0-912E-B785D565264F.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-17B2329A-63D9-4F63-B913-719BD59CFE20.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-5B6CDA95-0E79-4BA9-923F-71673D97C9F9.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-B37DFE6F-B67F-4087-B827-0BD00621E4EA.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-5A927112-FBB2-4237-87DA-552ED6984037.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-535E8284-335C-4DB4-9652-BDA122A9F6EB.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-FFAA5529-FE25-4BD1-AC20-0A77ECD232E4.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-9598C18F-AC6B-4711-BD81-CE085B720691.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-DBAAAD84-B012-49AD-A19A-D3CE9237EEE3.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-ADD36C2F-99A1-4216-95F8-48D2BB0F210A.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-BA5FE45C-6DD0-49FE-9737-3E22901464AF.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-10-39579D57-7B5C-49D2-B860-0C852E5DC9E6.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-10-0B4E47F3-1143-419B-8205-1D7AC00E4C8D.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-4DCEEEE1-4B7D-44BB-8E04-8A5FFEFE3F64.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-25C37AA9-39B8-4473-98DA-53673A993F2C.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-7581DC8D-FC75-4CE0-9A7F-03A0576598E5.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-FB3C5ECD-85BE-4DE6-9D1C-1CEEEFE66648.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-5EE7ACF3-2FDB-491C-AA39-A981B0FADF9E.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-88901F07-9679-4B04-ABB9-8367DCF60E4D.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-62E6F933-DEDF-4B80-8D65-823FA7569057.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-9FC5DD40-F8B2-4DCA-A225-09BA3F63AAFC.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-EC2B84EF-FDA1-4C15-8066-760CA1D96BE3.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-F507C0C1-45D1-4027-BE25-C364B8125CE5.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-D49EBA1A-7626-49FF-9346-83D5A5B8D8D1.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-2E271031-FFC4-40B9-9D0B-DB01613B85E8.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-8F9195B0-DF0D-43DB-8D1E-7C0B7D336ACC.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-3501449C-9A19-49EA-B726-D6FAEB9CF951.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-0F99F927-3486-4087-9003-EDB6D5E67F8E.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-D49EBA1A-7626-49FF-9346-83D5A5B8D8D1.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-614E0AEB-15F3-484F-8BBE-14D57E2A54A8.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-9B23DCB1-CE53-45DF-BF53-95F3640FAF02.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-8ED42960-E255-4E4F-B77D-AF81B3DAC6F6.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-B1F170F2-BD34-4B34-ACB2-D18C948BCBCF.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-708E7778-BACE-4086-99C5-D2175D23BFEF.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-C4A2C36C-4E7A-43C4-BF47-6902EB43028F.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-FDD9C85D-6D12-4D46-AA2D-4140F3E22ADB.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-9E15FAF0-4397-418C-BE0E-D177ABB003BA.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-C88BC6E4-8DDC-4492-9101-0FA459384A9F.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-B6D9792B-84CC-4A93-8B3E-AA17DA78ABDB.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-dig_talk_list.gif">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-8F5A96B4-7D69-407D-836F-448F87C2040F.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-E6892C1C-FDCF-4C0B-A10B-F0F83F4186C6.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-CC8BA961-F966-4B0C-BBCC-59E454E9794F.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-3FB67D4A-A0ED-49AD-9873-209D0C05FA0B.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-3297081A-DCD1-4CB1-85B2-AE09391D60D0.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-CA41CECC-BD8C-44B4-A089-0C1FDD807CF3.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-navigate_from_list_to_detail.gif">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-1B3A7CAD-DBEC-4669-95AD-DDC92206FB03.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-1EBF2D97-BC73-44B1-8603-6AFD12601ED7.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-C302B147-4C39-4B10-B7B1-470758992807.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-9EE0C411-9DAE-422B-A349-9309C8CBE507.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-EA055CC9-F6FF-4047-A891-A41A76302A0A.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-6CF1C956-66FF-4347-AE7F-1F99D564D36D.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-D6A29161-9413-438F-81D7-5E6FDA5AEC50.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-D58D76CE-3E13-4090-95F1-ABC1799EDD95.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-BB444226-6690-4063-AA7C-D31047EAB84F.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-84E70B6A-82A4-4E05-A8E2-E9E6E16B2C3C.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-834EA6C8-DEF9-41D0-BAC7-8EB7DF02A54B.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-C901DF12-E053-400D-B314-7B500473706B.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-B3B9A8EB-0651-4C97-A7A5-4647B4EAAD70.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-2954407D-CC97-40AF-AB7F-58EF436BA678.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-520EFCE0-6500-4B8A-8487-672A09457A84.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-2B9F739E-2C27-4FEB-A5DD-6EEEB6D818BA.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-93C08351-31F6-40C4-B208-A87255889259.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-B6539CF5-B6AA-4F64-B64C-D562B1401E9C.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-F948F4E2-D122-4224-A4BC-01D55FB84763.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-CEBB97A5-3C64-4EAF-A1AB-E9A96DC31F79.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-D758664D-50B0-4D05-9FAC-F0ED2AF61EBA.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-2A2EE967-F031-4983-AA3A-4BA8129F529E.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-752FD120-9182-456E-9803-A7651ADF4DB7.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-7DEE610A-EEC2-4962-A55A-DC69C9A4E8F3.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-06A34D33-B556-43A7-B417-EBA2B557B443.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-16-92F80514-7EE1-439A-BA4C-77F915B1BF8D.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-21-C9BDDE9C-DAB5-4939-B7F5-31E8B337C5BB.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-25-7EE44700-7980-4222-8195-FF44685DE6B2.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-F6CF9482-1C97-4EB8-B747-587D15CBEF39.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-B11C2C42-8E91-4B50-8190-79806B7CC84C.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-A07E9217-B50D-4030-953B-A5AF0D1585A4.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-CFAEDF54-24C6-493A-9EF3-505795880056.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-5DEF9FE5-504B-4222-86F4-A21A02DF8E16.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-30-6C92A268-6A76-487C-A70F-D221F743E5B8.png">
<meta property="og:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-31-60254477-FCA7-4E96-945C-FAB63847C73C.png">
<meta property="og:updated_time" content="2017-06-01T18:45:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="React Native 贯穿全栈开发 APP">
<meta name="twitter:description" content="课程网址
0 课程介绍0.1 谁需要这门课程？课程价值
即将工作，需要一个足够打动面试官的求职作品。
职业发展遇到瓶颈，需要一个打通前后端任督二脉的超车技术栈。
想独立创业，但公司技术人员有限，需要一种能力通吃前后端开发。

适用人群

0.2 实战项目介绍完整的 APP 开发流程

0.3 APP 功能介绍桌面图标和启动画面
过度页面和轮播效果
注册登录和账户管理  
视频的配音制作页面
​">
<meta name="twitter:image" content="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-882D0CDB-DB4D-4AC5-B1A1-92C80B1CFB19.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://laputa-er.github.io/2017/05/01/慕课网/imooc_React-Native-贯穿全栈开发-APP/"/>

  <title> React Native 贯穿全栈开发 APP | Sean </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?898688f51c5a3d6b37dd23e04441e5bd";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Sean</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">笔记分享</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                React Native 贯穿全栈开发 APP
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-05-01T19:40:00+08:00" content="2017-05-01">
              2017-05-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/慕课网学习笔记/" itemprop="url" rel="index">
                    <span itemprop="name">慕课网学习笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/05/01/慕课网/imooc_React-Native-贯穿全栈开发-APP/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/01/慕课网/imooc_React-Native-贯穿全栈开发-APP/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="http://coding.imooc.com/class/56.html" target="_blank" rel="external">课程网址</a></p>
<h1 id="0-课程介绍"><a href="#0-课程介绍" class="headerlink" title="0 课程介绍"></a>0 课程介绍</h1><h2 id="0-1-谁需要这门课程？"><a href="#0-1-谁需要这门课程？" class="headerlink" title="0.1 谁需要这门课程？"></a>0.1 谁需要这门课程？</h2><p><strong>课程价值</strong></p>
<p>即将工作，需要一个足够打动面试官的求职作品。</p>
<p>职业发展遇到瓶颈，需要一个打通前后端任督二脉的超车技术栈。</p>
<p>想独立创业，但公司技术人员有限，需要一种能力通吃前后端开发。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-882D0CDB-DB4D-4AC5-B1A1-92C80B1CFB19.png" alt="882D0CDB-DB4D-4AC5-B1A1-92C80B1CFB19"></p>
<p><strong>适用人群</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-AED8B097-DB89-4C53-8CB2-E3139B18D44A.png" alt="AED8B097-DB89-4C53-8CB2-E3139B18D44A"></p>
<h2 id="0-2-实战项目介绍"><a href="#0-2-实战项目介绍" class="headerlink" title="0.2 实战项目介绍"></a>0.2 实战项目介绍</h2><p><strong>完整的 APP 开发流程</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-570D9EFE-A0CC-469F-BCA4-91C211CA3979.png" alt="570D9EFE-A0CC-469F-BCA4-91C211CA3979"></p>
<h2 id="0-3-APP-功能介绍"><a href="#0-3-APP-功能介绍" class="headerlink" title="0.3 APP 功能介绍"></a>0.3 APP 功能介绍</h2><h3 id="桌面图标和启动画面"><a href="#桌面图标和启动画面" class="headerlink" title="桌面图标和启动画面"></a>桌面图标和启动画面</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-2F3BB186-3327-4570-9A2E-E5A045F7B577.png" alt="2F3BB186-3327-4570-9A2E-E5A045F7B577"></p>
<h3 id="过度页面和轮播效果"><a href="#过度页面和轮播效果" class="headerlink" title="过度页面和轮播效果"></a>过度页面和轮播效果</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-18A3986C-D085-4AB6-9ADF-840A6F430F78.png" alt="18A3986C-D085-4AB6-9ADF-840A6F430F78"></p>
<h3 id="注册登录和账户管理"><a href="#注册登录和账户管理" class="headerlink" title="注册登录和账户管理"></a>注册登录和账户管理</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-130F9764-04B8-4F04-9ED5-AF3AB490607C.png" alt="130F9764-04B8-4F04-9ED5-AF3AB490607C"><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-52A268EC-E64E-4474-9165-F49A79918AAD.png" alt="52A268EC-E64E-4474-9165-F49A79918AAD"><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-F9E03C12-AB29-4BC0-85DD-39C1CD318FCD.png" alt="F9E03C12-AB29-4BC0-85DD-39C1CD318FCD">  </p>
<h3 id="视频的配音制作页面"><a href="#视频的配音制作页面" class="headerlink" title="视频的配音制作页面"></a>视频的配音制作页面</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-D01D4730-8B82-4239-BBE2-36F344EC6C70.png" alt="FB55C162-8EEB-4D53-BFBF-84D8088EB6D5"><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-673134D8-1109-491F-8847-F350D1C15D21.png" alt="673134D8-1109-491F-8847-F350D1C15D21"></p>
<p>​    <img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-DDB6085D-A10F-4F77-B3DD-88CA39E4B307.png" alt="DDB6085D-A10F-4F77-B3DD-88CA39E4B307">  <img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-1AC37DB1-5952-4F98-948A-652E76AA26F1.png" alt="1AC37DB1-5952-4F98-948A-652E76AA26F1"> </p>
<h3 id="展现所有制作完毕的创意视频列表"><a href="#展现所有制作完毕的创意视频列表" class="headerlink" title="展现所有制作完毕的创意视频列表"></a>展现所有制作完毕的创意视频列表</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-9D5AE200-A2A3-493F-98F7-E556D9A0E7F6.png" alt="9D5AE200-A2A3-493F-98F7-E556D9A0E7F6"><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-F5A2E11D-8BCE-41F9-910B-ED6ED175665A.png" alt="F5A2E11D-8BCE-41F9-910B-ED6ED175665A"><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-CAE44957-D7E2-49C9-9AFF-C62A01C947BD.png" alt="CAE44957-D7E2-49C9-9AFF-C62A01C947BD"></p>
<h2 id="0-4-APP-后台"><a href="#0-4-APP-后台" class="headerlink" title="0.4 APP 后台"></a>0.4 APP 后台</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-A91AFC02-5CD0-4503-9F50-0D7FD254E490.png" alt="A91AFC02-5CD0-4503-9F50-0D7FD254E490">  </p>
<h2 id="0-5-要点"><a href="#0-5-要点" class="headerlink" title="0.5 要点"></a>0.5 要点</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-557CE284-84C8-48C0-912E-B785D565264F.png" alt="557CE284-84C8-48C0-912E-B785D565264F"></p>
<h3 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-17B2329A-63D9-4F63-B913-719BD59CFE20.png" alt="17B2329A-63D9-4F63-B913-719BD59CFE20"></p>
<h3 id="前后端连调"><a href="#前后端连调" class="headerlink" title="前后端连调"></a>前后端连调</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-5B6CDA95-0E79-4BA9-923F-71673D97C9F9.png" alt="5B6CDA95-0E79-4BA9-923F-71673D97C9F9"></p>
<h1 id="1-课程预热"><a href="#1-课程预热" class="headerlink" title="1 课程预热"></a>1 课程预热</h1><h2 id="1-1-React-与-React-Native"><a href="#1-1-React-与-React-Native" class="headerlink" title="1.1 React 与 React Native"></a>1.1 React 与 React Native</h2><p>React 是 Facebook 推出的一种解决页面组建的抽象和形态的技术方案。它有两个工程上的实现</p>
<p>☑ <a href="https://github.com/facebook/react" target="_blank" rel="external">Reactjs</a>, 也就是我们通常说的 React，用在 Web 网页端，也就是用在浏览器中。</p>
<p>☑ <a href="https://github.com/facebook/react-native" target="_blank" rel="external">React Native</a>, 我们俗称 RN， React Native 用在移动客户端，也就是 iOS 或者 android 手机 APP。看看市面上使用了 React Native 的 <a href="http://facebook.github.io/react-native/showcase.html" target="_blank" rel="external">showcase</a>。</p>
<h3 id="React-Native-的性能"><a href="#React-Native-的性能" class="headerlink" title="React Native 的性能"></a>React Native 的性能</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-B37DFE6F-B67F-4087-B827-0BD00621E4EA.png" alt="B37DFE6F-B67F-4087-B827-0BD00621E4EA"></p>
<p><strong>Hybrid 混合应用</strong></p>
<p>原生的应用中利用 webview 装入一些 HTML 界面。</p>
<p><strong>codava “包皮” 应用</strong></p>
<p>原生的部分只是一个壳子，开发用的全是 WEB 技术，比如 PhoneGap ，一次编写，到处使用。相比原生应用，一些复杂的页面有明显的性能问题。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-5A927112-FBB2-4237-87DA-552ED6984037.png" alt="5A927112-FBB2-4237-87DA-552ED6984037"></p>
<p><strong>React Native</strong></p>
<p>RN 可以看作是基于 React 之上的一种针对特定平台的技术开发方案，其内在依然是 React。用开发WEB的方式开发 APP，利用原生 API 渲染界面，从而获得接近原生 APP 的性能。</p>
<h2 id="1-2-为何选择-React-Native"><a href="#1-2-为何选择-React-Native" class="headerlink" title="1.2 为何选择 React Native"></a>1.2 为何选择 React Native</h2><p>☑ 职业发展</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-535E8284-335C-4DB4-9652-BDA122A9F6EB.png" alt="535E8284-335C-4DB4-9652-BDA122A9F6EB"></p>
<p>☑ 优秀的核心思想</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-FFAA5529-FE25-4BD1-AC20-0A77ECD232E4.png" alt="FFAA5529-FE25-4BD1-AC20-0A77ECD232E4"></p>
<p>☑ 刚毕业或刚入行的新人，会感觉跟不上市场对前端技术的需求。因为你们可能没有兼容过 IE6、7、8、火狐那个年代，每一行代码都断点调试，对 JS 的内部机制，DOM 的性能等细小的技术点没有那么多时间实践和研究，也没有经历过打包、组件抽象和构建，各种异步加载起的折腾，如果现在花时间重新走一遍，反而跟不上市场的脚步。预期为这个历史买单，到不如投资未来，直接切入到 React 和 React Native 的中，反而没有历史包袱。利用这个机会可以弯道超车，直接进入前端开发或者 APP 开发这个职业。职业发展是阶段性的，技术学习是终身的，现在市场上活下来，再沉淀，直到切入到更细分的技术选型。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-9598C18F-AC6B-4711-BD81-CE085B720691.png" alt="9598C18F-AC6B-4711-BD81-CE085B720691"></p>
<p>☑ 在语法这个技术层面 RN 的优势</p>
<ul>
<li>RN 是纯的 JavaScript 组件化，不掺和不同的语言形态。</li>
<li>RN 的技术框架，允许你很方便的介入和调用到各个平台下的 API。</li>
<li>RN 的布局用到的是 flex 布局，上手成本很小。</li>
<li>渲染原生视图的能力，性能有保障。</li>
<li>组件化开发，快速开发原型，在交互上混，唯快不破！</li>
</ul>
<p><strong>总而言之，学会 React 的基本语法以后，可以去开发网页，可以去开发 iOS APP ,可以去开发 Android APP，一招走遍天下。</strong></p>
<h2 id="1-3-RN-适合你吗？"><a href="#1-3-RN-适合你吗？" class="headerlink" title="1.3 RN 适合你吗？"></a>1.3 RN 适合你吗？</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-DBAAAD84-B012-49AD-A19A-D3CE9237EEE3.png" alt="DBAAAD84-B012-49AD-A19A-D3CE9237EEE3"></p>
<h1 id="2-初识-React-Native"><a href="#2-初识-React-Native" class="headerlink" title="2 初识 React Native"></a>2 初识 React Native</h1><h2 id="2-1-本地环境搭建"><a href="#2-1-本地环境搭建" class="headerlink" title="2.1 本地环境搭建"></a>2.1 本地环境搭建</h2><p><strong>参考</strong></p>
<p><a href="http://facebook.github.io/react-native/docs/getting-started.html#content" target="_blank" rel="external">Facebook React Native</a></p>
<p><a href="http://reactnative.cn" target="_blank" rel="external">中文文档（持续跟进新版本）</a></p>
<p><strong>环境准本</strong></p>
<p>(1) MAC OS X 系统</p>
<p>(2) 系统升级到最新</p>
<p>(3) 下载最新版的 Xcode</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ xcode-select --install</span><br></pre></td></tr></table></figure>
<p>(4) 安装 <a href="https://brew.sh/" target="_blank" rel="external">homebrew</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /usr/bin/ruby <span class="_">-e</span> <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure>
<p>(5) 安装 watchman 和 flow</p>
<ul>
<li>watchman 是 faceboook 的一个开源项目，它用来监视文件并且记录文件的改动情况。</li>
<li>Flow 是一个 JavaScript 的静态类型检查器，用于找出 JavaScript 代码中的类型错误。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew install watchman flow git gcc pkg-config cairo libpng jpeg gitlib mongodb</span><br></pre></td></tr></table></figure>
<p>(6) 安装 Nodejs，建议用 <a href="https://github.com/creationix/nvm" target="_blank" rel="external">nvm</a> 来装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</span><br><span class="line">$ nvm install v7.9.0</span><br><span class="line">$ nvm use v7.9.0</span><br><span class="line">$ nvm <span class="built_in">alias</span> default v7.9.0</span><br><span class="line">$ npm install cnpm -g</span><br></pre></td></tr></table></figure>
<p>(7) 确保 8081 端口没有被占用</p>
<ul>
<li>确保没有本地服务占用 8081 端口。</li>
<li>chrome 的一些本地插件有可能使用了 websocket 占用了 8081，有的话关闭。</li>
</ul>
<h2 id="2-2-忍不住尝尝鲜"><a href="#2-2-忍不住尝尝鲜" class="headerlink" title="2.2 忍不住尝尝鲜"></a>2.2 忍不住尝尝鲜</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm install -g react-native-cli -g</span><br><span class="line">$ react-native -v</span><br><span class="line">  react-native-cli: 2.0.1</span><br><span class="line"></span><br><span class="line">$ react-native init imoocApp</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-ADD36C2F-99A1-4216-95F8-48D2BB0F210A.png" alt="ADD36C2F-99A1-4216-95F8-48D2BB0F210A"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用在 iOS 模拟器中启动的第一种运行方式</span></span><br><span class="line">$ <span class="built_in">cd</span> imoocApp &amp;&amp; react-native run-ios</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-01-BA5FE45C-6DD0-49FE-9737-3E22901464AF.png" alt="BA5FE45C-6DD0-49FE-9737-3E22901464AF"></p>
<h2 id="2-3-了解-RN-项目代码结构"><a href="#2-3-了解-RN-项目代码结构" class="headerlink" title="2.3 了解 RN 项目代码结构"></a>2.3 了解 RN 项目代码结构</h2><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p><strong>sublime text 代码高亮</strong></p>
<p>(1) 安装<a href="https://packagecontrol.io" target="_blank" rel="external">package control</a></p>
<p>(2) command + shift + p </p>
<ul>
<li>Babel Snippets</li>
<li>SublimeLinter(对 js 语法进行检查)</li>
<li>SublimeLinter-contrib-eslint</li>
<li>Sublimelinter-jsxhint</li>
</ul>
<p>(3) JS 代码风格检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g eslint babel-eslint --registry=http://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── __tests__</span><br><span class="line">├── android</span><br><span class="line">├── ios</span><br><span class="line">├── app.json <span class="comment"># 应用相关配置</span></span><br><span class="line">├── index.android.js <span class="comment"># android 入口</span></span><br><span class="line">├── index.ios.js <span class="comment"># ios 入口</span></span><br><span class="line">├── node_modules</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure>
<h1 id="3-RN-入门知识学习"><a href="#3-RN-入门知识学习" class="headerlink" title="3 RN 入门知识学习"></a>3 RN 入门知识学习</h1><h2 id="3-1-如何选择-RN-版本"><a href="#3-1-如何选择-RN-版本" class="headerlink" title="3.1 如何选择 RN 版本"></a>3.1 如何选择 RN 版本</h2><p>RN 版本升级很频繁，好的一面是，社区狂热的氛围保障了 RN 未来的影响力，坏的一面是，一旦跟定某个版本进行开发，可能某些问题只有这些版本才会有，同时有些组件没有来得及更新或者升级，你就不敢升级，导致自己动手修改或者规避，会有一个维护的成本，因此选择本本确实是一个非常头疼的问题。</p>
<p>另一个话题是，真正在项目中如何选择版本？对一个 APP 开发的负责人来说，要跟进官方的迭代速度，即要保持跟官方一致的版本升级，很可能掉进一个泥潭，版本之间的差异性可以摧毁你或者你的团队。因为每个版本都会增加新的特性，或者删除老特性，而这些在文档中可能不会充分体现，那对一个稍微复杂的 APP ，升级可能会引发大面积报错。</p>
<p>我的建议是，只要当前的版本是稳定的，性能上没有明显的问题，功能上也能够满足当下的需求，那就不要着急去升级，尤其是线上环境。本地可能等版本至少发布两个月后再尝试，因为这个时候就算遇到一些坑，前人也已经踩得差不多了。所以，在 Github 或 Stackoverflow 或 Google 会比较容易找到解决方案。</p>
<h2 id="3-2-React-的组件生命周期"><a href="#3-2-React-的组件生命周期" class="headerlink" title="3.2 React 的组件生命周期"></a>3.2 React 的组件生命周期</h2><h3 id="3-2-1-传统的-web-开发中的组件"><a href="#3-2-1-传统的-web-开发中的组件" class="headerlink" title="3.2.1 传统的 web  开发中的组件"></a>3.2.1 传统的 web  开发中的组件</h3><p><strong>基本生命周期</strong></p>
<ol>
<li>下载 JS 组件模块(如果是同步组件组件，则没有这一步)；</li>
<li>初始化请求参数；</li>
<li>请求组件数据；</li>
<li>拼装组件结构；</li>
<li>绑定事件监听；</li>
</ol>
<p><strong>分析</strong></p>
<p>CSS 的部分需要全局先加载好，JS 也要提前加载好，因为如果都异步会导致网络延迟。但这个不是主要问题，问题是，如果全局提前加载，就需要将 CSS 打包到 CSS 文件，JS 打包到 JS 文件，从开发到上线是两套分离的逻辑，不存在组件生命周期这回事儿。到了准备数据、拼装结构、安装组件，一共三步，那么绑定事件监听就比较恶心。组件安装后，通过触发事件，在  JS 中找到 DOM 结构，再到 DOM 结构中改变样式或复原样式，要有一个操作样式和复原样式的过程。这带来两个问题:</p>
<ol>
<li>组件的开发和上线形态要分为两套逻辑，组件安装后的事件触发需要显式地借助 JS 来操作 DOM 节点，这个操作会让数据和行为、行为和展现耦合在一起，界限是模糊的。</li>
<li>组件的状态是无序的、不直接的，包含在了 CSS 的交互里面，包含在了用户的鼠标事件中，包含在组件内外部的通信过程中，如果在组件的里面或外面管理组件固有的数据和状态，如何传递就成了传统 WEB 开发所面临的问题。对组件生命周期的抽象和数据状态的管理非常考察一个工程师的设计能力。</li>
</ol>
<h3 id="3-2-2-React-的组件"><a href="#3-2-2-React-的组件" class="headerlink" title="3.2.2 React 的组件"></a>3.2.2 React 的组件</h3><p>传统的 WEB 组件， WEB 中交互以及交互带来的变化要通过 JS 明确操作 DOM 结构来完成，而 RN 中都需要通过状态来控制组件。</p>
<p>React 的思想主要是通过构建可复用组件来构建用户界面。可以粗暴来比喻，在 React 中，一切皆组件。对组件来说，什么最重要？有人说是事件封装，有人说是界面的实现，有人说是交互状态和数据重新渲染的管理，也有人说是组件间的耦合和接口，还有人说是生命周期。对 RN 来说，可以把组件理解成有限状态机，渲染什么样的界面，由状态来决定，而每个组件是有自己的生命周期的。生命周期规定了组件的状态和方法，分别是在哪个阶段改变和执行的。也就是说，组件是有生命的，在生命周期的不同阶段要做不同的事情，这些不同的事情就是有限状态集。少年的时候就是要身体发育和早恋逃课；30岁就要成家生娃；50岁就会白了头发，退休在家。</p>
<p>需要注意的是，有限状态机可以理解成几个有限的状态，这个状态可以进行跳转和切换，甚至是可逆的，但人过了30岁就不能回到少年了。</p>
<p>什么是组件的生命周期呢？就是一个对象从开始到初始化，到证实创建，中间历经各种更新，直到最终卸载所经历的全部的状态。</p>
<h4 id="React-生命周期图示"><a href="#React-生命周期图示" class="headerlink" title="React 生命周期图示"></a>React 生命周期图示</h4><p>先不管父亲儿子孙子这种多层嵌套的组件，先来看一下一个单一组件的生命周期。如下</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-10-39579D57-7B5C-49D2-B860-0C852E5DC9E6.png" alt="39579D57-7B5C-49D2-B860-0C852E5DC9E6"></p>
<p><strong>1 初始化: 渲染 &gt; 装载</strong></p>
<table>
<thead>
<tr>
<th>钩子函数</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>getDefaultProps</td>
<td>获取初始的配置参数，全局只调用一次。也就是说，组件被重新装载也不会再调用该方法。</td>
<td>严格说来不算组件生命周期的一部分，属性往往是在预先在组件中设置好的或者直接通过副组件传递过来。</td>
</tr>
<tr>
<td>getInitialState</td>
<td>获取组件初始状态值，会在组件挂载前调用一次。</td>
<td>一般会把只在这个组件中使用的而且会发生变化的数据放置在状态中，</td>
</tr>
<tr>
<td>componentWillMount</td>
<td>通知组件的调用者，组件即将被渲染和装载。</td>
<td></td>
</tr>
<tr>
<td>render</td>
<td>进行 diff 算法后，对组件进行渲染。</td>
<td></td>
</tr>
<tr>
<td>componentDidMount</td>
<td>通知组件已经挂载。</td>
<td>这时通常可以发送一些异步请求来进一步获取组件其它的数据。</td>
</tr>
</tbody>
</table>
<p><strong>2 运行时: state 变化 &gt; 重新渲染</strong></p>
<table>
<thead>
<tr>
<th>钩子函数</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>shouldComponentUpdate</td>
<td>通知 state 发生变化，询问要不要更新组件。默认 都返回 true。</td>
<td>常常为了性能，需要在这个方法中，为状态的变化的幅度和数量来做比对，从而判断是否马上更新，是否等积累到一定量才进行更新。注意，不要在该方法中调用 setState ，否则会导致死循环。</td>
</tr>
<tr>
<td>componentWillUpdate</td>
<td>组件即将开始渲染。</td>
<td>一旦 shouldComponentUpdate 返回 true ，该方法将会被调用。</td>
</tr>
<tr>
<td>render</td>
<td>重新进行 diff 算法后，对组件进行渲染。</td>
<td></td>
</tr>
<tr>
<td>componentDidUpdate</td>
<td>组件重新渲染后。</td>
</tr>
</tbody>
</table>
<p><strong>2 运行时: props 变化 &gt; 重新渲染</strong></p>
<p>还有一种会使组件更新的方式是外部属性的变化，这种通常来自于父组件的属性变化，是常见的组件之间相互传递数据，和同步状态的手段。在 React 中非常实用。比如父组件中登录了，子组件也需要同步这个变化。同步就是通过外层组件传入 props 来通知变化。</p>
<table>
<thead>
<tr>
<th>钩子函数</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>componentWillReceiveProps</td>
<td>通知外层传入的 props 属性发生了改变。</td>
<td>可以通过对老属性和新属性的比对，判断是否需要更新状态，需要的话，就在该函数中通过 setState 修改 state。这个修改是安全的，不会导致重复 render。注意，该方法在初始化渲染的时候是不会被调用的，只有在组件接收到 props 变化的时候才会被调用。使用该方法的时机是，在外部传入的 props 发生了变化之后，在组件更新之前，在该方法通过更新 state 引发组件重新渲染。这是在组件渲染之前最后一次可以更新 state 的机会。</td>
</tr>
</tbody>
</table>
<p><strong>3 卸载</strong></p>
<table>
<thead>
<tr>
<th>钩子函数</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>componentWillUmount</td>
<td>通知组件即将被卸载。</td>
</tr>
</tbody>
</table>
<h3 id="3-2-3-RN-示例"><a href="#3-2-3-RN-示例" class="headerlink" title="3.2.3 RN 示例"></a>3.2.3 RN 示例</h3><p>统计屏幕点击次数。</p>
<p><strong>imoocApp/index.ios.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  AppRegistry,</span><br><span class="line">  StyleSheet,</span><br><span class="line">  Text,</span><br><span class="line">  View</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">imoocApp</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; times: <span class="number">0</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  timesPlus() &#123;</span><br><span class="line">    <span class="keyword">let</span> times = <span class="keyword">this</span>.state.times</span><br><span class="line">    times++</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; times &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentWillMount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentDidMount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  shouldComponentUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'shouldComponentUpdate'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentWillUpdate'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentDidUpdate'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'render'</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.welcome&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesPlus.bind(this)&#125;</span>&gt;</span></span><br><span class="line">          有本事点我一下</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span>&gt;</span></span><br><span class="line">          你点了我 &#123;this.state.times&#125; 次</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span>&gt;</span></span><br><span class="line">          Press Cmd+R to reload,&#123;'\n'&#125;</span><br><span class="line">          Cmd+D or shake for dev menu</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</span><br><span class="line">  container: &#123;</span><br><span class="line">    flex: <span class="number">1</span>,</span><br><span class="line">    justifyContent: <span class="string">'center'</span>,</span><br><span class="line">    alignItems: <span class="string">'center'</span>,</span><br><span class="line">    backgroundColor: <span class="string">'#F5FCFF'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  welcome: &#123;</span><br><span class="line">    fontSize: <span class="number">20</span>,</span><br><span class="line">    textAlign: <span class="string">'center'</span>,</span><br><span class="line">    margin: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  instructions: &#123;</span><br><span class="line">    textAlign: <span class="string">'center'</span>,</span><br><span class="line">    color: <span class="string">'#333333'</span>,</span><br><span class="line">    marginBottom: <span class="number">5</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">AppRegistry.registerComponent(<span class="string">'imoocApp'</span>, () =&gt; imoocApp);</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-10-0B4E47F3-1143-419B-8205-1D7AC00E4C8D.png" alt="0B4E47F3-1143-419B-8205-1D7AC00E4C8D"></p>
<h2 id="3-3-父子组件撕逼大战"><a href="#3-3-父子组件撕逼大战" class="headerlink" title="3.3 父子组件撕逼大战"></a>3.3 父子组件撕逼大战</h2><p>对于嵌套的组件的生命周期, 下面借助一个例子分析。</p>
<h3 id="3-3-1-代码"><a href="#3-3-1-代码" class="headerlink" title="3.3.1 代码"></a>3.3.1 代码</h3><p><strong>index.ios.js</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Sample React Native App</span><br><span class="line"> * https://github.com/facebook/react-native</span><br><span class="line"> * @flow</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">var React = require(<span class="string">'react'</span>)</span><br><span class="line">var &#123;</span><br><span class="line">  AppRegistry,</span><br><span class="line">  StyleSheet,</span><br><span class="line">  Text,</span><br><span class="line">  View</span><br><span class="line">&#125; = require(<span class="string">'react-native'</span>)</span><br><span class="line"></span><br><span class="line">var Son = React.createClass(&#123;</span><br><span class="line">  <span class="function"><span class="title">getDefaultProps</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'getDefaultProps'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">getInitialState</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'getInitialState'</span>)</span><br><span class="line">    <span class="built_in">return</span> &#123;</span><br><span class="line">      <span class="built_in">times</span>: this.props.times</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">timesPlus</span></span>() &#123;</span><br><span class="line">    <span class="built_in">let</span> <span class="built_in">times</span> = this.state.times</span><br><span class="line">    <span class="built_in">times</span>++</span><br><span class="line">    this.setState(&#123; <span class="built_in">times</span> &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">timesReset</span></span>() &#123;</span><br><span class="line">    this.props.timesReset()</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">componentWillMount</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'componentWillMount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentDidMount</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'componentDidMount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  componentWillReceiveProps(props) &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'componentWillReceiveProps'</span>)</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      <span class="built_in">times</span>: props.times</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">shouldComponentUpdate</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'shouldComponentUpdate'</span>)</span><br><span class="line">    <span class="built_in">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentWillUpdate</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'componentWillUpdate'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentDidUpdate</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'componentDidUpdate'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentWillUmount</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'componentWillUmount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">render</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'son'</span>, <span class="string">'render'</span>)</span><br><span class="line">    <span class="built_in">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.timesPlus&#125;&gt;</span><br><span class="line">          有本事揍我啊</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</span><br><span class="line">          你居然揍了我 &#123;this.state.times&#125; 次</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.instructions&#125; onPress=&#123;this.timesReset&#125;&gt;</span><br><span class="line">          信不信我亲亲你</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">var imoocApp = React.createClass(&#123;</span><br><span class="line">  <span class="function"><span class="title">getDefaultProps</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'father'</span>, <span class="string">'getDefaultProps'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">getInitialState</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'father'</span>, <span class="string">'getInitialState'</span>)</span><br><span class="line">    <span class="built_in">return</span> &#123;</span><br><span class="line">      hit: <span class="literal">false</span>,</span><br><span class="line">      <span class="built_in">times</span>: 2</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">timesPlus</span></span>() &#123;</span><br><span class="line">    <span class="built_in">let</span> <span class="built_in">times</span> = this.state.times</span><br><span class="line">    <span class="built_in">times</span> += 3</span><br><span class="line">    this.setState(&#123; <span class="built_in">times</span> &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">timesReset</span></span>() &#123;</span><br><span class="line">    this.setState(&#123; <span class="built_in">times</span>: 0 &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">willHit</span></span>() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      hit: !this.state.hit</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentWillMount</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'father'</span>, <span class="string">'componentWillMount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentDidMount</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'father'</span>, <span class="string">'componentDidMount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">shouldComponentUpdate</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'father'</span>, <span class="string">'shouldComponentUpdate'</span>)</span><br><span class="line">    <span class="built_in">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentWillUpdate</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'father'</span>, <span class="string">'componentWillUpdate'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">componentDidUpdate</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'father'</span>, <span class="string">'componentDidUpdate'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">render</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'father'</span>, <span class="string">'render'</span>)</span><br><span class="line">    <span class="built_in">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &#123;</span><br><span class="line">          this.state.hit</span><br><span class="line">          ? &lt;Son <span class="built_in">times</span>=&#123;this.state.times&#125; <span class="built_in">times</span>Reset=&#123;this.timesReset&#125;/&gt;</span><br><span class="line">          : null</span><br><span class="line">        &#125;</span><br><span class="line">        &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.timesReset&#125;&gt;</span><br><span class="line">          老子说: 心情好就放你一马</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.instructions&#125; onPress=&#123;this.willHit&#125;&gt;</span><br><span class="line">          到底揍不揍</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</span><br><span class="line">          就揍了你 &#123;this.state.times&#125; 次而已</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">        &lt;Text style=&#123;styles.instructions&#125; onPress=&#123;this.timesPlus&#125;&gt;</span><br><span class="line">          不听话再揍你 3 次</span><br><span class="line">        &lt;/Text&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const styles = StyleSheet.create(&#123;</span><br><span class="line">  container: &#123;</span><br><span class="line">    flex: 1,</span><br><span class="line">    justifyContent: <span class="string">'center'</span>,</span><br><span class="line">    alignItems: <span class="string">'center'</span>,</span><br><span class="line">    backgroundColor: <span class="string">'#F5FCFF'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  welcome: &#123;</span><br><span class="line">    fontSize: 20,</span><br><span class="line">    textAlign: <span class="string">'center'</span>,</span><br><span class="line">    margin: 10,</span><br><span class="line">  &#125;,</span><br><span class="line">  instructions: &#123;</span><br><span class="line">    textAlign: <span class="string">'center'</span>,</span><br><span class="line">    color: <span class="string">'#333333'</span>,</span><br><span class="line">    marginBottom: 5,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">AppRegistry.registerComponent(<span class="string">'imoocApp'</span>, () =&gt; imoocApp)</span><br></pre></td></tr></table></figure>
<h3 id="3-3-2-分析"><a href="#3-3-2-分析" class="headerlink" title="3.3.2 分析"></a>3.3.2 分析</h3><p><strong>(1) 父组件初始化渲染和加载</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-4DCEEEE1-4B7D-44BB-8E04-8A5FFEFE3F64.png" alt="4DCEEEE1-4B7D-44BB-8E04-8A5FFEFE3F64"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-25C37AA9-39B8-4473-98DA-53673A993F2C.png" alt="25C37AA9-39B8-4473-98DA-53673A993F2C"></p>
<p><strong>(2) 子组件的初始渲染和加载</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-7581DC8D-FC75-4CE0-9A7F-03A0576598E5.png" alt="7581DC8D-FC75-4CE0-9A7F-03A0576598E5"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-FB3C5ECD-85BE-4DE6-9D1C-1CEEEFE66648.png" alt="FB3C5ECD-85BE-4DE6-9D1C-1CEEEFE66648"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-5EE7ACF3-2FDB-491C-AA39-A981B0FADF9E.png" alt="5EE7ACF3-2FDB-491C-AA39-A981B0FADF9E"></p>
<p><strong>(3) 子组件 state 变化</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-88901F07-9679-4B04-ABB9-8367DCF60E4D.png" alt="88901F07-9679-4B04-ABB9-8367DCF60E4D"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-62E6F933-DEDF-4B80-8D65-823FA7569057.png" alt="62E6F933-DEDF-4B80-8D65-823FA7569057"></p>
<p><strong>(4) 父组件 state 变化 &gt; 组件件 props 变化</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-9FC5DD40-F8B2-4DCA-A225-09BA3F63AAFC.png" alt="9FC5DD40-F8B2-4DCA-A225-09BA3F63AAFC"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-EC2B84EF-FDA1-4C15-8066-760CA1D96BE3.png" alt="EC2B84EF-FDA1-4C15-8066-760CA1D96BE3"></p>
<h2 id="3-4-ES5-和-ES6-两种组件形态"><a href="#3-4-ES5-和-ES6-两种组件形态" class="headerlink" title="3.4 ES5 和 ES6 两种组件形态"></a>3.4 ES5 和 ES6 两种组件形态</h2><h3 id="3-4-1-ECMAScript-历史"><a href="#3-4-1-ECMAScript-历史" class="headerlink" title="3.4.1 ECMAScript 历史"></a>3.4.1 ECMAScript 历史</h3><p>ECMAScript 规范的历史就是浏览器厂商、规范制订者和开发者的撕逼史。</p>
<ul>
<li>1997 ECMAScript 1.0</li>
<li>1998 ECMAScript 2.0</li>
<li>1999 ECMAScript 3.0</li>
<li>2007 ECMAScript 4.0    草案，受到抵制</li>
<li>2008 ECMAScript 3.1</li>
<li>2009 ECMASCript 5.0</li>
<li>2015 ECMASCript 6.0    ECMASCript 2015(ES6)</li>
<li>2016 ECMASCript    2016(ES7)</li>
</ul>
<h3 id="3-4-2-ES5-和-ES6-两种组件实现方式的对比"><a href="#3-4-2-ES5-和-ES6-两种组件实现方式的对比" class="headerlink" title="3.4.2 ES5 和 ES6 两种组件实现方式的对比"></a>3.4.2 ES5 和 ES6 两种组件实现方式的对比</h3><h4 id="要点"><a href="#要点" class="headerlink" title="要点"></a>要点</h4><table>
<thead>
<tr>
<th>要点</th>
<th>ES5 方式</th>
<th>ES6 方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>事件绑定需要通过 bind 绑定 this</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>组件的声明</td>
<td>React.create()</td>
<td>class(继承 Component)</td>
</tr>
<tr>
<td>state 获取初始值</td>
<td>getInitialState()</td>
<td>在构造器中给 this.state 赋值</td>
</tr>
<tr>
<td>props 获取默认值</td>
<td>getDefaultProps()</td>
<td>props 作为构造器的参数传入，因此可以通过 ES6 的形式参数默认值来实现。</td>
</tr>
<tr>
<td>是否支持mixin</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody>
</table>
<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><p>前面父子组件撕逼大战的例子<code>index.ios.js</code>。</p>
<p>ES5版</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>)</span><br><span class="line"><span class="keyword">var</span> ReactNative = <span class="built_in">require</span>(<span class="string">'react-native'</span>)</span><br><span class="line"><span class="keyword">var</span> AppRegistry = ReactNative.AppRegistry</span><br><span class="line"><span class="keyword">var</span> StyleSheet = ReactNative.StyleSheet</span><br><span class="line"><span class="keyword">var</span> Text = ReactNative.Text</span><br><span class="line"><span class="keyword">var</span> View = ReactNative.View</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Son = React.createClass(&#123;</span><br><span class="line">  getDefaultProps() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'getDefaultProps'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  getInitialState() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'getInitialState'</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      times: <span class="keyword">this</span>.props.times</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  timesPlus() &#123;</span><br><span class="line">    <span class="keyword">var</span> times = <span class="keyword">this</span>.state.times</span><br><span class="line">    times++</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; times &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  timesReset() &#123;</span><br><span class="line">    <span class="keyword">this</span>.props.timesReset()</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentWillMount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentDidMount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  componentWillReceiveProps(props) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentWillReceiveProps'</span>)</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      times: props.times</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  shouldComponentUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'shouldComponentUpdate'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  componentWillUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentWillUpdate'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentDidUpdate'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  componentWillUmount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentWillUmount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'render'</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.welcome&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesPlus&#125;</span>&gt;</span></span><br><span class="line">          有本事揍我啊</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span>&gt;</span></span><br><span class="line">          你居然揍了我 &#123;this.state.times&#125; 次</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesReset&#125;</span>&gt;</span></span><br><span class="line">          信不信我亲亲你</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> imoocApp = React.createClass(&#123;</span><br><span class="line">  getDefaultProps() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'getDefaultProps'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  getInitialState() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'getInitialState'</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      hit: <span class="literal">false</span>,</span><br><span class="line">      times: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  timesPlus() &#123;</span><br><span class="line">    <span class="keyword">let</span> times = <span class="keyword">this</span>.state.times</span><br><span class="line">    times += <span class="number">3</span></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; times &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  timesReset() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; times: <span class="number">0</span> &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  willHit() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      hit: !<span class="keyword">this</span>.state.hit</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'componentWillMount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'componentDidMount'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  shouldComponentUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'shouldComponentUpdate'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  componentWillUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'componentWillUpdate'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'componentDidUpdate'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'render'</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span><br><span class="line">        &#123;</span><br><span class="line">          this.state.hit</span><br><span class="line">          ? <span class="tag">&lt;<span class="name">Son</span> <span class="attr">times</span>=<span class="string">&#123;this.state.times&#125;</span> <span class="attr">timesReset</span>=<span class="string">&#123;this.timesReset&#125;/</span>&gt;</span></span><br><span class="line">          : null</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.welcome&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesReset&#125;</span>&gt;</span></span><br><span class="line">          老子说: 心情好就放你一马</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.willHit&#125;</span>&gt;</span></span><br><span class="line">          到底揍不揍</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span>&gt;</span></span><br><span class="line">          就揍了你 &#123;this.state.times&#125; 次而已</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesPlus&#125;</span>&gt;</span></span><br><span class="line">          不听话再揍你 3 次</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">var styles = StyleSheet.create(&#123;</span><br><span class="line">  container: &#123;</span><br><span class="line">    flex: 1,</span><br><span class="line">    justifyContent: 'center',</span><br><span class="line">    alignItems: 'center',</span><br><span class="line">    backgroundColor: '#F5FCFF',</span><br><span class="line">  &#125;,</span><br><span class="line">  welcome: &#123;</span><br><span class="line">    fontSize: 20,</span><br><span class="line">    textAlign: 'center',</span><br><span class="line">    margin: 10,</span><br><span class="line">  &#125;,</span><br><span class="line">  instructions: &#123;</span><br><span class="line">    textAlign: 'center',</span><br><span class="line">    color: '#333333',</span><br><span class="line">    marginBottom: 5,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">AppRegistry.registerComponent('imoocApp', function()&#123; return imoocApp &#125;)</span></span><br></pre></td></tr></table></figure>
<p>ES6 版</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * Sample React Native App</span><br><span class="line"> * https://github.com/facebook/react-native</span><br><span class="line"> * @flow</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  AppRegistry,</span><br><span class="line">  StyleSheet,</span><br><span class="line">  Text,</span><br><span class="line">  View</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span> </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      times: <span class="keyword">this</span>.props.times</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  timesPlus() &#123;</span><br><span class="line">    <span class="keyword">let</span> times = <span class="keyword">this</span>.state.times</span><br><span class="line">    times++</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; times &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  timesReset() &#123;</span><br><span class="line">    <span class="keyword">this</span>.props.timesReset()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentWillMount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentDidMount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillReceiveProps(props) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentWillReceiveProps'</span>)</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      times: props.times</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  shouldComponentUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'shouldComponentUpdate'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentWillUpdate'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentDidUpdate'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUmount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'componentWillUmount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'son'</span>, <span class="string">'render'</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.welcome&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesPlus.bind(this)&#125;</span>&gt;</span></span><br><span class="line">          有本事揍我啊</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span>&gt;</span></span><br><span class="line">          你居然揍了我 &#123;this.state.times&#125; 次</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesReset.bind(this)&#125;</span>&gt;</span></span><br><span class="line">          信不信我亲亲你</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">imoocApp</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      hit: <span class="literal">false</span>,</span><br><span class="line">      times: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  timesPlus() &#123;</span><br><span class="line">    <span class="keyword">let</span> times = <span class="keyword">this</span>.state.times</span><br><span class="line">    times += <span class="number">3</span></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; times &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  timesReset() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; times: <span class="number">0</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  willHit() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      hit: !<span class="keyword">this</span>.state.hit</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'componentWillMount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'componentDidMount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  shouldComponentUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'shouldComponentUpdate'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'componentWillUpdate'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'componentDidUpdate'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'father'</span>, <span class="string">'render'</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span><br><span class="line">        &#123;</span><br><span class="line">          this.state.hit</span><br><span class="line">          ? <span class="tag">&lt;<span class="name">Son</span> <span class="attr">times</span>=<span class="string">&#123;this.state.times&#125;</span> <span class="attr">timesReset</span>=<span class="string">&#123;this.timesReset.bind(this)&#125;/</span>&gt;</span></span><br><span class="line">          : null</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.welcome&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesReset.bind(this)&#125;</span>&gt;</span></span><br><span class="line">          老子说: 心情好就放你一马</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.willHit.bind(this)&#125;</span>&gt;</span></span><br><span class="line">          到底揍不揍</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span>&gt;</span></span><br><span class="line">          就揍了你 &#123;this.state.times&#125; 次而已</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.instructions&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this.timesPlus.bind(this)&#125;</span>&gt;</span></span><br><span class="line">          不听话再揍你 3 次</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const styles = StyleSheet.create(&#123;</span><br><span class="line">  container: &#123;</span><br><span class="line">    flex: 1,</span><br><span class="line">    justifyContent: 'center',</span><br><span class="line">    alignItems: 'center',</span><br><span class="line">    backgroundColor: '#F5FCFF',</span><br><span class="line">  &#125;,</span><br><span class="line">  welcome: &#123;</span><br><span class="line">    fontSize: 20,</span><br><span class="line">    textAlign: 'center',</span><br><span class="line">    margin: 10,</span><br><span class="line">  &#125;,</span><br><span class="line">  instructions: &#123;</span><br><span class="line">    textAlign: 'center',</span><br><span class="line">    color: '#333333',</span><br><span class="line">    marginBottom: 5,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">AppRegistry.registerComponent('imoocApp', () =&gt; imoocApp)</span></span><br></pre></td></tr></table></figure>
<h1 id="4-升级-React-Native-的重要补录"><a href="#4-升级-React-Native-的重要补录" class="headerlink" title="4 升级 React Native 的重要补录"></a>4 升级 React Native 的重要补录</h1><h2 id="4-1-一期答疑总结"><a href="#4-1-一期答疑总结" class="headerlink" title="4.1 一期答疑总结"></a>4.1 一期答疑总结</h2><h3 id="好习惯"><a href="#好习惯" class="headerlink" title="好习惯"></a>好习惯</h3><ul>
<li><p>培养自己选找答案的功能</p>
</li>
<li><p>经常去问答区看看</p>
<p>​</p>
</li>
</ul>
<h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><p><strong>xcode 升级导致的问题</strong></p>
<ul>
<li>新版本的 RN 多了一些对协议的限制，比如升级到 iOS 10 默认不支持 HTTP 请求，但支持 HTTPS 请求，如果需要支持前者，需要<a href="http://coding.imooc.com/learn/questiondetail/1841.html" target="_blank" rel="external">从 Xcode 中配置</a>。</li>
<li><a href="http://coding.imooc.com/learn/questiondetail/2192.html" target="_blank" rel="external">ios10 中 react-native-image-picker 调用本地相册出错</a></li>
<li><a href="http://coding.imooc.com/learn/questiondetail/1756.html" target="_blank" rel="external">xcode 命令行工具导致的一个问题</a>。</li>
</ul>
<p><strong>代码粗心</strong></p>
<ul>
<li>使用排除法锁定出错的代码。</li>
</ul>
<h2 id="4-2-Run-起来课程源代码"><a href="#4-2-Run-起来课程源代码" class="headerlink" title="4.2 Run 起来课程源代码"></a>4.2 Run 起来课程源代码</h2><h3 id="4-2-1-检查环境"><a href="#4-2-1-检查环境" class="headerlink" title="4.2.1 检查环境"></a>4.2.1 检查环境</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ node -v</span><br><span class="line">$ react-native -v</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>环境</th>
<th>讲师</th>
<th>我</th>
</tr>
</thead>
<tbody>
<tr>
<td>Nodejs</td>
<td>v6.9.1</td>
<td>v7.9.0</td>
</tr>
<tr>
<td>rnpm</td>
<td>1.9.0</td>
<td>1.9.0</td>
</tr>
<tr>
<td>react</td>
<td>未知</td>
<td>16.0.0-alpha.6</td>
</tr>
<tr>
<td>react-native-cli</td>
<td>0.1.10</td>
<td>2.0.1</td>
</tr>
<tr>
<td>react-native</td>
<td>0.22.2</td>
<td>0.44.0</td>
</tr>
</tbody>
</table>
<h3 id="4-2-2-升级项目"><a href="#4-2-2-升级项目" class="headerlink" title="4.2.2 升级项目"></a>4.2.2 升级项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> imoocApp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 依赖的包可能过时了，替换为最新的</span></span><br><span class="line">$ rm -rf node_modules &amp;&amp; npm install</span><br></pre></td></tr></table></figure>
<h3 id="4-2-3-保持环境干净"><a href="#4-2-3-保持环境干净" class="headerlink" title="4.2.3 保持环境干净"></a>4.2.3 保持环境干净</h3><ul>
<li>关闭全局的翻墙</li>
<li>关闭已有的 RN 服务进程(如果有的话)</li>
<li>关闭模拟器</li>
</ul>
<h3 id="4-2-4-跑起来"><a href="#4-2-4-跑起来" class="headerlink" title="4.2.4 跑起来"></a>4.2.4 跑起来</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ react-native run-ios</span><br></pre></td></tr></table></figure>
<h3 id="4-2-5-错误修复"><a href="#4-2-5-错误修复" class="headerlink" title="4.2.5 错误修复"></a>4.2.5 错误修复</h3><p><strong>技巧</strong>: 如果报错且没有头绪，可以用 xcode 编译运行项目, 一般报错信息更丰富些。</p>
<p><strong>(1) Semantic Issue</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-F507C0C1-45D1-4027-BE25-C364B8125CE5.png" alt="F507C0C1-45D1-4027-BE25-C364B8125CE5"></p>
<p>删除<code>-Werror</code>和<code>-Wall</code>。</p>
<p><strong>(2) ‘RTCBundleURLProvider.h’ file not found</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> imoocApp</span><br><span class="line"><span class="comment"># 在项目中建立和第三方模块的链接</span></span><br><span class="line">$ rnpm link</span><br></pre></td></tr></table></figure>
<h2 id="4-3-暴力升级到-0-36-上"><a href="#4-3-暴力升级到-0-36-上" class="headerlink" title="4.3 暴力升级到 0.36 (上)"></a>4.3 暴力升级到 0.36 (上)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 升级 nodejs</span></span><br><span class="line">$ nvm install v7.9.0</span><br><span class="line">$ nvm <span class="built_in">alias</span> default v7.9.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 升级 react-native、react-native-cli、rnpm</span></span><br><span class="line">$ npm i react-native-cli@2.0.1 -g</span><br><span class="line">$ npm i rnpm@1.9.0 -g</span><br></pre></td></tr></table></figure>
<p><strong>项目小升级</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 升级项目</span></span><br><span class="line">$ <span class="built_in">cd</span> imoocApp</span><br><span class="line">$ rnpm unlink</span><br><span class="line">$ rm -rf node_modules</span><br><span class="line">$ npm install</span><br><span class="line">$ npm install react-native@0.44.0 -S</span><br><span class="line">$ npm install react@16.0.0-alpha.6 -S</span><br><span class="line">$ rnpm link</span><br></pre></td></tr></table></figure>
<h2 id="4-4-暴力升级到-0-36-下"><a href="#4-4-暴力升级到-0-36-下" class="headerlink" title="4.4 暴力升级到 0.36(下)"></a>4.4 暴力升级到 0.36(下)</h2><p><strong>项目大升级(脱胎换骨)</strong></p>
<ul>
<li>优点: 能抹平环境差异带来的问题。</li>
<li>缺点: 给代码的带来非常大的变更量，不变易历史版本比对和代码版本跟踪。</li>
</ul>
<p>(1) 在本地新建一个 RN 项目<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ react-native init newRNProject</span><br><span class="line">$ <span class="built_in">cd</span> newRNProject</span><br><span class="line">$ react-native run-ios <span class="comment"># 测试下通过官方脚手架搭建的项目是否正常</span></span><br></pre></td></tr></table></figure></p>
<p>(2) 用新的配置文件覆盖旧的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ mv newRNProject/.babelrc imoocApp/</span><br><span class="line">$ mv newRNProject/.buckconfig imoocApp/</span><br><span class="line">$ mv newRNProject/.flowconfig imoocApp/</span><br><span class="line">$ mv newRNProject/.gitignore imoocApp/</span><br><span class="line">$ mv newRNProject/.watchmanconfig imoocApp/</span><br><span class="line">$ mv newRNProject/package.json imoocApp/</span><br><span class="line">$ mv newRNProject/__<span class="built_in">test</span>__ imoocApp/</span><br><span class="line">$ mv newRNProject/android imoocApp/</span><br><span class="line">$ mv newRNProject/index.android.js imoocApp/</span><br><span class="line">$ mv newRNProject/ios/imoocApp.xcodeprog imoocApp/ios/</span><br><span class="line">$ mv newRNProject/ios/imoocAppTests imoocApp/ios/</span><br><span class="line">$ mv newRNProject/ios/AppDelegate.h imoocApp/ios/</span><br><span class="line">$ mv newRNProject/ios/AppDelegate.m imoocApp/ios/</span><br><span class="line">$ mv newRNProject/ios/main.m imoocApp/ios/</span><br><span class="line">$ mv newRNProject/ios/ imoocApp/ios/</span><br></pre></td></tr></table></figure>
<p>(3) 删除多余的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rm -rf imoocApp/ios/build</span><br></pre></td></tr></table></figure>
<p>(4) 安装依赖包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm i react react-native lodash query-string react-native-audio@2.2.0 react-native-button@1.7.1 react-native-image-picker@0.22.12 react-native-progress@3.1.0 react-native-sk-countdown@1.0.1 react-native-swiper@1.5.2 react-native-vector-icons@2.1.0 react-native-video@0.9.0 react-addons-update@15.3.0 sha1 --save</span><br><span class="line">$ rnpm link</span><br></pre></td></tr></table></figure>
<p>(5) imoocApp/ios/imoocApp/Info.plist</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAllowsArbitraryLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="4-4-课程进阶拥抱-ES6-上"><a href="#4-4-课程进阶拥抱-ES6-上" class="headerlink" title="4.4 课程进阶拥抱 ES6(上)"></a>4.4 课程进阶拥抱 ES6(上)</h2><ul>
<li>模块引入使用 import</li>
<li>组件声明换成 class 方式(记得 export 出去)</li>
<li>事件绑定加上 bind</li>
</ul>
<h2 id="4-5-课程进阶拥抱-ES6-下"><a href="#4-5-课程进阶拥抱-ES6-下" class="headerlink" title="4.5 课程进阶拥抱 ES6(下)"></a>4.5 课程进阶拥抱 ES6(下)</h2><p><strong>一些第三方组件通过 import 引入方式需要使用包名</strong></p>
<ul>
<li>react-native-image-picker</li>
</ul>
<p><strong>node_modules/react-native-sk-countdown/CountDownText.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  StyleSheet,</span><br><span class="line">  Text</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"><span class="keyword">import</span> update <span class="keyword">from</span> <span class="string">'react-addons-update'</span></span><br><span class="line"><span class="keyword">import</span> countDown <span class="keyword">from</span> <span class="string">'./countDown'</span></span><br></pre></td></tr></table></figure></p>
<p><strong>ActivityIndicatorIOS is deprecated. Use ActivityIndicator instead.</strong><br>将文件夹 <code>imoocApp/app</code> 下的 ActicityIndicatorIOS 全局替换为 ActicityIndicator。</p>
<p><strong><code>animated</code> supplied to <code>Modal</code> has been deprecated.Use the <code>animationType</code> prop instead.</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Modal</span><br><span class="line">	animationType=&#123;<span class="string">'slide'</span>&#125;</span><br><span class="line">	...&gt;</span><br></pre></td></tr></table></figure>
<p><strong>imoocApp/app/edit/index.js</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">uploadContainer: &#123;</span><br><span class="line">  ...</span><br><span class="line">  height: 210,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p><strong>轮播去掉容器样式</strong><br><strong>轮播按钮有些丑</strong><br><strong>imoocApp/app/creation/index.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">&lt;RefreshControl</span><br><span class="line">	refreshing=&#123;<span class="keyword">this</span>.state.isRefreshing&#125;</span><br><span class="line">	onRefresh=&#123;<span class="keyword">this</span>._onRefresh.bind(<span class="keyword">this</span>)&#125;</span><br><span class="line">/&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h1 id="5-项目初始准备"><a href="#5-项目初始准备" class="headerlink" title="5 项目初始准备"></a>5 项目初始准备</h1><h2 id="5-1-狗狗说-App-功能介绍"><a href="#5-1-狗狗说-App-功能介绍" class="headerlink" title="5.1 狗狗说 App 功能介绍"></a>5.1 狗狗说 App 功能介绍</h2><h3 id="狗狗说功能分析"><a href="#狗狗说功能分析" class="headerlink" title="狗狗说功能分析"></a>狗狗说功能分析</h3><ul>
<li>启动画面</li>
<li>轮播图</li>
<li>短信登录</li>
<li>制作页</li>
<li>列表页</li>
<li>账户主页</li>
</ul>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-D49EBA1A-7626-49FF-9346-83D5A5B8D8D1.png" alt="D49EBA1A-7626-49FF-9346-83D5A5B8D8D1"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-2E271031-FFC4-40B9-9D0B-DB01613B85E8.png" alt="2E271031-FFC4-40B9-9D0B-DB01613B85E8"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-8F9195B0-DF0D-43DB-8D1E-7C0B7D336ACC.png" alt="8F9195B0-DF0D-43DB-8D1E-7C0B7D336ACC"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-3501449C-9A19-49EA-B726-D6FAEB9CF951.png" alt="3501449C-9A19-49EA-B726-D6FAEB9CF951"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-0F99F927-3486-4087-9003-EDB6D5E67F8E.png" alt="0F99F927-3486-4087-9003-EDB6D5E67F8E"></p>
<h2 id="5-2-TabBarIOS-开启-App-首页"><a href="#5-2-TabBarIOS-开启-App-首页" class="headerlink" title="5.2 TabBarIOS 开启 App 首页"></a>5.2 TabBarIOS 开启 App 首页</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-11-D49EBA1A-7626-49FF-9346-83D5A5B8D8D1.png" alt="D49EBA1A-7626-49FF-9346-83D5A5B8D8D1"></p>
<p>从大往小作，一开始不要纠结样式、功能等琐碎的小细节，先把大框架描出来。放眼整个 APP，先把几个主要的视图界面狑出来 ，然后组合一下，再对着这个大的结构进行更加详细的功能模块的拆解和具体方案的架构。</p>
<h3 id="RN-插件-图标工具"><a href="#RN-插件-图标工具" class="headerlink" title="RN 插件: 图标工具"></a>RN 插件: 图标工具</h3><p><a href="https://github.com/oblador/react-native-vector-icons" target="_blank" rel="external">react-native-vector-icons@4.1.1</a>: 一个流行的图标库管理工具</p>
<h3 id="RN-插件包管理器-rnpm"><a href="#RN-插件包管理器-rnpm" class="headerlink" title="RN 插件包管理器: rnpm"></a>RN 插件包管理器: rnpm</h3><p>作用是把模块链接到 iOS 工程中，把必要的资源文件比如图标字体也拷贝到工程中，方便 RN 调用。</p>
<p><a href="https://github.com/rnpm/rnpm" target="_blank" rel="external">Github 地址</a></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-614E0AEB-15F3-484F-8BBE-14D57E2A54A8.png" alt="614E0AEB-15F3-484F-8BBE-14D57E2A54A8"></p>
<p>显然 rnpm 已经被合并到了 react-native core ，用法和 rnpm 类似，<a href="http://www.jianshu.com/p/188c19387853" target="_blank" rel="external">以 react-native-vector-icons 为例</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rnpm link react-native-vector-icons</span></span><br><span class="line">$ react-native link react-native-vector-icons</span><br></pre></td></tr></table></figure>
<h3 id="RN-升级"><a href="#RN-升级" class="headerlink" title="RN 升级"></a>RN 升级</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 本地环境升级，除了升级 RN 核心库外，配置文件也会相应进行升级到最新。</span></span><br><span class="line">$ react-native upgrade</span><br></pre></td></tr></table></figure>
<h2 id="5-3-TabBarIOS-开启-APP-首页-2"><a href="#5-3-TabBarIOS-开启-APP-首页-2" class="headerlink" title="5.3 TabBarIOS 开启 APP 首页(2)"></a>5.3 TabBarIOS 开启 APP 首页(2)</h2><h3 id="5-3-1-使用-react-native-vector-icons"><a href="#5-3-1-使用-react-native-vector-icons" class="headerlink" title="5.3.1 使用 react-native-vector-icons"></a>5.3.1 使用 react-native-vector-icons</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-9B23DCB1-CE53-45DF-BF53-95F3640FAF02.png" alt="9B23DCB1-CE53-45DF-BF53-95F3640FAF02"></p>
<p>项目中具体使用的是 <a href="http://ionicons.com" target="_blank" rel="external">Ionicons</a>图标库。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Icon <span class="keyword">from</span> <span class="string">'react-native-vector-icons/Ionicons'</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>: 链接后需要重新编译才能生效。</p>
<h3 id="5-3-2-使用-Icon-TabBarItem-取代-TabBarIOS-Item"><a href="#5-3-2-使用-Icon-TabBarItem-取代-TabBarIOS-Item" class="headerlink" title="5.3.2 使用 Icon.TabBarItem 取代 TabBarIOS.Item"></a>5.3.2 使用 Icon.TabBarItem 取代 TabBarIOS.Item</h3><p>Icon.TabBarItem是对TabBarIOS.Item的封装，用来生成图标列表项。</p>
<h2 id="5-4-APP-流程结构及开发计划"><a href="#5-4-APP-流程结构及开发计划" class="headerlink" title="5.4 APP 流程结构及开发计划"></a>5.4 APP 流程结构及开发计划</h2><p>下面先开发哪个页面？理论上选择哪个都可以，只不过如果先对项目有一个功能的拆解和梳理之后，在选择项目的开发顺序，心里更有底。在前期的开发中，能有一些适当的扩展和接口，给到后面的页面，真个开发顺序会更加自然。<br>为了让大家印象更加深刻，先来对 APP 的功能进行一下细化，过一下用户的交互流程。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-8ED42960-E255-4E4F-B77D-AF81B3DAC6F6.png" alt="8ED42960-E255-4E4F-B77D-AF81B3DAC6F6"></p>
<h2 id="5-5-页面重构"><a href="#5-5-页面重构" class="headerlink" title="5.5 页面重构"></a>5.5 页面重构</h2><p>将 Tab 对应的视图分别放在单独文件中。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-B1F170F2-BD34-4B34-ACB2-D18C948BCBCF.png" alt="B1F170F2-BD34-4B34-ACB2-D18C948BCBCF"></p>
<h2 id="5-6-飞速创建后台和-Mock-假数据"><a href="#5-6-飞速创建后台和-Mock-假数据" class="headerlink" title="5.6 飞速创建后台和 Mock 假数据"></a>5.6 飞速创建后台和 Mock 假数据</h2><h3 id="5-6-1-传统-Mock-假数据"><a href="#5-6-1-传统-Mock-假数据" class="headerlink" title="5.6.1 传统 Mock 假数据"></a>5.6.1 传统 Mock 假数据</h3><p>一般开发网页的时候伪造数据，包括</p>
<ul>
<li>在代码中写死一个 JS 对象或数组存放假数据。</li>
<li>本地用一个 JSON 文件存放假数据，然后请求这个文件就好了。</li>
<li>本地开一个 python 或者 Nodejs 静态服务，简单写一下响应规则。</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>请求不够真实，比如都是基于内网环境，没有真实环境可能的网络延迟,因此看不出应用在地网络环境下的表现。</li>
<li>如果本地开发后台，比较辛苦，需求如果频繁变化，本地后台的规则也需要频繁变化，造成开发成本过高。</li>
<li>不能满足定制化的需求，比如随机返回数据的个数，返回不同的图片地址或者返回变化的数据，包括无法验证传参的正确性。</li>
</ul>
<h3 id="5-6-2-Rap-和-Mockjs"><a href="#5-6-2-Rap-和-Mockjs" class="headerlink" title="5.6.2 Rap 和 Mockjs"></a>5.6.2 Rap 和 Mockjs</h3><p><strong>Rap</strong>: 处理网络请求和输入数据规则。<br><strong>Mockjs</strong>: 本地解析数据规则来生成更佳个性化的具体数据，避免大量数据传输的体积。</p>
<p>(1) 在 <a href="http://rapapi.org" target="_blank" rel="external">Rap官网</a> 配置好某个请求的Mock规则。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-708E7778-BACE-4086-99C5-D2175D23BFEF.png" alt="708E7778-BACE-4086-99C5-D2175D23BFEF"></p>
<p>(2) 产看请求的 Mock 数据</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-C4A2C36C-4E7A-43C4-BF47-6902EB43028F.png" alt="C4A2C36C-4E7A-43C4-BF47-6902EB43028F"></p>
<p>其实也可以在 <a href="http://mockjs.com/" target="_blank" rel="external">Mockjs 官网</a>可以试下规则的解析结果，如下</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-FDD9C85D-6D12-4D46-AA2D-4140F3E22ADB.png" alt="FDD9C85D-6D12-4D46-AA2D-4140F3E22ADB"></p>
<h1 id="6-开发视频配音界面"><a href="#6-开发视频配音界面" class="headerlink" title="6 开发视频配音界面"></a>6 开发视频配音界面</h1><h2 id="6-1-视频列表挖坑开发-1"><a href="#6-1-视频列表挖坑开发-1" class="headerlink" title="6.1 视频列表挖坑开发(1)"></a>6.1 视频列表挖坑开发(1)</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-9E15FAF0-4397-418C-BE0E-D177ABB003BA.png" alt="9E15FAF0-4397-418C-BE0E-D177ABB003BA"></p>
<h2 id="6-2-视频列表挖坑开发-2"><a href="#6-2-视频列表挖坑开发-2" class="headerlink" title="6.2 视频列表挖坑开发(2)"></a>6.2 视频列表挖坑开发(2)</h2><p>完成视频列表的基本雏形，这个雏形远远没有完成，留下许多问题需要解决:</p>
<ol>
<li>resizeMode 是啥？(图片的显示模式)</li>
<li>fontSize 的单位是什么？</li>
<li>如果通过请求获取线上数据？</li>
</ol>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-C88BC6E4-8DDC-4492-9101-0FA459384A9F.png" alt="C88BC6E4-8DDC-4492-9101-0FA459384A9F"></p>
<h2 id="6-3-RN-的异步请求与封装"><a href="#6-3-RN-的异步请求与封装" class="headerlink" title="6.3 RN 的异步请求与封装"></a>6.3 RN 的异步请求与封装</h2><h3 id="6-3-1-RN-的-3-种异步请求方式"><a href="#6-3-1-RN-的-3-种异步请求方式" class="headerlink" title="6.3.1 RN 的 3 种异步请求方式"></a>6.3.1 RN 的 3 种异步请求方式</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-12-B6D9792B-84CC-4A93-8B3E-AA17DA78ABDB.png" alt="B6D9792B-84CC-4A93-8B3E-AA17DA78ABDB"></p>
<p>在 RN 中获取网络数据常见的有上面<a href="http://facebook.github.io/react-native/docs/network.html" target="_blank" rel="external">3种方式</a>，分别说明下。</p>
<p>(1) Fetch<br><strong>说明</strong>: 标准委员会制定的网络 API 的一个标准，在 RN 中直接可用，非常简洁。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>请求地址</td>
</tr>
<tr>
<td>2(可选)</td>
<td>配置项，比如请求方法、请求头设置</td>
</tr>
</tbody>
</table>
<p>(2) WebSocket<br>通过 TCP 连接建立的一个双工模式的数据传输通道，非常强大。</p>
<p>(3) XMLHttpRequest<br>就是我们常说的异步请求接口，是对 iOS 网络层 API 的一个上层封装，类似浏览器提供的 XMLHttpRequest。两者用法差不多，最大的区别是，在浏览器呦同源策略，请求会受到安全限制，不能发起跨域的请求，在 RN 中就没有这个限制。因此可以通过 XHR 实现无后台的 APP，请求第三方开发的接口。如果是在浏览器中的话，往往要借助 JSONP，或者服务端设置，或者通过服务端发送异步请求，在来转发这个数据，最后给到浏览器。</p>
<h3 id="6-3-2-列表页使用-fetch-请求数据"><a href="#6-3-2-列表页使用-fetch-请求数据" class="headerlink" title="6.3.2 列表页使用 fetch 请求数据"></a>6.3.2 列表页使用 fetch 请求数据</h3><p><strong>异步请求的时机</strong>:  一般会在组件挂载之后(componentDidMount)发起异步请求来获取数据。</p>
<p>(1) 使用 <a href="https://www.npmjs.com/package/mockjs" target="_blank" rel="external">mockjs</a> 将来自 Rap 的规则转换为数据。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i mockjs -S</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>: 由于 <code>/node_modules/mockjs/dist/mock.js</code> 的 <code>dataImage</code> 方法使用了 canvas API ，在 RN 中会出问题，需要安装 node-canvas，而后者可能带来更多问题，因此干脆就把这个方法删掉。</p>
<p>(2) 在程序中使用  mockjs 将通过 fetch 的列表数据规则生成数据。</p>
<ul>
<li>通过封装 fetch 抽象出 get 和 post 工具方法；</li>
<li>将请求相关的请求 URL 和请求头等放在配置文件中；</li>
<li>使用上面封装的 get 方法完成对列表数据的请求。</li>
</ul>
<h2 id="6-4-6-5-列表页上滑预加载和下拉刷新效果"><a href="#6-4-6-5-列表页上滑预加载和下拉刷新效果" class="headerlink" title="6.4-6.5 列表页上滑预加载和下拉刷新效果"></a>6.4-6.5 列表页上滑预加载和下拉刷新效果</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-dig_talk_list.gif" alt="dig_talk_list"></p>
<h2 id="6-6-iOS-屏幕尺寸及分辨率知识点解析"><a href="#6-6-iOS-屏幕尺寸及分辨率知识点解析" class="headerlink" title="6.6 iOS 屏幕尺寸及分辨率知识点解析"></a>6.6 iOS 屏幕尺寸及分辨率知识点解析</h2><h3 id="6-6-1-基础知识"><a href="#6-6-1-基础知识" class="headerlink" title="6.6.1 基础知识"></a>6.6.1 基础知识</h3><p><strong>显示单元</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-8F5A96B4-7D69-407D-836F-448F87C2040F.png" alt="8F5A96B4-7D69-407D-836F-448F87C2040F"></p>
<p><strong>英寸(inch)和厘米(cm)</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-E6892C1C-FDCF-4C0B-A10B-F0F83F4186C6.png" alt="E6892C1C-FDCF-4C0B-A10B-F0F83F4186C6"></p>
<h3 id="6-6-2-iphone-6"><a href="#6-6-2-iphone-6" class="headerlink" title="6.6.2 iphone 6"></a>6.6.2 iphone 6</h3><p><strong>屏幕尺寸</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-CC8BA961-F966-4B0C-BBCC-59E454E9794F.png" alt="CC8BA961-F966-4B0C-BBCC-59E454E9794F"></p>
<p><strong>逻辑分辨率 &amp; 设备分辨率 &amp; 设备像素比 &amp; PPI</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-3FB67D4A-A0ED-49AD-9873-209D0C05FA0B.png" alt="3FB67D4A-A0ED-49AD-9873-209D0C05FA0B"></p>
<h3 id="6-6-3-iphone-6-plus"><a href="#6-6-3-iphone-6-plus" class="headerlink" title="6.6.3 iphone 6 plus"></a>6.6.3 iphone 6 plus</h3><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-3297081A-DCD1-4CB1-85B2-AE09391D60D0.png" alt="3297081A-DCD1-4CB1-85B2-AE09391D60D0"></p>
<p><strong>down sampled</strong></p>
<p>实际上，对于 Retina 屏，屏幕上实际的采样会低于真实的设备分辨率，比如 iphone 6 plus 的采样率为 87%，所以 1242 x 2208 的分辨率实际能渲染的像素点为 1080 x 1920。密度有所下降，但肉眼无法分辨。这种把高分辨率以倍数的方式缩小到一个特定分辨率的做法，也就是我们通常所说的视网膜技术。</p>
<h3 id="6-6-4-iPhone-尺寸分布"><a href="#6-6-4-iPhone-尺寸分布" class="headerlink" title="6.6.4 iPhone 尺寸分布"></a>6.6.4 iPhone 尺寸分布</h3><p>市面上有很多中高清屏，像素密度不同，像素比也不同，有1倍的、1.5倍的、4倍的。相关的概念有很多，这里不一一涉及。关于苹果设备的分辨率，下面提供一个像素表。基本包括所有我们需要关心的参数。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-CA41CECC-BD8C-44B4-A089-0C1FDD807CF3.png" alt="CA41CECC-BD8C-44B4-A089-0C1FDD807CF3"></p>
<p>对开发者带来了一些苦恼，好在用户对苹果设备的更新换代速度比较快，所以放在 2016 的当下，我们可以以 iPhone 6 作为基本设备，可以不考虑 iPhone 4 ，向上兼容到 iPhone6 P，向下兼容到 iPhone 5。</p>
<p><strong>宽度自适应</strong><br>在 RN 中，没有百分比这种单位，可以获取屏幕的宽度值，乘一定的比例，从而得到能能够适应不同宽度屏幕的值，动态获取长度值。</p>
<p><strong>图片自适应</strong><br>按照 iPhone 6 P 的分辨率设计图片，然后分别压缩到 750 和 640这两种规格，然后在 RN 中分别动态判断一下，分别引入不同规格的图片。</p>
<p><strong>设计和工程方面的更多话题</strong></p>
<ul>
<li>iPhone 4 到 iPhone 5 为什么宽度不变，高度增加了 88 个点？</li>
<li>iPhone 5 及之后，屏幕的宽高比为什么维持在 0.56 附近，依据是什么？</li>
</ul>
<h2 id="6-7-列表页点赞功能"><a href="#6-7-列表页点赞功能" class="headerlink" title="6.7 列表页点赞功能"></a>6.7 列表页点赞功能</h2><p>(1) 在 Rap 增加点赞的接口<br>(2) 在 Item 组件中实现点赞功能</p>
<h2 id="6-8-RN-导航器-Navigator-的用法"><a href="#6-8-RN-导航器-Navigator-的用法" class="headerlink" title="6.8 RN 导航器 Navigator 的用法"></a>6.8 RN 导航器 Navigator 的用法</h2><p>利用 <a href="http://reactnative.cn/docs/0.44/navigation.html#content" target="_blank" rel="external">Navigator</a> 实现从列表页跳转到详情页的功能。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-navigate_from_list_to_detail.gif" alt="navigate_from_list_to_detail"></p>
<h2 id="6-9-详情页视频播放控制"><a href="#6-9-详情页视频播放控制" class="headerlink" title="6.9 详情页视频播放控制"></a>6.9 详情页视频播放控制</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -S react-native-video</span><br><span class="line">$ react-native link react-native-video</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-1B3A7CAD-DBEC-4669-95AD-DDC92206FB03.png" alt="1B3A7CAD-DBEC-4669-95AD-DDC92206FB03"></p>
<h2 id="6-10-详情页视频播放控制-loading-进度条-重播功能"><a href="#6-10-详情页视频播放控制-loading-进度条-重播功能" class="headerlink" title="6.10 详情页视频播放控制 loading-进度条 -重播功能"></a>6.10 详情页视频播放控制 loading-进度条 -重播功能</h2><p>(1) 视频载入前显示 loading 图标<br>(2) 视频播放中显示进度条<br>(3) 视频播放到最后时，显示重播按钮</p>
<h2 id="6-11-详情页视频播放控制–暂停、播放控制"><a href="#6-11-详情页视频播放控制–暂停、播放控制" class="headerlink" title="6.11 详情页视频播放控制–暂停、播放控制"></a>6.11 详情页视频播放控制–暂停、播放控制</h2><p>(1) 视频播放时，点击播放器会暂停播放，并显示继续播放按钮；<br>(2) 点击继续播放，会隐藏暂停播放的按钮并让视频继续播放。</p>
<h2 id="6-12-详情页视频播放控制–容错处理、返回导航"><a href="#6-12-详情页视频播放控制–容错处理、返回导航" class="headerlink" title="6.12 详情页视频播放控制–容错处理、返回导航"></a>6.12 详情页视频播放控制–容错处理、返回导航</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-1EBF2D97-BC73-44B1-8603-6AFD12601ED7.png" alt="1EBF2D97-BC73-44B1-8603-6AFD12601ED7"></p>
<h2 id="6-13-详情页视频信息补全"><a href="#6-13-详情页视频信息补全" class="headerlink" title="6.13 详情页视频信息补全"></a>6.13 详情页视频信息补全</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-C302B147-4C39-4B10-B7B1-470758992807.png" alt="C302B147-4C39-4B10-B7B1-470758992807"></p>
<h2 id="6-14-获取视频评论列表-1"><a href="#6-14-获取视频评论列表-1" class="headerlink" title="6.14 获取视频评论列表(1)"></a>6.14 获取视频评论列表(1)</h2><p>详情页<br>(1) 在 componentDidMount 时异步加载数据评论；<br>(2) 使用 ListView 外实现评论列表。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-9EE0C411-9DAE-422B-A349-9309C8CBE507.png" alt="9EE0C411-9DAE-422B-A349-9309C8CBE507"></p>
<h2 id="6-15-获取视频评论列表-2"><a href="#6-15-获取视频评论列表-2" class="headerlink" title="6.15 获取视频评论列表(2)"></a>6.15 获取视频评论列表(2)</h2><p>详情页<br>(1) 用 ListView 的 renderHeader 方案取代 ScrollView 嵌套 ListView 的方案；<br>(2) 实现评论列表的分页加载。</p>
<h2 id="6-16-RN-里面提交评论表单-1"><a href="#6-16-RN-里面提交评论表单-1" class="headerlink" title="6.16 RN 里面提交评论表单(1)"></a>6.16 RN 里面提交评论表单(1)</h2><p>(1) 评论列表顶部添加评论框；</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-EA055CC9-F6FF-4047-A891-A41A76302A0A.png" alt="EA055CC9-F6FF-4047-A891-A41A76302A0A"></p>
<p>(2) 获得焦点时，用 RN 的 Modal 组件实现在浮层中显示评论编辑；</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-6CF1C956-66FF-4347-AE7F-1F99D564D36D.png" alt="6CF1C956-66FF-4347-AE7F-1F99D564D36D"></p>
<h2 id="6-17-RN-里面提交评论表单"><a href="#6-17-RN-里面提交评论表单" class="headerlink" title="6.17 RN 里面提交评论表单"></a>6.17 RN 里面提交评论表单</h2><p>(1) 使用 react-native-button 组件创建评论提交按钮</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意:  不需要 react-native link ，可以直接使用！</span></span><br><span class="line">$ npm i -S react-native-button</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-D6A29161-9413-438F-81D7-5E6FDA5AEC50.png" alt="D6A29161-9413-438F-81D7-5E6FDA5AEC50"></p>
<p>(2) 添加提交评论的接口，并在提交完成后关闭评论浮层。<br>遇到一个诡异的问题，如果先设置 state 中的 content 为空字符串，再关闭浮层，就会崩溃；反过来顺序就没事儿。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-13-D58D76CE-3E13-4090-95F1-ABC1799EDD95.png" alt="D58D76CE-3E13-4090-95F1-ABC1799EDD95"></p>
<h1 id="7-RN-知识进阶串讲"><a href="#7-RN-知识进阶串讲" class="headerlink" title="7 RN 知识进阶串讲"></a>7 RN 知识进阶串讲</h1><h2 id="7-1-React-与-MVC"><a href="#7-1-React-与-MVC" class="headerlink" title="7.1 React 与 MVC"></a>7.1 React 与 MVC</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-BB444226-6690-4063-AA7C-D31047EAB84F.png" alt="BB444226-6690-4063-AA7C-D31047EAB84F"></p>
<p>React 革新了传统的 MVC 架构模式。</p>
<p><strong>MVC 架构模式</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-84E70B6A-82A4-4E05-A8E2-E9E6E16B2C3C.png" alt="84E70B6A-82A4-4E05-A8E2-E9E6E16B2C3C"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-834EA6C8-DEF9-41D0-BAC7-8EB7DF02A54B.png" alt="834EA6C8-DEF9-41D0-BAC7-8EB7DF02A54B"></p>
<p><strong>React 架构模式</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-C901DF12-E053-400D-B314-7B500473706B.png" alt="C901DF12-E053-400D-B314-7B500473706B"></p>
<p>React 并不是清清白白的 View，因为每一个组件的内部都可以自行控制数据的变化，也就是 C 的作用。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-B3B9A8EB-0651-4C97-A7A5-4647B4EAAD70.png" alt="B3B9A8EB-0651-4C97-A7A5-4647B4EAAD70"></p>
<p>也就是说，React 组件充当了 View 和 Controller 两种角色。而且组件之间是独立的，组件内部是耦合的，因此组件可以看成 VC 而不是一个简单的 V 。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-2954407D-CC97-40AF-AB7F-58EF436BA678.png" alt="2954407D-CC97-40AF-AB7F-58EF436BA678"></p>
<p><strong>React 组件数据传递</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-520EFCE0-6500-4B8A-8487-672A09457A84.png" alt="520EFCE0-6500-4B8A-8487-672A09457A84"></p>
<h2 id="7-2-RN-的-30-组件"><a href="#7-2-RN-的-30-组件" class="headerlink" title="7.2 RN 的 30+ 组件"></a>7.2 RN 的 30+ 组件</h2><h3 id="7-2-1-组件"><a href="#7-2-1-组件" class="headerlink" title="7.2.1 组件"></a>7.2.1 组件</h3><table>
<thead>
<tr>
<th>序号</th>
<th>v0.45.0-rc.0 版本控件</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>ActivityIndicator</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>Button</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>DatePickerIOS</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>FlatList</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>Image</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>KeyboardAvoidingView</td>
<td></td>
</tr>
<tr>
<td>7</td>
<td>Layout</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>ListView</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>Modal</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>FlatList</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>NavigatorIOS</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>Picker</td>
<td></td>
</tr>
<tr>
<td>13</td>
<td>PickerIOS</td>
<td></td>
</tr>
<tr>
<td>14</td>
<td>ProgressViewIOS</td>
<td></td>
</tr>
<tr>
<td>15</td>
<td>RegreshControl</td>
<td></td>
</tr>
<tr>
<td>16</td>
<td>ScrollView</td>
<td></td>
</tr>
<tr>
<td>17</td>
<td>SectionList</td>
<td></td>
</tr>
<tr>
<td>18</td>
<td>SegmentedControlIOS</td>
<td></td>
</tr>
<tr>
<td>19</td>
<td>Slider</td>
<td></td>
</tr>
<tr>
<td>20</td>
<td>StatusBar</td>
<td></td>
</tr>
<tr>
<td>21</td>
<td>SwipeableListView</td>
<td></td>
</tr>
<tr>
<td>22</td>
<td>Switch</td>
<td></td>
</tr>
<tr>
<td>23</td>
<td>TabBarIOS</td>
<td></td>
</tr>
<tr>
<td>24</td>
<td>Text</td>
<td></td>
</tr>
<tr>
<td>25</td>
<td>TextInput</td>
<td></td>
</tr>
<tr>
<td>26</td>
<td>Touchable*</td>
<td></td>
</tr>
<tr>
<td>27</td>
<td>TrabsparentHitTestExample</td>
<td></td>
</tr>
<tr>
<td>28</td>
<td>View</td>
<td></td>
</tr>
<tr>
<td>29</td>
<td>WebView</td>
</tr>
</tbody>
</table>
<h3 id="7-2-2-运行官方-RN-示例"><a href="#7-2-2-运行官方-RN-示例" class="headerlink" title="7.2.2 运行官方 RN 示例"></a>7.2.2 运行官方 RN 示例</h3><p><a href="https://github.com/facebook/react-native" target="_blank" rel="external">react-native GitHub</a>，当下的最新版本为 <code>v0.45.0-rc.0</code>。官方提供了 RN 使用的 demos ，路径为<a href="https://github.com/facebook/react-native/tree/master/RNTester" target="_blank" rel="external">react-native/RNTester</a>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/facebook/react-native.git</span><br><span class="line">$ <span class="built_in">cd</span> react-native &amp;&amp; npm install</span><br><span class="line">$ <span class="built_in">cd</span> RNTester &amp;&amp; open .</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-2B9F739E-2C27-4FEB-A5DD-6EEEB6D818BA.png" alt="2B9F739E-2C27-4FEB-A5DD-6EEEB6D818BA"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-93C08351-31F6-40C4-B208-A87255889259.png" alt="93C08351-31F6-40C4-B208-A87255889259"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-B6539CF5-B6AA-4F64-B64C-D562B1401E9C.png" alt="B6539CF5-B6AA-4F64-B64C-D562B1401E9C"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-F948F4E2-D122-4224-A4BC-01D55FB84763.png" alt="F948F4E2-D122-4224-A4BC-01D55FB84763"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-CEBB97A5-3C64-4EAF-A1AB-E9A96DC31F79.png" alt="CEBB97A5-3C64-4EAF-A1AB-E9A96DC31F79"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-D758664D-50B0-4D05-9FAC-F0ED2AF61EBA.png" alt="D758664D-50B0-4D05-9FAC-F0ED2AF61EBA"></p>
<p>示例程序中有每种组件的各种用法演示，比图  View</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-2A2EE967-F031-4983-AA3A-4BA8129F529E.png" alt="2A2EE967-F031-4983-AA3A-4BA8129F529E"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-752FD120-9182-456E-9803-A7651ADF4DB7.png" alt="752FD120-9182-456E-9803-A7651ADF4DB7"></p>
<h2 id="7-3-Flexbox-弹性布局的魔法属性"><a href="#7-3-Flexbox-弹性布局的魔法属性" class="headerlink" title="7.3 Flexbox 弹性布局的魔法属性"></a>7.3 Flexbox 弹性布局的魔法属性</h2><p>RN 使用的是 flexbox (弹性盒子伸缩布局，或者叫伸缩容器布局)。当页面适配不同屏幕不同宽度的时候，让所有元素能够以一种合适的方式来呈现。有两点需要注意：</p>
<ol>
<li>RN 的 flexbox 跟 css3 的 flexbox 属性名称写法不同， RN 里面全部是驼峰标示；</li>
<li>RN 的 flexbox 支持的属性很有限，它是 Flexbox 的一个子集。</li>
</ol>
<p><strong>要把子项目放进去到父容器，一共分几步？</strong><br>3 步<br>(1) 父容器定义对齐方式<br>(2) 子项目扔到父容器<br>(3) 子项目定义个性对齐样式</p>
<h3 id="flexDirection"><a href="#flexDirection" class="headerlink" title="flexDirection"></a>flexDirection</h3><table>
<thead>
<tr>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>row</td>
<td>子项目一律从左往右，一个挨一个地排列到右侧</td>
</tr>
<tr>
<td>column(默认)</td>
<td>子项目竖着排列，从上往下一个一个挨着排</td>
</tr>
</tbody>
</table>
<h3 id="flexWrap"><a href="#flexWrap" class="headerlink" title="flexWrap"></a>flexWrap</h3><table>
<thead>
<tr>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>wrap</td>
<td>主轴上排不下，就折行继续排</td>
</tr>
<tr>
<td>nowrap(默认)</td>
<td>主轴上排不下也不折行，溢出父容器</td>
</tr>
</tbody>
</table>
<h3 id="justifyContent"><a href="#justifyContent" class="headerlink" title="justifyContent"></a>justifyContent</h3><p>沿主轴方向的排列方式。</p>
<table>
<thead>
<tr>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>flex-start(默认)</td>
<td>沿主轴居前</td>
</tr>
<tr>
<td>flex-end</td>
<td>沿主轴居后</td>
</tr>
<tr>
<td>space-between</td>
<td>沿主轴向两边对齐</td>
</tr>
<tr>
<td>space-around</td>
<td>沿主轴平分空间</td>
</tr>
<tr>
<td>center</td>
<td>沿主轴居中排列</td>
</tr>
</tbody>
</table>
<h3 id="alignItems"><a href="#alignItems" class="headerlink" title="alignItems"></a>alignItems</h3><p>沿侧轴方向的空间利用（排列）方式。在父元素上定义，作用在子元素。</p>
<table>
<thead>
<tr>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>center</td>
<td>沿侧轴垂直</td>
</tr>
<tr>
<td>flex-start(默认)</td>
<td>沿侧轴居前</td>
</tr>
<tr>
<td>flex-end</td>
<td>沿侧轴居后</td>
</tr>
<tr>
<td>stretch</td>
<td>沿侧轴方向拉伸子元素，直到填充完父容器边界</td>
</tr>
</tbody>
</table>
<h2 id="7-4-Flex-弹性布局的魔法属性"><a href="#7-4-Flex-弹性布局的魔法属性" class="headerlink" title="7.4 Flex 弹性布局的魔法属性"></a>7.4 Flex 弹性布局的魔法属性</h2><h3 id="alignSelf"><a href="#alignSelf" class="headerlink" title="alignSelf"></a>alignSelf</h3><p>类似 alignItems，不同的地方在于它声明在子元素上也作用在子元素。覆盖在父元素上设置的 alignItems 对子元素的作用。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-7DEE610A-EEC2-4962-A55A-DC69C9A4E8F3.png" alt="7DEE610A-EEC2-4962-A55A-DC69C9A4E8F3"></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * Sample React Native App</span><br><span class="line"> * https://github.com/facebook/react-native</span><br><span class="line"> * @flow</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  StyleSheet,</span><br><span class="line">  View,</span><br><span class="line">  Text</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;[styles.item,</span> <span class="attr">styles.item1</span>]&#125;&gt;</span>1111111111111<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;[styles.item,</span> <span class="attr">styles.item2</span>]&#125;&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">Text</span>&gt;</span>22222222222222<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;[styles.item,</span> <span class="attr">styles.item3</span>]&#125;&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">Text</span>&gt;</span>33333333333333<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</span><br><span class="line">  container: &#123;</span><br><span class="line">    flex: <span class="number">1</span>,</span><br><span class="line">    flexDirection: <span class="string">'row'</span>,</span><br><span class="line">    flexWrap: <span class="string">'nowrap'</span>,</span><br><span class="line">    paddingTop: <span class="number">30</span>,</span><br><span class="line">    paddingBottom: <span class="number">70</span>,</span><br><span class="line">    justifyContent: <span class="string">'space-between'</span>,</span><br><span class="line">    alignItems: <span class="string">'flex-end'</span>,</span><br><span class="line">    backgroundColor: <span class="string">'#ff6600'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  item1: &#123;</span><br><span class="line">    backgroundColor: <span class="string">'#ccc'</span>,</span><br><span class="line">    alignSelf: <span class="string">'flex-start'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  item2: &#123;</span><br><span class="line">    backgroundColor: <span class="string">'#999'</span>,</span><br><span class="line">    alignSelf: <span class="string">'center'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  item3: &#123;</span><br><span class="line">    backgroundColor: <span class="string">'#666'</span>,</span><br><span class="line">    alignSelf: <span class="string">'flex-end'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h3><p>控制元素沿主轴方向所占空间的多少。</p>
<h2 id="7-5-如何甄选第三方组件"><a href="#7-5-如何甄选第三方组件" class="headerlink" title="7.5 如何甄选第三方组件"></a>7.5 如何甄选第三方组件</h2><h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><ul>
<li><a href="https://github.com/search.html" target="_blank" rel="external">Github Search</a></li>
<li><a href="https://react.parts/native" target="_blank" rel="external">react.parts Search</a></li>
</ul>
<h3 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h3><ul>
<li>在 GitHub 比较</li>
</ul>
<p>比较依据:</p>
<p>（1） star 数量: 值越大，反应组件越受欢迎<br>（2） Fork 数量:值越大， 反映了参与这个组件开发的人数越多，同时也说明该组件不能满足用户的情况也多。<br>（3） Pull requests: 值越大，尤其是 closed 的数量越多，反应组件越活跃，完善的可能性越大。<br>（4） Issues: 值越大，反应问题越多，其中 closed 的越多代表作者越积极地在完善组件。<br>（5） 最近的更新时间<br>（6） 兼容性</p>
<ul>
<li>stackoverflow 相关问题数量</li>
<li>文档是否规范，最好有效果示意图</li>
<li>示例代码是否丰富</li>
</ul>
<h2 id="7-6-RN-的-AsyncStorage-异步存储"><a href="#7-6-RN-的-AsyncStorage-异步存储" class="headerlink" title="7.6 RN 的 AsyncStorage 异步存储"></a>7.6 RN 的 AsyncStorage 异步存储</h2><p><strong>说明</strong>: RN 官方为我们提供了 AsyncStorage 这个异步持久化方案，它采用键值对存储系统，跟浏览器的 localStorage 本地存储有相似之处。<br><strong>注意</strong>: 官方是建议我们对 AsyncStorage 进行抽象封装之后再使用，而不是直接使用它，因为 AsyncStorage 是全局操作的。</p>
<p>这节先演示下原生的 AsyncStorage 是如何存储和取值的，等到实际项目的时候再来使用 AsyncStorage 的封装模块。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">AsyncStorage</span><br><span class="line">     .getItem(<span class="string">'user'</span>)</span><br><span class="line">     // 如果能拿到 user 这个数据，则将本地的这个数据同步到 state，然后再修改后存储到本地</span><br><span class="line">     .then(data =&gt; &#123;</span><br><span class="line">       <span class="keyword">if</span> (data) &#123;</span><br><span class="line">         console.log(data)</span><br><span class="line">         data = JSON.parse(data)</span><br><span class="line">         this.setState(&#123;</span><br><span class="line">           user: data</span><br><span class="line">         &#125;, () =&gt; &#123;</span><br><span class="line">           data.times++</span><br><span class="line">           const userData = JSON.stringify(data)</span><br><span class="line"></span><br><span class="line">           AsyncStorage</span><br><span class="line">             .setItem(<span class="string">'user'</span>, userData)</span><br><span class="line">             .then(() =&gt; &#123;</span><br><span class="line">               console.log(<span class="string">'save ok'</span>)</span><br><span class="line">             &#125;)</span><br><span class="line">             .catch(err =&gt; &#123;</span><br><span class="line">               console.log(err)</span><br><span class="line">               console.log(<span class="string">'save failes'</span>)</span><br><span class="line">             &#125;)</span><br><span class="line">         &#125;)</span><br><span class="line">       &#125;</span><br><span class="line">       // 如果 user 这个这个数据不存在，就从 state 拿出来，编辑后存到本地</span><br><span class="line">       <span class="keyword">else</span> &#123;</span><br><span class="line">         const user = this.state.user</span><br><span class="line">         user.times++</span><br><span class="line">         const userData = JSON.stringify(user)</span><br><span class="line">         AsyncStorage</span><br><span class="line">           .setItem(<span class="string">'user'</span>, userData)</span><br><span class="line">           .catch(err =&gt; &#123;</span><br><span class="line">             console.log(err)</span><br><span class="line">             console.log(<span class="string">'save fails'</span>)</span><br><span class="line">           &#125;)</span><br><span class="line">           .then(() =&gt; &#123;</span><br><span class="line">             console.log(<span class="string">'save ok'</span>)</span><br><span class="line">           &#125;)</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;)</span><br></pre></td></tr></table></figure>
<h2 id="7-7-如何在手机上安装演示-RN-原型项目"><a href="#7-7-如何在手机上安装演示-RN-原型项目" class="headerlink" title="7.7 如何在手机上安装演示 RN 原型项目"></a>7.7 如何在手机上安装演示 RN 原型项目</h2><p>(1) 数据线连接 Mac<br>(2) 清理 Mac 上的 RN 环境<br>(3)  localhost 改为 Wi-Fi 环境下的 IP 地址</p>
<p>以 imoocApp 这个项目为例:<br><strong>imoocApp/ios/imoocApp/AppDelegate.m</strong></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-14-06A34D33-B556-43A7-B417-EBA2B557B443.png" alt="06A34D33-B556-43A7-B417-EBA2B557B443"> </p>
<p>(4) Xcode 选择 iphone 真机来启动</p>
<h1 id="8-App-內注册登录"><a href="#8-App-內注册登录" class="headerlink" title="8 App 內注册登录"></a>8 App 內注册登录</h1><h2 id="8-1-伪造-Rap-注册登录接口"><a href="#8-1-伪造-Rap-注册登录接口" class="headerlink" title="8.1 伪造 Rap 注册登录接口"></a>8.1 伪造 Rap 注册登录接口</h2><p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-16-92F80514-7EE1-439A-BA4C-77F915B1BF8D.png" alt="92F80514-7EE1-439A-BA4C-77F915B1BF8D"></p>
<h2 id="8-2-实现注册登录页面1-输入验证码"><a href="#8-2-实现注册登录页面1-输入验证码" class="headerlink" title="8.2 实现注册登录页面1(输入验证码)"></a>8.2 实现注册登录页面1(输入验证码)</h2><p>(1) 伪造发送验证码接口;<br>(2) 完成登录界面基本 UI 部分；</p>
<h2 id="8-3-实现注册登录页面2-倒计时"><a href="#8-3-实现注册登录页面2-倒计时" class="headerlink" title="8.3 实现注册登录页面2(倒计时)"></a>8.3 实现注册登录页面2(倒计时)</h2><p>(1) 伪造登录接口；</p>
<p>(2) 使用 <a href="https://github.com/laputa-er/react-native-sk-countdown" target="_blank" rel="external">react-native-sk-countdown</a>实现倒计时重新获取验证码功能;<br>由于<a href="https://github.com/shigebeyond/react-native-sk-countdown" target="_blank" rel="external">第三方的react-native-sk-countdown</a>似乎已经停止维护，对 RN 0.44 不兼容，因此我<a href="https://github.com/laputa-er/react-native-sk-countdown" target="_blank" rel="external">Fork 了一个新项目</a>，修复了部分兼容问题。</p>
<h2 id="8-4-本地管理应用登录状态"><a href="#8-4-本地管理应用登录状态" class="headerlink" title="8.4 本地管理应用登录状态"></a>8.4 本地管理应用登录状态</h2><p>登录流程</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-21-C9BDDE9C-DAB5-4939-B7F5-31E8B337C5BB.png" alt="C9BDDE9C-DAB5-4939-B7F5-31E8B337C5BB"></p>
<h1 id="9-用户账户页面"><a href="#9-用户账户页面" class="headerlink" title="9 用户账户页面"></a>9 用户账户页面</h1><h2 id="9-1-9-3-头像展示与相册选取"><a href="#9-1-9-3-头像展示与相册选取" class="headerlink" title="9.1-9.3 头像展示与相册选取"></a>9.1-9.3 头像展示与相册选取</h2><ul>
<li>使用 react-native-image-native 从本地选择图片作为头像</li>
</ul>
<p><strong>选择图片崩溃的问题</strong><br>要在 iOS 10 中正常使用 react-native-image-native，需要设置 <code>info.plist</code>：</p>
<ul>
<li><a href="https://github.com/react-community/react-native-image-picker/issues/562" target="_blank" rel="external">参考1</a></li>
<li><a href="http://www.jianshu.com/p/c212cde86877" target="_blank" rel="external">参考2</a></li>
</ul>
<h2 id="9-4-9-5-XHR-异步上传图片到-cloudinary-图床"><a href="#9-4-9-5-XHR-异步上传图片到-cloudinary-图床" class="headerlink" title="9.4-9.5 XHR 异步上传图片到 cloudinary 图床"></a>9.4-9.5 XHR 异步上传图片到 cloudinary 图床</h2><p><a href="https://cloudinary.com/console/settings/account" target="_blank" rel="external">cloudinary.com</a></p>
<p>(1) 在 cloudinary.com <a href="https://cloudinary.com/console/settings/account" target="_blank" rel="external">配置好空间信息</a></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-25-7EE44700-7980-4222-8195-FF44685DE6B2.png" alt="7EE44700-7980-4222-8195-FF44685DE6B2"></p>
<p>(2) 在 RAP 创建假的签名验证接口，然后在项目中中模拟签名验证过程<br>(3) 项目中实现上传逻辑</p>
<ul>
<li>读取本地相册</li>
<li>构建上传的表单</li>
<li>发起异步请求</li>
<li>针对图床个性化的签名</li>
</ul>
<h2 id="9-6-9-7-饼状图显示图片上传进度"><a href="#9-6-9-7-饼状图显示图片上传进度" class="headerlink" title="9.6-9.7 饼状图显示图片上传进度"></a>9.6-9.7 饼状图显示图片上传进度</h2><h3 id="1-安装-react-native-progress"><a href="#1-安装-react-native-progress" class="headerlink" title="1  安装 react-native-progress"></a>1  安装 react-native-progress</h3><p>安装 <a href="https://github.com/oblador/react-native-progress" target="_blank" rel="external">react-native-progress</a> 组件，并通过 xcode 手动添加到工程中（ART 不支持通过 <code>react-native link</code> 引入）</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-F6CF9482-1C97-4EB8-B747-587D15CBEF39.png" alt="F6CF9482-1C97-4EB8-B747-587D15CBEF39"></p>
<p>(1) 在 xcode 中手动添加 ART 到 iOS 工程中</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-B11C2C42-8E91-4B50-8190-79806B7CC84C.png" alt="B11C2C42-8E91-4B50-8190-79806B7CC84C"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-A07E9217-B50D-4030-953B-A5AF0D1585A4.png" alt="A07E9217-B50D-4030-953B-A5AF0D1585A4"><br>(2) 配置引入的 ART 库<br><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-CFAEDF54-24C6-493A-9EF3-505795880056.png" alt="CFAEDF54-24C6-493A-9EF3-505795880056"></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-26-5DEF9FE5-504B-4222-86F4-A21A02DF8E16.png" alt="5DEF9FE5-504B-4222-86F4-A21A02DF8E16"></p>
<p>(3) 重启调试环境，包括 <code>run-ios</code>、模拟器</p>
<h3 id="2-完成上传进度"><a href="#2-完成上传进度" class="headerlink" title="2 完成上传进度"></a>2 完成上传进度</h3><h3 id="3-完成图像上传成功后的后续处理"><a href="#3-完成图像上传成功后的后续处理" class="headerlink" title="3 完成图像上传成功后的后续处理"></a>3 完成图像上传成功后的后续处理</h3><ul>
<li>更新服务器上用户的头像数据</li>
<li>将更新的数据留一份在本地(AsyncStorage)，从而每次打开都是最新上传的那个头像</li>
</ul>
<h2 id="9-8-9-9-编辑和保存用户资料"><a href="#9-8-9-9-编辑和保存用户资料" class="headerlink" title="9.8-9.9 编辑和保存用户资料"></a>9.8-9.9 编辑和保存用户资料</h2><p>(1) 丰富“用户资料更新”接口的字段<br>(2) 实现在弹出 Modal 编辑用户资料界面功能<br>(3) 实现保存资料和退出登录</p>
<h1 id="10-用-Koa-开发本地-API-后台"><a href="#10-用-Koa-开发本地-API-后台" class="headerlink" title="10 用 Koa 开发本地 API 后台"></a>10 用 Koa 开发本地 API 后台</h1><h2 id="10-1-本地安装-Mongodb-数据库"><a href="#10-1-本地安装-Mongodb-数据库" class="headerlink" title="10.1 本地安装 Mongodb 数据库"></a>10.1 本地安装 Mongodb 数据库</h2><p><strong>注意</strong>： 因为之前在虚拟机(Arch Linux)上装过一个 MongoDB 数据库(参见<a href="http://laputa-er.github.io/2017/04/22/%E6%85%95%E8%AF%BE%E7%BD%91/imooc_NodeJS%20%E7%BA%BF%E4%B8%8A%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%E4%B8%8E%E5%8F%91%E5%B8%83/">《NodeJS线上服务器部署与发布-2.2.2》</a>)，所以后面实际的练习是在用的虚拟机上的数据库。如果没有特别的原因，并不推荐在 OS X 上装一个数据库，因为污染开发环境。</p>
<p><strong>安装和使用</strong><br>(1) <a href="https://brew.sh/" target="_blank" rel="external">Homebrew</a></p>
<p>(2) <a href="https://docs.mongodb.com/master/tutorial/install-mongodb-on-os-x/" target="_blank" rel="external">Install MongoDB Community Edition on OS X</a></p>
<p>如果下载有问题，可以这样做</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /Users/&lt;你的用户名&gt;/Library/Caches/Homebrew</span><br><span class="line">$ brew prune <span class="comment"># 清理下</span></span><br><span class="line">$ brew install mongodb</span><br></pre></td></tr></table></figure>
<p>(3) 启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mongod</span><br></pre></td></tr></table></figure>
<p>(4) 登录数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mongo</span><br></pre></td></tr></table></figure>
<p><strong>扩展</strong>: 如果需要卸载 OS X 上的 MongoDB</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew unlink mongodb &amp;&amp; brew uninstall mongodb</span><br></pre></td></tr></table></figure>
<h2 id="10-2-搭建-Koa-初始项目架构"><a href="#10-2-搭建-Koa-初始项目架构" class="headerlink" title="10.2 搭建 Koa 初始项目架构"></a>10.2 搭建 Koa 初始项目架构</h2><p><strong>注意</strong>： 课程中使用的是 koa1 ，我实践中使用的是 koa2，两者 api 还有有不少差异的，主要是 koa2 全面使用了 async/await 这种 ES2017 语法。</p>
<h3 id="目录和-package-json"><a href="#目录和-package-json" class="headerlink" title="目录和 package.json"></a>目录和 package.json</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir dogtalk-server</span><br><span class="line">$ <span class="built_in">cd</span> dogtalk-server</span><br><span class="line">$ npm init</span><br><span class="line">$ npm i -S koa koa-logger koa-session koa-bodyparser koa-router mongoose sha1 lodash uuid xss bluebird speakeasy</span><br></pre></td></tr></table></figure>
<h3 id="依赖的第三方库"><a href="#依赖的第三方库" class="headerlink" title="依赖的第三方库"></a>依赖的第三方库</h3><ul>
<li><a href="https://www.npmjs.com/package/koa" target="_blank" rel="external">koa</a></li>
<li><a href="https://www.npmjs.com/package/koa-logger" target="_blank" rel="external">koa-logger</a>: 开发环境下的日志中间件，作用于请求的最先和最后环节，建议放到应用的最开始部分。</li>
<li><a href="https://www.npmjs.com/package/koa-session" target="_blank" rel="external">koa-session</a>: 基于 cookie 的会话中间件，保持用户会话状态。可以在 seesion 中存储一些会话中的数据。</li>
<li><a href="https://www.npmjs.com/package/koa-bodyparser" target="_blank" rel="external">koa-bodyparser</a>: 解析表单数据等等来生成对象结构数据的中间件</li>
<li><a href="https://www.npmjs.com/package/koa-router" target="_blank" rel="external">koa-router</a>: 路由中间件，为不同的 url 地址分配不同的规则。</li>
<li><a href="https://www.npmjs.com/package/mongoose" target="_blank" rel="external">mongoose</a>: Mongodb 数据库的对象建模工具。</li>
<li><a href="https://www.npmjs.com/package/sha1" target="_blank" rel="external">sha1</a>: 哈希算法库，加密一些数据用。</li>
<li><a href="https://www.npmjs.com/package/lodash" target="_blank" rel="external">lodash</a>: js 编程的一把瑞士军刀，提供许多好用的工具函数。</li>
<li><a href="https://www.npmjs.com/package/uuid" target="_blank" rel="external">uuid</a>: 用来生成唯一的不会重复的 ID。</li>
<li><a href="https://www.npmjs.com/package/xss" target="_blank" rel="external">xss</a>: 一个对用户数据的内容进行过滤，避免 XSS 恶意攻击的模块。</li>
<li><a href="https://www.npmjs.com/package/bluebird" target="_blank" rel="external">bluebird</a>: 对于 promise 规范实现封装后的 promise 库，有更优雅的 API 和更好的性能。</li>
<li><a href="https://www.npmjs.com/package/speakeasy" target="_blank" rel="external">speakeasy</a>: 基于一系列安全算法，能生成随机数字的工具库，比如短信验证码。</li>
</ul>
<h2 id="10-3-Koa-中配置使用-Mondodb"><a href="#10-3-Koa-中配置使用-Mondodb" class="headerlink" title="10.3 Koa 中配置使用 Mondodb"></a>10.3 Koa 中配置使用 Mondodb</h2><h3 id="10-3-1-增加需要的数据库用户"><a href="#10-3-1-增加需要的数据库用户" class="headerlink" title="10.3.1 增加需要的数据库用户"></a>10.3.1 增加需要的数据库用户</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建超级用户</span></span><br><span class="line">&gt; use admin</span><br><span class="line">&gt; db.createUser(&#123;user: <span class="string">'imooc_cases_owner'</span>, <span class="built_in">pwd</span>: <span class="string">'Safe1*24$'</span>, roles: [&#123;role: <span class="string">'userAdminAnyDatabase'</span>, db: <span class="string">'admin'</span>&#125;]&#125;)</span><br><span class="line">&gt; db.auth(<span class="string">'imooc_cases_owner'</span>, <span class="string">'Safe1*24$'</span>)</span><br><span class="line"><span class="comment"># 创建 dogtalk 数据库用户</span></span><br><span class="line">&gt; use dogtalk</span><br><span class="line">&gt; db.createUser(&#123;user: <span class="string">'dogtalk_runner'</span>, <span class="built_in">pwd</span>: <span class="string">'F**k9001$'</span>, roles: [&#123;role: <span class="string">'readWrite'</span>, db: <span class="string">'dogtalk'</span>&#125;]&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="10-3-2-mongoose-model"><a href="#10-3-2-mongoose-model" class="headerlink" title="10.3.2 mongoose model"></a>10.3.2 mongoose model</h3><p><strong>技巧</strong>: 由于 Model 可能会很多，因此推荐动态递归遍历加载需要的数据库对应的 Model。</p>
<h2 id="10-5-10-6-用螺丝帽在-Koa-中发送短信"><a href="#10-5-10-6-用螺丝帽在-Koa-中发送短信" class="headerlink" title="10.5-10.6 用螺丝帽在 Koa 中发送短信"></a>10.5-10.6 用螺丝帽在 Koa 中发送短信</h2><p><a href="https://luosimao.com/" target="_blank" rel="external">螺丝帽</a>可以为开发者提供一系列服务，包括</p>
<ul>
<li>短信服务</li>
<li>语音验证</li>
<li>邮件服务</li>
<li>人机验证</li>
</ul>
<h3 id="螺丝帽短信服务"><a href="#螺丝帽短信服务" class="headerlink" title="螺丝帽短信服务"></a>螺丝帽短信服务</h3><p>使用螺丝帽配置短信服务：<br>(1) 注册账号</p>
<p>(2) 在管理台中添加签名</p>
<p>(3) 在管理台中添加短信模版</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-30-6C92A268-6A76-487C-A70F-D221F743E5B8.png" alt="6C92A268-6A76-487C-A70F-D221F743E5B8"></p>
<p>(4) 查看接口文档的<a href="https://luosimao.com/docs/api/30" target="_blank" rel="external">示例</a></p>
<h3 id="实现短信发送"><a href="#实现短信发送" class="headerlink" title="实现短信发送"></a>实现短信发送</h3><p>(1) 在官方示例代码的基础上进行修改</p>
<ul>
<li><a href="https://sms-my.luosimao.com/api" target="_blank" rel="external">API KEY</a></li>
<li><a href="https://sms-my.luosimao.com/api" target="_blank" rel="external">API 错误代码码</a></li>
</ul>
<p>(2) 实现<code>发送短信验证码</code>-<code>校验短信验证码</code>逻辑</p>
<h2 id="10-7-用-DHC-插件-Restlet-Client-快速测试本地-API-服务"><a href="#10-7-用-DHC-插件-Restlet-Client-快速测试本地-API-服务" class="headerlink" title="10.7 用 DHC 插件(Restlet Client)快速测试本地 API 服务"></a>10.7 用 DHC 插件(Restlet Client)快速测试本地 API 服务</h2><p><strong>说明</strong>: DHC 看样子改名为 Restlet Client 了。<br>(1) 根据从 RAP 到处的接口文档实现后台接口，然后通过 Restlet Client  测试接口能否正常工作。以 <code>用户资料更新</code>接口为例：</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/2017-05-31-60254477-FCA7-4E96-945C-FAB63847C73C.png" alt="60254477-FCA7-4E96-945C-FAB63847C73C"></p>
<p>(2) 通过定义中间件实现对请求的统一校验<br>(3) 注意看看是否都进行了xss 处理</p>
<p><strong>知识点</strong>: 用户提交的需要持久化到数据库或用于查询数据库的字段都需要经过 trim 和 xss 处理。</p>
<h2 id="10-8-服务器端实现图床签名接口"><a href="#10-8-服务器端实现图床签名接口" class="headerlink" title="10.8 服务器端实现图床签名接口"></a>10.8 服务器端实现图床签名接口</h2><p>(1) 原先的签名信息是由客户端生成的，这种方式不够安全，现在改为在服务器端生成。<br>(2) 发现原来 koa-router 中间件写法有错误，修正了下。<br>(3) 至此，打通了以下接口</p>
<ul>
<li>注册并获取验证码(<code>/api/u/signup</code>)</li>
<li>验证用户提交的验证码是否正确(<code>/api/u/verify</code>)</li>
<li>更具上传的头像相关信息，从服务器获取签名信息(<code>/api/signature</code>)</li>
<li>上传用户头像到 cloudinary.com，然后更新用户头像信息(<code>/api/u/update</code>)</li>
</ul>
<h2 id="10-9-10-10-用七牛上传图片资源"><a href="#10-9-10-10-用七牛上传图片资源" class="headerlink" title="10.9-10.10 用七牛上传图片资源"></a>10.9-10.10 用七牛上传图片资源</h2>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/MongoDB/" rel="tag">#MongoDB</a>
          
            <a href="/tags/ReactNative/" rel="tag">#ReactNative</a>
          
            <a href="/tags/nodejs/" rel="tag">#nodejs</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/22/慕课网/imooc_NodeJS 线上服务器部署与发布/" rel="next" title="NodeJS线上服务器部署与发布">
                <i class="fa fa-chevron-left"></i> NodeJS线上服务器部署与发布
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/05/04/BOOK_Webkit技术内幕/0/" rel="prev" title="0 目录">
                0 目录 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/05/01/慕课网/imooc_React-Native-贯穿全栈开发-APP/"
           data-title="React Native 贯穿全栈开发 APP" data-url="http://laputa-er.github.io/2017/05/01/慕课网/imooc_React-Native-贯穿全栈开发-APP/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Sean" />
          <p class="site-author-name" itemprop="name">Sean</p>
          <p class="site-description motion-element" itemprop="description">整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">218</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0-课程介绍"><span class="nav-text">0 课程介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0-1-谁需要这门课程？"><span class="nav-text">0.1 谁需要这门课程？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0-2-实战项目介绍"><span class="nav-text">0.2 实战项目介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0-3-APP-功能介绍"><span class="nav-text">0.3 APP 功能介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#桌面图标和启动画面"><span class="nav-text">桌面图标和启动画面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过度页面和轮播效果"><span class="nav-text">过度页面和轮播效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注册登录和账户管理"><span class="nav-text">注册登录和账户管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视频的配音制作页面"><span class="nav-text">视频的配音制作页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#展现所有制作完毕的创意视频列表"><span class="nav-text">展现所有制作完毕的创意视频列表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0-4-APP-后台"><span class="nav-text">0.4 APP 后台</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0-5-要点"><span class="nav-text">0.5 要点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#环境搭建"><span class="nav-text">环境搭建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#服务器端"><span class="nav-text">服务器端</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前后端连调"><span class="nav-text">前后端连调</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-课程预热"><span class="nav-text">1 课程预热</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-React-与-React-Native"><span class="nav-text">1.1 React 与 React Native</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#React-Native-的性能"><span class="nav-text">React Native 的性能</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-为何选择-React-Native"><span class="nav-text">1.2 为何选择 React Native</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-RN-适合你吗？"><span class="nav-text">1.3 RN 适合你吗？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-初识-React-Native"><span class="nav-text">2 初识 React Native</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-本地环境搭建"><span class="nav-text">2.1 本地环境搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-忍不住尝尝鲜"><span class="nav-text">2.2 忍不住尝尝鲜</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-了解-RN-项目代码结构"><span class="nav-text">2.3 了解 RN 项目代码结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#准备"><span class="nav-text">准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#目录"><span class="nav-text">目录</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-RN-入门知识学习"><span class="nav-text">3 RN 入门知识学习</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-如何选择-RN-版本"><span class="nav-text">3.1 如何选择 RN 版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-React-的组件生命周期"><span class="nav-text">3.2 React 的组件生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-1-传统的-web-开发中的组件"><span class="nav-text">3.2.1 传统的 web  开发中的组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-2-React-的组件"><span class="nav-text">3.2.2 React 的组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#React-生命周期图示"><span class="nav-text">React 生命周期图示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-3-RN-示例"><span class="nav-text">3.2.3 RN 示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-父子组件撕逼大战"><span class="nav-text">3.3 父子组件撕逼大战</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-1-代码"><span class="nav-text">3.3.1 代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-2-分析"><span class="nav-text">3.3.2 分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-ES5-和-ES6-两种组件形态"><span class="nav-text">3.4 ES5 和 ES6 两种组件形态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-1-ECMAScript-历史"><span class="nav-text">3.4.1 ECMAScript 历史</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-2-ES5-和-ES6-两种组件实现方式的对比"><span class="nav-text">3.4.2 ES5 和 ES6 两种组件实现方式的对比</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#要点"><span class="nav-text">要点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#案例"><span class="nav-text">案例</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-升级-React-Native-的重要补录"><span class="nav-text">4 升级 React Native 的重要补录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-一期答疑总结"><span class="nav-text">4.1 一期答疑总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#好习惯"><span class="nav-text">好习惯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常见问题"><span class="nav-text">常见问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-Run-起来课程源代码"><span class="nav-text">4.2 Run 起来课程源代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1-检查环境"><span class="nav-text">4.2.1 检查环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2-升级项目"><span class="nav-text">4.2.2 升级项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3-保持环境干净"><span class="nav-text">4.2.3 保持环境干净</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-4-跑起来"><span class="nav-text">4.2.4 跑起来</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-5-错误修复"><span class="nav-text">4.2.5 错误修复</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-暴力升级到-0-36-上"><span class="nav-text">4.3 暴力升级到 0.36 (上)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-暴力升级到-0-36-下"><span class="nav-text">4.4 暴力升级到 0.36(下)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-课程进阶拥抱-ES6-上"><span class="nav-text">4.4 课程进阶拥抱 ES6(上)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-课程进阶拥抱-ES6-下"><span class="nav-text">4.5 课程进阶拥抱 ES6(下)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-项目初始准备"><span class="nav-text">5 项目初始准备</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-狗狗说-App-功能介绍"><span class="nav-text">5.1 狗狗说 App 功能介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#狗狗说功能分析"><span class="nav-text">狗狗说功能分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-TabBarIOS-开启-App-首页"><span class="nav-text">5.2 TabBarIOS 开启 App 首页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RN-插件-图标工具"><span class="nav-text">RN 插件: 图标工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RN-插件包管理器-rnpm"><span class="nav-text">RN 插件包管理器: rnpm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RN-升级"><span class="nav-text">RN 升级</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-TabBarIOS-开启-APP-首页-2"><span class="nav-text">5.3 TabBarIOS 开启 APP 首页(2)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-1-使用-react-native-vector-icons"><span class="nav-text">5.3.1 使用 react-native-vector-icons</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-2-使用-Icon-TabBarItem-取代-TabBarIOS-Item"><span class="nav-text">5.3.2 使用 Icon.TabBarItem 取代 TabBarIOS.Item</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-APP-流程结构及开发计划"><span class="nav-text">5.4 APP 流程结构及开发计划</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-5-页面重构"><span class="nav-text">5.5 页面重构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-6-飞速创建后台和-Mock-假数据"><span class="nav-text">5.6 飞速创建后台和 Mock 假数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-6-1-传统-Mock-假数据"><span class="nav-text">5.6.1 传统 Mock 假数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-6-2-Rap-和-Mockjs"><span class="nav-text">5.6.2 Rap 和 Mockjs</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-开发视频配音界面"><span class="nav-text">6 开发视频配音界面</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-视频列表挖坑开发-1"><span class="nav-text">6.1 视频列表挖坑开发(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-视频列表挖坑开发-2"><span class="nav-text">6.2 视频列表挖坑开发(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-RN-的异步请求与封装"><span class="nav-text">6.3 RN 的异步请求与封装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-1-RN-的-3-种异步请求方式"><span class="nav-text">6.3.1 RN 的 3 种异步请求方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-2-列表页使用-fetch-请求数据"><span class="nav-text">6.3.2 列表页使用 fetch 请求数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-4-6-5-列表页上滑预加载和下拉刷新效果"><span class="nav-text">6.4-6.5 列表页上滑预加载和下拉刷新效果</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-6-iOS-屏幕尺寸及分辨率知识点解析"><span class="nav-text">6.6 iOS 屏幕尺寸及分辨率知识点解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-6-1-基础知识"><span class="nav-text">6.6.1 基础知识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-6-2-iphone-6"><span class="nav-text">6.6.2 iphone 6</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-6-3-iphone-6-plus"><span class="nav-text">6.6.3 iphone 6 plus</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-6-4-iPhone-尺寸分布"><span class="nav-text">6.6.4 iPhone 尺寸分布</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-7-列表页点赞功能"><span class="nav-text">6.7 列表页点赞功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-8-RN-导航器-Navigator-的用法"><span class="nav-text">6.8 RN 导航器 Navigator 的用法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-9-详情页视频播放控制"><span class="nav-text">6.9 详情页视频播放控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-10-详情页视频播放控制-loading-进度条-重播功能"><span class="nav-text">6.10 详情页视频播放控制 loading-进度条 -重播功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-11-详情页视频播放控制–暂停、播放控制"><span class="nav-text">6.11 详情页视频播放控制–暂停、播放控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-12-详情页视频播放控制–容错处理、返回导航"><span class="nav-text">6.12 详情页视频播放控制–容错处理、返回导航</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-13-详情页视频信息补全"><span class="nav-text">6.13 详情页视频信息补全</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-14-获取视频评论列表-1"><span class="nav-text">6.14 获取视频评论列表(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-15-获取视频评论列表-2"><span class="nav-text">6.15 获取视频评论列表(2)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-16-RN-里面提交评论表单-1"><span class="nav-text">6.16 RN 里面提交评论表单(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-17-RN-里面提交评论表单"><span class="nav-text">6.17 RN 里面提交评论表单</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-RN-知识进阶串讲"><span class="nav-text">7 RN 知识进阶串讲</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-React-与-MVC"><span class="nav-text">7.1 React 与 MVC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-RN-的-30-组件"><span class="nav-text">7.2 RN 的 30+ 组件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-1-组件"><span class="nav-text">7.2.1 组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-2-运行官方-RN-示例"><span class="nav-text">7.2.2 运行官方 RN 示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-Flexbox-弹性布局的魔法属性"><span class="nav-text">7.3 Flexbox 弹性布局的魔法属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#flexDirection"><span class="nav-text">flexDirection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flexWrap"><span class="nav-text">flexWrap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#justifyContent"><span class="nav-text">justifyContent</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#alignItems"><span class="nav-text">alignItems</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-Flex-弹性布局的魔法属性"><span class="nav-text">7.4 Flex 弹性布局的魔法属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#alignSelf"><span class="nav-text">alignSelf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flex"><span class="nav-text">flex</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-5-如何甄选第三方组件"><span class="nav-text">7.5 如何甄选第三方组件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#搜索"><span class="nav-text">搜索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#比较"><span class="nav-text">比较</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-6-RN-的-AsyncStorage-异步存储"><span class="nav-text">7.6 RN 的 AsyncStorage 异步存储</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-7-如何在手机上安装演示-RN-原型项目"><span class="nav-text">7.7 如何在手机上安装演示 RN 原型项目</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-App-內注册登录"><span class="nav-text">8 App 內注册登录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-伪造-Rap-注册登录接口"><span class="nav-text">8.1 伪造 Rap 注册登录接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-实现注册登录页面1-输入验证码"><span class="nav-text">8.2 实现注册登录页面1(输入验证码)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-实现注册登录页面2-倒计时"><span class="nav-text">8.3 实现注册登录页面2(倒计时)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-本地管理应用登录状态"><span class="nav-text">8.4 本地管理应用登录状态</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-用户账户页面"><span class="nav-text">9 用户账户页面</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#9-1-9-3-头像展示与相册选取"><span class="nav-text">9.1-9.3 头像展示与相册选取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-4-9-5-XHR-异步上传图片到-cloudinary-图床"><span class="nav-text">9.4-9.5 XHR 异步上传图片到 cloudinary 图床</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-6-9-7-饼状图显示图片上传进度"><span class="nav-text">9.6-9.7 饼状图显示图片上传进度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-安装-react-native-progress"><span class="nav-text">1  安装 react-native-progress</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-完成上传进度"><span class="nav-text">2 完成上传进度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-完成图像上传成功后的后续处理"><span class="nav-text">3 完成图像上传成功后的后续处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-8-9-9-编辑和保存用户资料"><span class="nav-text">9.8-9.9 编辑和保存用户资料</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-用-Koa-开发本地-API-后台"><span class="nav-text">10 用 Koa 开发本地 API 后台</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#10-1-本地安装-Mongodb-数据库"><span class="nav-text">10.1 本地安装 Mongodb 数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-2-搭建-Koa-初始项目架构"><span class="nav-text">10.2 搭建 Koa 初始项目架构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#目录和-package-json"><span class="nav-text">目录和 package.json</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#依赖的第三方库"><span class="nav-text">依赖的第三方库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-3-Koa-中配置使用-Mondodb"><span class="nav-text">10.3 Koa 中配置使用 Mondodb</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#10-3-1-增加需要的数据库用户"><span class="nav-text">10.3.1 增加需要的数据库用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-3-2-mongoose-model"><span class="nav-text">10.3.2 mongoose model</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-5-10-6-用螺丝帽在-Koa-中发送短信"><span class="nav-text">10.5-10.6 用螺丝帽在 Koa 中发送短信</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#螺丝帽短信服务"><span class="nav-text">螺丝帽短信服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实现短信发送"><span class="nav-text">实现短信发送</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-7-用-DHC-插件-Restlet-Client-快速测试本地-API-服务"><span class="nav-text">10.7 用 DHC 插件(Restlet Client)快速测试本地 API 服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-8-服务器端实现图床签名接口"><span class="nav-text">10.8 服务器端实现图床签名接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-9-10-10-用七牛上传图片资源"><span class="nav-text">10.9-10.10 用七牛上传图片资源</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sean</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"lapuda-er"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

</body>
</html>
