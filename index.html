<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...">
<meta property="og:type" content="website">
<meta property="og:title" content="Sean">
<meta property="og:url" content="http://laputa-er.github.io/index.html">
<meta property="og:site_name" content="Sean">
<meta property="og:description" content="整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sean">
<meta name="twitter:description" content="整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://laputa-er.github.io/"/>

  <title> Sean </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Sean</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">笔记分享</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/RN开发指南_3 构建你的第一个应用/" itemprop="url">
                  3 构建你的第一个应用(React Native开发指南)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-19T11:05:52+08:00" content="2016-09-19">
              2016-09-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/19/RN开发指南_3 构建你的第一个应用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/19/RN开发指南_3 构建你的第一个应用/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="3-1-搭建环境"><a href="#3-1-搭建环境" class="headerlink" title="3.1 搭建环境"></a>3.1 搭建环境</h2><p><strong>说明：</strong>使用 <a href="http://brew.sh/" target="_blank" rel="external">HomeBrew</a> 安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ brew install node</span><br><span class="line"></span><br><span class="line">$ brew install watchman <span class="comment"># Watchman 是 facebook 的一个开源项目，它开源用来监视文件并且记录文件的改动情况，当文件变更它可以触发一些操作</span></span><br><span class="line">$ brew install flow <span class="comment"># Facebook 公司出品的一个类型检查库(如果你想让 React Native 项目支持类型检查,可以使用 flow)</span></span><br></pre></td></tr></table></figure></p>
<p><strong>安装中出现问题</strong><br><strong>说明：</strong>如果出现问题，需要更新 brew 和相关依赖包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ brew update <span class="comment"># 更新用 homebrew 安装的软件</span></span><br><span class="line">$ brew upgrade <span class="comment"># 更新 homebrew 自身</span></span><br></pre></td></tr></table></figure></p>
<p><strong>安装中出现错误</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew doctor <span class="comment"># 找到问题所在</span></span><br></pre></td></tr></table></figure></p>
<h3 id="3-1-1-安装-React-Native"><a href="#3-1-1-安装-React-Native" class="headerlink" title="3.1.1 安装 React Native"></a>3.1.1 安装 React Native</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g react-native-cli <span class="comment"># 命令行工具</span></span><br></pre></td></tr></table></figure>
<h3 id="3-1-2-iOS依赖"><a href="#3-1-2-iOS依赖" class="headerlink" title="3.1.2 iOS依赖"></a>3.1.2 iOS依赖</h3><ul>
<li>一个 iOS 开发者账号(申请这个账号是免费的)</li>
<li>获得一个许可（如果需要部署到 iOS 应用商店）</li>
<li>Xcode（Xcode 集成开发环境、iOS模拟器、iOS SDK）</li>
</ul>
<ol>
<li>应用商店下载</li>
<li>网站下载<a href="https:// developer.apple.com/xcode/download/" target="_blank" rel="external">https:// developer.apple.com/xcode/download/</a></li>
</ol>
<h3 id="3-1-3-Android依赖"><a href="#3-1-3-Android依赖" class="headerlink" title="3.1.3 Android依赖"></a>3.1.3 Android依赖</h3><ol>
<li>安装最新版本的 JDK：<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="external">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a></li>
</ol>
<hr>
<ol>
<li>安装 Android SDK</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 Android SDK</span></span><br><span class="line">$ brew install android-sdk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置环境变量</span></span><br><span class="line">$ vim ~/.zshrc</span><br><span class="line">	<span class="built_in">export</span> ANDROID_HOME=/usr/<span class="built_in">local</span>/opt/android-sdk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 立即生效</span></span><br><span class="line">$ <span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<hr>
<ol>
<li>打开 Android SDK 管理器，选择开发包进行安装</li>
</ol>
<p>（1）打开 Android SDK 管理器<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ android <span class="comment"># 下载完成后有可能需要关闭窗口，然后重新打开</span></span><br></pre></td></tr></table></figure></p>
<p>（2）需要安装的包</p>
<ul>
<li>Android SDK Tools</li>
<li>Android SDK Platform-tools</li>
<li>Android SDK Build-tools</li>
<li>Android 7.0-&gt; *</li>
<li>Extras-&gt;Android Support Repository </li>
<li>Extras-&gt;Intel x86 Emulator Accelerator (HAXM installer)</li>
</ul>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1474104519915.png" alt="Alt text"><br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1474104584355.png" alt="Alt text"></p>
<hr>
<ol>
<li>通过 AVD(Android Virtual Device) 管理器创建和运行模拟器<br><strong>说明：</strong>由于Android设备种类繁多,有不同的屏幕尺寸、 分辨率和功能,因此使用不同的模拟器通常能为测试带来帮助。当然,出于学习的目的, 我们只需要安装一个即可。<br><strong>注意：</strong>保勾选了 <code>Use Host GPU</code>,否则模拟器会非常慢</li>
</ol>
<p>（1）启动  AVD<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ android avd</span><br></pre></td></tr></table></figure></p>
<p>（2）创建一个模拟器<br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1474035887787.png" alt="Alt text"></p>
<h2 id="3-2-创建一个新的应用"><a href="#3-2-创建一个新的应用" class="headerlink" title="3.2 创建一个新的应用"></a>3.2 创建一个新的应用</h2><p><strong>随书源码：</strong><a href="https://github.com/bonniee/learning- react-native" target="_blank" rel="external">https://github.com/bonniee/learning- react-native</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ react-native init RN_FOR_BOOK_FIRST_PROJECT <span class="comment"># 创建  React Native 项目</span></span><br><span class="line"></span><br><span class="line">$ tree -L 2 RN_FOR_BOOK_FIRST_PROJECT -I node_modules <span class="comment"># 观察目录结构</span></span><br><span class="line">RN_FOR_BOOK_FIRST_PROJECT</span><br><span class="line">├── android</span><br><span class="line">│   ├── app</span><br><span class="line">│   ├── build.gradle</span><br><span class="line">│   ├── gradle</span><br><span class="line">│   ├── gradle.properties</span><br><span class="line">│   ├── gradlew</span><br><span class="line">│   ├── gradlew.bat</span><br><span class="line">│   ├── keystores</span><br><span class="line">│   └── settings.gradle</span><br><span class="line">├── index.android.js</span><br><span class="line">├── index.ios.js</span><br><span class="line">├── ios</span><br><span class="line">│   ├── RN_FOR_BOOK_FIRST_PROJECT</span><br><span class="line">│   ├── RN_FOR_BOOK_FIRST_PROJECT.xcodeproj</span><br><span class="line">│   └── RN_FOR_BOOK_FIRST_PROJECTTests</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure>
<h3 id="3-2-1-在-iOS-平台运行-React-Native-应用"><a href="#3-2-1-在-iOS-平台运行-React-Native-应用" class="headerlink" title="3.2.1 在 iOS 平台运行 React Native 应用"></a>3.2.1 在 iOS 平台运行 React Native 应用</h3><table>
<thead>
<tr>
<th>虚拟机快捷键</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cmd + R</td>
<td>重载 JS</td>
</tr>
<tr>
<td>Cmd + D</td>
<td>打开 开发菜单</td>
</tr>
</tbody>
</table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 Xcode 打开</span></span><br><span class="line">$ open RN_FOR_BOOK_FIRST_PROJECT/ios/RN_FOR_BOOK_FIRST_PROJECT.xcodeproj</span><br></pre></td></tr></table></figure>
<h3 id="3-2-2-部署到-iOS-设备"><a href="#3-2-2-部署到-iOS-设备" class="headerlink" title="3.2.2 部署到 iOS 设备"></a>3.2.2 部署到 iOS 设备</h3><p><strong>注意：</strong>如果遇到 <code>not found the kernel library or the...</code>问题，说明  Xcode 不支持当前的iOS版本，升级 Xcode 到最新版。</p>
<ol>
<li>打开 Xcode，进入Xcode-&gt;Preference-&gt;Accounts，添加 Apple ID</li>
<li>在 Xcode 中打开通用面板，点击 Fix Issue，按照引导获取证书</li>
<li>登录到 Apple 开发者中心<a href="http:// developer.apple.com" target="_blank" rel="external">http:// developer.apple.com</a>,然后注册你的设备</li>
<li><p>在 <code>AppDelegate.m</code> 文件中将 <code>localhost</code> 改成你的 Mac 的 IP 地址</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">// 例如 IP为：10.10.12.345</span></span><br><span class="line">jsCodeLocation =</span><br><span class="line">     [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://10.10.12.345:8081/index.ios.bundle"</span>];</span><br><span class="line">     ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>xcode 打开项目</p>
</li>
<li>iOS设备通过数据线连接到 mac</li>
<li>设备切换为 实体iOS设备 并运行项目</li>
</ol>
<h3 id="3-2-3-在-Android-平台运行-React-Native-应用"><a href="#3-2-3-在-Android-平台运行-React-Native-应用" class="headerlink" title="3.2.3 在 Android 平台运行 React Native 应用"></a>3.2.3 在 Android 平台运行 React Native 应用</h3><table>
<thead>
<tr>
<th>快捷键</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>双击R</td>
<td>重新加载应用</td>
</tr>
<tr>
<td><code>甩动</code>手机或<code>按菜单键</code></td>
<td>调出开发相关菜单</td>
</tr>
</tbody>
</table>
<h4 id="3-2-3-1-手动搭建集成环境"><a href="#3-2-3-1-手动搭建集成环境" class="headerlink" title="3.2.3.1 手动搭建集成环境"></a>3.2.3.1 手动搭建集成环境</h4><ol>
<li>启动虚拟机</li>
</ol>
<p><strong>方式1</strong>：部分命令行<br>（1）启动AVD管理器<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ android avd</span><br></pre></td></tr></table></figure></p>
<p>（2）选中目标虚拟机，点击<code>start</code></p>
<p><strong>方式2</strong>：全部命令行<br>（1）查看虚拟机列表<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ emulator -list-avds</span><br></pre></td></tr></table></figure></p>
<p>（2）通过名字和 @ 前缀来运行它们<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ emulator @虚拟机设备名</span><br></pre></td></tr></table></figure></p>
<ol>
<li>加载 React native 项目<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在工程的根目录运行如下命令</span></span><br><span class="line">$ <span class="built_in">cd</span> RN_FOR_BOOK_FIRST_PROJECT</span><br><span class="line">$ react-native run-android <span class="comment"># 如果出现类似 mac react emulator: ERROR: Failed to open /etc/resolv.conf, cannot retrieve DNS server 的错误，则添加 sudo 权限</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h4><hr>
<p><strong>（1）启动时遇到问题</strong></p>
<ul>
<li><code>CPU acceleration status: HAXM is not installed on this machine</code><br><strong>解决：</strong>手动安装这个文件：/usr/local/Cellar/android-sdk/24.4.1_1/extras/intel/Hardware_Accelerated_Execution_Manager/IntelHAXM_6.0.3.dmg</li>
</ul>
<hr>
<p><strong>（2）加载项目时出现错误</strong></p>
<ul>
<li><code>failed to find target with hash string &#39;android-23&#39; in: /usr/local/opt/android-sdk</code><br><strong>解决：</strong>编辑<code>android/app/build.grdle</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion 24 <span class="comment"># sdk 版本和运行的虚拟 sdk 版本保持一致</span></span><br><span class="line">    buildToolsVersion <span class="string">"24.0.2"</span> <span class="comment"># build tool 版本也要保持一致</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3-2-3-2-Android-Studio"><a href="#3-2-3-2-Android-Studio" class="headerlink" title="3.2.3.2 Android Studio"></a>3.2.3.2 Android Studio</h4><h3 id="3-2-4-小结：创建并运行项目"><a href="#3-2-4-小结：创建并运行项目" class="headerlink" title="3.2.4 小结：创建并运行项目"></a>3.2.4 小结：创建并运行项目</h3><h2 id="3-3-探索示例代码"><a href="#3-3-探索示例代码" class="headerlink" title="3.3 探索示例代码"></a>3.3 探索示例代码</h2><p><strong>说明：</strong>深入到默认应用的源代码中去探索 <code>React Native</code> 项目的结构</p>
<h3 id="3-3-1-添加组件到视图中"><a href="#3-3-1-添加组件到视图中" class="headerlink" title="3.3.1 添加组件到视图中"></a>3.3.1 添加组件到视图中</h3><h3 id="3-3-2-React-Native-中的模块导入"><a href="#3-3-2-React-Native-中的模块导入" class="headerlink" title="3.3.2 React Native 中的模块导入"></a>3.3.2 React Native 中的模块导入</h3><h3 id="3-3-3-FirstProjext组件"><a href="#3-3-3-FirstProjext组件" class="headerlink" title="3.3.3 FirstProjext组件"></a>3.3.3 FirstProjext组件</h3><h2 id="3-4-开发天气应用"><a href="#3-4-开发天气应用" class="headerlink" title="3.4 开发天气应用"></a>3.4 开发天气应用</h2><p><strong>说明：</strong>书中给的代码不是纯粹的<code>es6</code>，随书源码给的是<code>es6</code>版本的，但运行不了。因此我会跟随书重新编写一遍代码，但会使用<code>es6</code>版本的。<br>（1）创建项目<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ reac-native init RN_FOR_BOOK_WEATHER</span><br></pre></td></tr></table></figure></p>
<p>（2）修改默认设置<br>$ vim android/app/build.gradle<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion 24 <span class="comment"># sdk 版本和运行的虚拟 sdk 版本保持一致</span></span><br><span class="line">    buildToolsVersion <span class="string">"24.0.2"</span> <span class="comment"># build tool 版本也要保持一致</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>（3）将初始组件的代码移动到 <code>Weather.js</code> 中，精简 <code>index.ios.js</code> 和 <code>index.android.js</code> 代码</p>
<h3 id="3-4-1-处理用户输入"><a href="#3-4-1-处理用户输入" class="headerlink" title="3.4.1 处理用户输入"></a>3.4.1 处理用户输入</h3><h4 id="3-4-1-1-效果预览"><a href="#3-4-1-1-效果预览" class="headerlink" title="3.4.1.1 效果预览"></a>3.4.1.1 效果预览</h4><p><strong>iOS 效果</strong><br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1474174611287.png" alt="Alt text|205x341"></p>
<p><strong>Android 效果</strong><br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1474174641467.png" alt="Alt text|205x341"></p>
<h3 id="3-4-2-展现数据"><a href="#3-4-2-展现数据" class="headerlink" title="3.4.2 展现数据"></a>3.4.2 展现数据</h3><h3 id="3-4-3-添加背景图片"><a href="#3-4-3-添加背景图片" class="headerlink" title="3.4.3 添加背景图片"></a>3.4.3 添加背景图片</h3><p><strong>说明：</strong>书上讲的内容是<code>0.14</code>之前的，过时了，具体看这里：<a href="https://facebook.github.io/react-native/docs/images.html" target="_blank" rel="external">https://facebook.github.io/react-native/docs/images.html</a></p>
<h3 id="3-4-4-从-Web-获取数据"><a href="#3-4-4-从-Web-获取数据" class="headerlink" title="3.4.4 从 Web 获取数据"></a>3.4.4 从 Web 获取数据</h3><h4 id="FAQ-1"><a href="#FAQ-1" class="headerlink" title="FAQ"></a>FAQ</h4><ol>
<li><p><code>App Transport Security has blocked a cleartext HTTP (http://) resource load since it is insecure...</code><br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1474212609333.png" alt="Alt text"></p>
</li>
<li><p>天气接口返回 401<br><a href="http://openweathermap.org/faq" target="_blank" rel="external">http://openweathermap.org/faq</a></p>
<h3 id="3-4-5-整合"><a href="#3-4-5-整合" class="headerlink" title="3.4.5 整合"></a>3.4.5 整合</h3><h2 id="3-5-小结"><a href="#3-5-小结" class="headerlink" title="3.5 小结"></a>3.5 小结</h2></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/RN开发指南_2 React Native 工作原理/" itemprop="url">
                  2 React Native 工作原理(React Native开发指南)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-19T11:05:24+08:00" content="2016-09-19">
              2016-09-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/19/RN开发指南_2 React Native 工作原理/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/19/RN开发指南_2 React Native 工作原理/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="2-1-React-Native-是如何工作的？"><a href="#2-1-React-Native-是如何工作的？" class="headerlink" title="2.1 React Native 是如何工作的？"></a>2.1 React Native 是如何工作的？</h2><h3 id="2-1-1-React-的一个特-点-Virtual-DOM"><a href="#2-1-1-React-的一个特-点-Virtual-DOM" class="headerlink" title="2.1.1 React 的一个特 点:Virtual DOM"></a>2.1.1 React 的一个特 点:Virtual DOM</h3><p><strong>用途：</strong>执行 Virtual DOM 的计算,减少浏览器 DOM 的重复渲染<br><strong>潜力：</strong>潜力在于提供了强大的抽象能力。在开 发者的代码与实际的渲染之间加入一个抽象层,这带来了很多可能性。<br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1473752946136.png" alt="Alt text"></p>
<h3 id="2-1-2-React-Native-工作原理"><a href="#2-1-2-React-Native-工作原理" class="headerlink" title="2.1.2 React Native 工作原理"></a>2.1.2 React Native 工作原理</h3><ul>
<li>调用 Objective-C 的 API 去渲染 iOS 组件</li>
<li>调用 Java 接口去渲染 Android 组件</li>
</ul>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1473753026098.png" alt="Alt text"></p>
<h2 id="2-2-渲染周期"><a href="#2-2-渲染周期" class="headerlink" title="2.2 渲染周期"></a>2.2 渲染周期</h2><p><strong>说明：</strong> <code>React</code>的<br><strong>注意：</strong>至于 <code>React Native</code>,生命周期与 <code>React</code> 基本相同,但渲染过程有一些区别<br><strong>React 组件挂载过程</strong><br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1473753275389.png" alt="Alt text"></p>
<p><strong>React 组件重新渲染过程</strong><br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1473753282710.png" alt="Alt text"></p>
<h2 id="2-3-在React-Native中创建组件"><a href="#2-3-在React-Native中创建组件" class="headerlink" title="2.3 在React Native中创建组件"></a>2.3 在React Native中创建组件</h2><h3 id="2-3-1-编写视图"><a href="#2-3-1-编写视图" class="headerlink" title="2.3.1 编写视图"></a>2.3.1 编写视图</h3><p><strong>DEMO：</strong><a href="https://github.com/facebook/react- native#examples" target="_blank" rel="external">https://github.com/facebook/react- native#examples</a><br><strong>web与React Native 基础元素比较</strong></p>
<table>
<thead>
<tr>
<th>React</th>
<th>React Native</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;div&gt;</code></td>
<td><code>&lt;View&gt;</code></td>
</tr>
<tr>
<td><code>&lt;span&gt;</code></td>
<td><code>&lt;Text&gt;</code></td>
</tr>
<tr>
<td><code>&lt;li&gt;,&lt;ul&gt;</code></td>
<td><code>&lt;ListView&gt;</code></td>
</tr>
<tr>
<td><code>&lt;img&gt;</code></td>
<td><code>&lt;Image&gt;</code></td>
</tr>
</tbody>
</table>
<p><strong>其他组件则是平台特定的</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> &lt;DatePickerIOS</span><br><span class="line">       date=&#123;<span class="keyword">this</span>.state.date&#125;</span><br><span class="line">       mode=<span class="string">"date"</span></span><br><span class="line">       timeZoneOffsetInMinutes=&#123;<span class="keyword">this</span>.state.timeZoneOffsetInHours * <span class="number">60</span>&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-3-2-使用-JSX"><a href="#2-3-2-使用-JSX" class="headerlink" title="2.3.2 使用 JSX"></a>2.3.2 使用 JSX</h3><p><code>JSX 认为减少心智负担比文件分离更有用</code><br><strong>说明：</strong>与 <code>React</code> 中相一致,<code>React Native</code> 也是通过编写 <code>JSX</code> 来设计视图,并将视图标记和控制逻辑 组合在一起成为一个文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> HelloMessage = React.createClass(&#123;</span><br><span class="line">       displayName: <span class="string">"HelloMessage"</span>,</span><br><span class="line">       render: <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> React.createElement(</span><br><span class="line"><span class="string">"div"</span>, <span class="literal">null</span>,</span><br><span class="line">   React Native工作原理</span><br><span class="line">| <span class="number">9</span></span><br><span class="line"><span class="string">"Hello "</span>,</span><br><span class="line">           <span class="keyword">this</span>.props.name</span><br><span class="line">         );</span><br><span class="line">&#125; &#125;);</span><br><span class="line">React.render(React.createElement(HelloMessage, &#123; name: <span class="string">"Bonnie"</span> &#125;), mountNode);</span><br></pre></td></tr></table></figure>
<h3 id="2-3-3-原生组件的样式"><a href="#2-3-3-原生组件的样式" class="headerlink" title="2.3.3 原生组件的样式"></a>2.3.3 原生组件的样式</h3><p><strong>DEMO：</strong><a href="https:// github.com/facebook/react-native/tree/master/Examples/UIExplorer" target="_blank" rel="external">https:// github.com/facebook/react-native/tree/master/Examples/UIExplorer</a><br><strong>说明：</strong><code>React</code> 和宿主平台之间的“桥接”包含了一 个<code>缩减版 CSS 子集</code>的实现。这个 <code>CSS</code>子集主要通过 <code>flexbox</code>进行布局,做到了尽量简单 化,而不是去实现所有的 <code>CSS</code> 规则。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个样式。 </span></span><br><span class="line"><span class="keyword">var</span> style = &#123;</span><br><span class="line">	backgroundColor: <span class="string">'white'</span>,</span><br><span class="line">    fontSize: <span class="string">'16px'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 然后使用它。 var tv = (</span></span><br><span class="line">&lt;Text style=&#123;style&#125;&gt;</span><br><span class="line">  A styled Text</span><br><span class="line">&lt;<span class="regexp">/Text&gt;);</span></span><br></pre></td></tr></table></figure>
<h2 id="2-4-宿主平台接口"><a href="#2-4-宿主平台接口" class="headerlink" title="2.4 宿主平台接口"></a>2.4 宿主平台接口</h2><p><strong>注意：</strong><code>React Native</code> 的“桥接”不可能暴露宿主平台全部的接口。如果你需要使用一 个未支持的特性,完全可以自己动手添加到 <code>React Native</code> 中</p>
<h2 id="2-5-小结"><a href="#2-5-小结" class="headerlink" title="2.5 小结"></a>2.5 小结</h2><p><strong>说明：</strong>使用 React Native 为移动应用编写组件与 Web 环境的 React 相比有一些不同</p>
<ul>
<li>JSX 是强制使 用的</li>
<li>通过创建组件的方式来开发基本模块</li>
<li>通过使用 CSS 的子集编写内联语句的方式来编写样式</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/RN开发指南_1 初识 React Native/" itemprop="url">
                  1 初识 React Native(React Native开发指南)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-19T11:05:10+08:00" content="2016-09-19">
              2016-09-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/19/RN开发指南_1 初识 React Native/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/19/RN开发指南_1 初识 React Native/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-1-React-Native-的优点"><a href="#1-1-React-Native-的优点" class="headerlink" title="1.1 React Native 的优点"></a>1.1 React Native 的优点</h2><ul>
<li>代码解析成真正原生的 UI 组件</li>
<li>不在 <code>UI</code> 主线程中运行,你的应用可以在不牺牲灵活性 的前提下保持高性能</li>
</ul>
<h3 id="1-1-1-开发者体验"><a href="#1-1-1-开发者体验" class="headerlink" title="1.1.1 开发者体验"></a>1.1.1 开发者体验</h3><ul>
<li>按下 Command+R 就可以刷新应用,就和在网页上开发一样</li>
<li>更好地利用智能调试工具以及错误报告机制</li>
<li>可以选择喜爱的任何文本编辑器来开发 <code>JavaScript</code></li>
<li><code>Apple</code> 公司允许通过网络对基于 <code>JavaScript</code> 开发的功能进行更新,无需 额外的审核周期</li>
</ul>
<h3 id="1-1-2-代码复用与知识共享"><a href="#1-1-2-代码复用与知识共享" class="headerlink" title="1.1.2 代码复用与知识共享"></a>1.1.2 代码复用与知识共享</h3><ul>
<li>使用相同的技能同时开发 Web 应用、iOS 应用和 Android 应用，避免了按平台分工的必要</li>
<li>大部分代码也可以被共享（不是你写的所有代码都可 以做到跨平台）</li>
</ul>
<h2 id="1-2-分享和缺点"><a href="#1-2-分享和缺点" class="headerlink" title="1.2 分享和缺点"></a>1.2 分享和缺点</h2><ul>
<li>不够成熟可能是其最大的风险</li>
<li>文档确实还有 提升的空间,同时项目也在不断升级和改进</li>
<li>一些特性在 iOS 和 Android 平台上仍未得到 支持</li>
</ul>
<h2 id="1-3-小结"><a href="#1-3-小结" class="headerlink" title="1.3 小结"></a>1.3 小结</h2><p>如果你的团队可以解决新技术带来的不 确定问题,并且想开发跨平台的应用,那么不妨试试 React Native 吧。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/19/RN开发指南_0 随书资源/" itemprop="url">
                  0 随书资源(React Native开发指南)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-19T11:04:30+08:00" content="2016-09-19">
              2016-09-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/19/RN开发指南_0 随书资源/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/19/RN开发指南_0 随书资源/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>随书源码：</strong> <a href="https://github.com/bonniee/learning-react-native" target="_blank" rel="external">https://github.com/bonniee/learning-react-native</a></p>
<p><strong>加入邮件列表：</strong><a href="http://learningreacnative.com" target="_blank" rel="external">http://learningreacnative.com</a></p>
<p><strong>React Native 官方文档：</strong><a href="https://facebook.github.io/react-native/" target="_blank" rel="external">https://facebook.github.io/react-native/</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_6 数值的扩展/" itemprop="url">
                  6 数值的扩展(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:37:28+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_6 数值的扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_6 数值的扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="6-1-二进制和八进制表示法"><a href="#6-1-二进制和八进制表示法" class="headerlink" title="6.1 二进制和八进制表示法"></a>6.1 二进制和八进制表示法</h2><table>
<thead>
<tr>
<th>进制</th>
<th>前缀</th>
<th>支持情况</th>
</tr>
</thead>
<tbody>
<tr>
<td>二进制</td>
<td>0b(0B)</td>
<td>>=es6</td>
</tr>
<tr>
<td>八进制</td>
<td>0o(0O)</td>
<td>>=es6</td>
</tr>
<tr>
<td>八进制</td>
<td>0</td>
<td>es5(非严格模式)</td>
</tr>
<tr>
<td>十六进制</td>
<td>0x(0X)</td>
<td>>=es5</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 Number 将二进制和八进制字符串转为 10 进制</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="string">'ob111'</span>)<span class="comment">// 7</span></span><br></pre></td></tr></table></figure>
<h2 id="6-2-Number-isFinite-Number-isNaN"><a href="#6-2-Number-isFinite-Number-isNaN" class="headerlink" title="6.2 Number.isFinite(), Number.isNaN()"></a>6.2 Number.isFinite(), Number.isNaN()</h2><h3 id="6-2-1-基础"><a href="#6-2-1-基础" class="headerlink" title="6.2.1 基础"></a>6.2.1 基础</h3><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
<th>参数为非数字时</th>
<th>兼容性</th>
</tr>
</thead>
<tbody>
<tr>
<td>isFinate</td>
<td>检查是否非无穷</td>
<td>通过 Number 转为数字，再判断</td>
<td>>=es3</td>
</tr>
<tr>
<td>isNaN</td>
<td>检查是否非数字</td>
<td>通过 Number 转为数字，再判断</td>
<td>>=es3</td>
</tr>
<tr>
<td>Number.isFinate</td>
<td>检查是否非无穷</td>
<td>返回 false</td>
<td>>=es6</td>
</tr>
<tr>
<td>Number.isNaN</td>
<td>检查是否非数字</td>
<td>返回 false</td>
<td>>=es7</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Number</span>.isFinite(<span class="number">15</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="number">0.8</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">NaN</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">Infinity</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(-<span class="literal">Infinity</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="string">'foo'</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="string">'15'</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">true</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="number">15</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'15'</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">true</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="number">9</span>/<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'true'</span>/<span class="number">0</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'true'</span>/<span class="string">'true'</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="number">25</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="string">"25"</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="number">25</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="string">"25"</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="string">"NaN"</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="string">"NaN"</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="6-2-2-es5环境下的polyfill"><a href="#6-2-2-es5环境下的polyfill" class="headerlink" title="6.2.2 es5环境下的polyfill"></a>6.2.2 es5环境下的polyfill</h3><p>借助传统的 <code>isNaN</code>和<code>isFinate</code>来实现自定义的<code>Number.isNaN</code>和<code>Number.isFinate</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> global_isFinite = global.isFinite</span><br><span class="line">	<span class="keyword">const</span> global_isNaN = global.isNaN</span><br><span class="line">	<span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isFinite'</span>, &#123;</span><br><span class="line">		value: <span class="function"><span class="keyword">function</span> <span class="title">isFinite</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; global_isFinite(value)</span><br><span class="line">		&#125;,</span><br><span class="line">		configurable: <span class="literal">true</span>,</span><br><span class="line">		enumerable: <span class="literal">false</span>,</span><br><span class="line">		writable: <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isNaN'</span>, &#123;</span><br><span class="line">		value: <span class="function"><span class="keyword">function</span> <span class="title">isNaN</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; global_isNaN(value)</span><br><span class="line">		&#125;,</span><br><span class="line">		configurable: <span class="literal">true</span>,</span><br><span class="line">		enumerable: <span class="literal">false</span>,</span><br><span class="line">		writable: <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)(<span class="built_in">window</span>);</span><br></pre></td></tr></table></figure>
<h2 id="6-3-Number-parseInt-Number-parseFloat"><a href="#6-3-Number-parseInt-Number-parseFloat" class="headerlink" title="6.3 Number.parseInt(), Number.parseFloat()"></a>6.3 Number.parseInt(), Number.parseFloat()</h2><p>ES6将<code>parseInt()</code>和<code>parseFloat()</code>移植到 <code>Number</code>对象上面。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES5的写法</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'12.34'</span>) <span class="comment">// 12</span></span><br><span class="line"><span class="built_in">parseFloat</span>(<span class="string">'123.45#'</span>) <span class="comment">// 123.45</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的写法</span></span><br><span class="line"><span class="built_in">Number</span>.parseInt(<span class="string">'12.34'</span>) <span class="comment">// 12</span></span><br><span class="line"><span class="built_in">Number</span>.parseFloat(<span class="string">'123.45#'</span>) <span class="comment">// 123.45</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>.parseInt === <span class="built_in">parseInt</span> <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.parseFloat === <span class="built_in">parseFloat</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p> 这样处理的目的是逐步减少全局性方法，使得语言逐步模块化。</p>
<h2 id="6-4-Number-isInteger"><a href="#6-4-Number-isInteger" class="headerlink" title="6.4 Number.isInteger()"></a>6.4 Number.isInteger()</h2><p><strong>功能：</strong>用来判断一个值是否为整数<br><strong>注意：</strong>整数和浮点数存储方式是一样的，3和3.0都会被认为是整数</p>
<h4 id="6-4-1-基础"><a href="#6-4-1-基础" class="headerlink" title="6.4.1 基础"></a>6.4.1 基础</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25.0</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25.1</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isInteger(<span class="string">"15"</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isInteger(<span class="literal">true</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="6-4-2-es5环境下的-polyfill"><a href="#6-4-2-es5环境下的-polyfill" class="headerlink" title="6.4.2 es5环境下的 polyfill"></a>6.4.2 es5环境下的 polyfill</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> floor = <span class="built_in">Math</span>.floor,</span><br><span class="line">		<span class="built_in">isFinite</span> = global.isFinite;</span><br><span class="line">	<span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isInteger'</span>, &#123;</span><br><span class="line">		value: <span class="function"><span class="keyword">function</span> <span class="title">isInteger</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; <span class="built_in">isFinite</span>(value) &amp;&amp; value &gt; <span class="number">-9007199254740992</span> &amp;&amp; value &lt; <span class="number">9007199254740992</span> &amp;&amp; floor(value) === value;</span><br><span class="line">		&#125;,</span><br><span class="line">		configurable: <span class="literal">true</span>,</span><br><span class="line">		enumerable: <span class="literal">false</span>,</span><br><span class="line">		writable: <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)(<span class="built_in">window</span>)</span><br></pre></td></tr></table></figure>
<h2 id="6-5-Number-EPSILON"><a href="#6-5-Number-EPSILON" class="headerlink" title="6.5 Number.EPSILON"></a>6.5 Number.EPSILON</h2><p><strong>说明：</strong>一个极小的常量<code>2.220446049250313e-16</code><br><strong>用途：</strong>可以在浮点数计算中作为误差范围使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">withinErrorMargin</span> <span class="params">(left, right)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Math.abs(left - right) &lt; Number.EPSILON;</span><br><span class="line">&#125;</span><br><span class="line">withinErrorMargin(<span class="number">0.1</span> + <span class="number">0.2</span>, <span class="number">0.3</span>)</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">withinErrorMargin(<span class="number">0.2</span> + <span class="number">0.2</span>, <span class="number">0.3</span>)</span><br><span class="line"><span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h2 id="6-6-安全整数和-Number-isSafeInteger"><a href="#6-6-安全整数和-Number-isSafeInteger" class="headerlink" title="6.6 安全整数和 Number.isSafeInteger()"></a>6.6 安全整数和 Number.isSafeInteger()</h2><table>
<thead>
<tr>
<th>常量(ES6提供)</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Number.MAX_SAFE_INTEGER</code></td>
<td>JS支持的整数上限（9007199254740991）</td>
</tr>
<tr>
<td><code>Number.MIN_SAFE_INTEGER</code></td>
<td>JS支持的整数下限（-9007199254740991）</td>
</tr>
</tbody>
</table>
<h3 id="6-6-1-Number-isSafeInteger"><a href="#6-6-1-Number-isSafeInteger" class="headerlink" title="6.6.1 Number.isSafeInteger()"></a>6.6.1 Number.isSafeInteger()</h3><p> <strong>功能：</strong>判断一个整数是否落在这个<code>JS</code>能够支持的范围之内<br> <strong>技巧：</strong>验证运算结果是否落在安全整数的范围內，不要只验证运算结果，而要同时验证参与运算的每个值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="string">'a'</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">null</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">NaN</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">Infinity</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(-<span class="literal">Infinity</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">3</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">1.2</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">9007199254740990</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">9007199254740992</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MIN_SAFE_INTEGER - <span class="number">1</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MIN_SAFE_INTEGER) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MAX_SAFE_INTEGER) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MAX_SAFE_INTEGER + <span class="number">1</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">* 检验 操作数 和 操作结果 的是否为安全整数，以确保运算过程正确</span><br><span class="line">* @param  &#123;number&#125; left   左操作数</span><br><span class="line">* @param  &#123;number&#125; right  右操作数</span><br><span class="line">* @param  &#123;number&#125; result 结果</span><br><span class="line">* @return &#123;number&#125; 结果</span><br><span class="line">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trusty</span> (<span class="params">left, right, result</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (</span><br><span class="line">		<span class="built_in">Number</span>.isSafeInteger(left) &amp;&amp;</span><br><span class="line">		<span class="built_in">Number</span>.isSafeInteger(right) &amp;&amp; </span><br><span class="line">		<span class="built_in">Number</span>.isSafeInteger(result)</span><br><span class="line">		) &#123;</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RangeError</span>(<span class="string">'Operation cannot be trusted!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">trusty(<span class="number">9007199254740993</span>, <span class="number">990</span>, <span class="number">9007199254740993</span> - <span class="number">990</span>)<span class="comment">// RangeError: Operation cannot be trusted!</span></span><br><span class="line">trusty(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)<span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<h3 id="6-6-2-es5-环境下的-polyfill"><a href="#6-6-2-es5-环境下的-polyfill" class="headerlink" title="6.6.2 es5 环境下的 polyfill"></a>6.6.2 es5 环境下的 polyfill</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">* es5 环境下的 polyfill</span><br><span class="line">*/</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger = <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (<span class="keyword">typeof</span> n === <span class="string">'number'</span></span><br><span class="line">			&amp;&amp; <span class="built_in">Math</span>.round(n) === n</span><br><span class="line">			&amp;&amp; <span class="built_in">Number</span>.MIN_SAFE_INTEGER &lt;= n</span><br><span class="line">			&amp;&amp; n &lt;= <span class="built_in">Number</span>.MAX_SAFE_INTEGER);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="6-7-Math-对象的扩展"><a href="#6-7-Math-对象的扩展" class="headerlink" title="6.7 Math 对象的扩展"></a>6.7 Math 对象的扩展</h2><p>es6在 Math 对象上新增了17个与数学相关的静态方法</p>
<h3 id="6-7-1-常用（7个）"><a href="#6-7-1-常用（7个）" class="headerlink" title="6.7.1 常用（7个）"></a>6.7.1 常用（7个）</h3><table>
<thead>
<tr>
<th>静态方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Math.truc</td>
<td>去除一个数的小数部分</td>
</tr>
<tr>
<td>Math.sign</td>
<td>判断一个数到底是正数、负数、还是零</td>
</tr>
<tr>
<td>Math.cbrt</td>
<td>计算一个数的立方根</td>
</tr>
<tr>
<td>Math.clz32</td>
<td>返回一个数的32位无符号整数形式有多少个前导0</td>
</tr>
<tr>
<td>Math.imul</td>
<td>返回两个数以32位带符号整数形式相乘的结果</td>
</tr>
<tr>
<td>Math.fround</td>
<td>返回一个数的单精度浮点数形式</td>
</tr>
<tr>
<td>Math.hypot</td>
<td>返回所有参数的平方和的平方根</td>
</tr>
</tbody>
</table>
<h3 id="6-7-2-对数方法（4个）"><a href="#6-7-2-对数方法（4个）" class="headerlink" title="6.7.2 对数方法（4个）"></a>6.7.2 对数方法（4个）</h3><table>
<thead>
<tr>
<th>静态方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Math.expm1</td>
<td>返回e^x - 1. 即<code>Math.exp(x) - 1</code></td>
</tr>
<tr>
<td>Math.log1p</td>
<td>返回 1 + x 的自然对数，即<code>Math.log(1 + x)</code></td>
</tr>
<tr>
<td>Math.log10</td>
<td>返回 以10为底的 x 的对数</td>
</tr>
<tr>
<td>Math.log2</td>
<td>返回 以2为底的 x 的对数</td>
</tr>
</tbody>
</table>
<h3 id="6-7-3-三角函数方法（6个）"><a href="#6-7-3-三角函数方法（6个）" class="headerlink" title="6.7.3 三角函数方法（6个）"></a>6.7.3 三角函数方法（6个）</h3><table>
<thead>
<tr>
<th>静态方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Math.sinh(x)</td>
<td>返回 x 的双曲正弦</td>
</tr>
<tr>
<td>Math.cosh(x)</td>
<td>返回 x 的双曲余弦</td>
</tr>
<tr>
<td>Math.tanh(x)</td>
<td>返回 x 的双曲正切</td>
</tr>
<tr>
<td>Math.asinh(x)</td>
<td>返回 x 的反双曲正弦</td>
</tr>
<tr>
<td>Math.aconsh(x)</td>
<td>返回 x 的反双曲余弦</td>
</tr>
<tr>
<td>Math.atanh(x)</td>
<td>返回 x 的反双曲正切</td>
</tr>
</tbody>
</table>
<h2 id="6-8-指数运算符"><a href="#6-8-指数运算符" class="headerlink" title="6.8 指数运算符"></a>6.8 指数运算符</h2><table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>**</code></td>
<td>指数运算符</td>
</tr>
<tr>
<td><code>**=</code></td>
<td>指数运算和等号结合</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> ** <span class="number">2</span><span class="comment">// 4</span></span><br><span class="line"><span class="number">2</span> ** <span class="number">3</span><span class="comment">// 8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">2</span>;</span><br><span class="line">a **= <span class="number">2</span>;<span class="comment">// 等同于 a = a * a</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">3</span>;</span><br><span class="line">b **= <span class="number">3</span>;<span class="comment">// 等同于 b = b * b * b;</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_1 ECMAScript 6 简介/" itemprop="url">
                  1 ECMAScript 6 简介(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:02:44+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_1 ECMAScript 6 简介/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_1 ECMAScript 6 简介/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-ECMAScript和JavaScript的关系"><a href="#1-ECMAScript和JavaScript的关系" class="headerlink" title="1 ECMAScript和JavaScript的关系"></a>1 ECMAScript和JavaScript的关系</h1><h1 id="2-ECMAScript的历史"><a href="#2-ECMAScript的历史" class="headerlink" title="2 ECMAScript的历史"></a>2 ECMAScript的历史</h1><h1 id="3-部署进度"><a href="#3-部署进度" class="headerlink" title="3 部署进度"></a>3 部署进度</h1><h2 id="3-1-浏览器兼容性"><a href="#3-1-浏览器兼容性" class="headerlink" title="3.1 浏览器兼容性"></a>3.1 浏览器兼容性</h2><p>各大浏览器对 <code>ES6</code>的支持情况：<a href="http://kangax.github.io/compat-table/es6/" target="_blank" rel="external">http://kangax.github.io/compat-table/es6/</a></p>
<h2 id="3-2-ES6环境搭建"><a href="#3-2-ES6环境搭建" class="headerlink" title="3.2 ES6环境搭建"></a>3.2 ES6环境搭建</h2><h3 id="3-2-1-NPM"><a href="#3-2-1-NPM" class="headerlink" title="3.2.1 NPM"></a>3.2.1 NPM</h3><p>Github：<a href="https://github.com/creationix/nvm" target="_blank" rel="external">https://github.com/creationix/nvm</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 nvm（安装后需要重启 Terminal）</span></span><br><span class="line">$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.1/install.sh | bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 激活 nvm</span></span><br><span class="line">$ <span class="built_in">source</span> ~/.nvm/nvm.sh </span><br><span class="line"></span><br><span class="line"><span class="comment"># 列举所有可安装的版本</span></span><br><span class="line">$ nvm ls-remote</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 v6.2.2（目前最新版），`nvm install node`默认也是最新版</span></span><br><span class="line">$ nvm install v6.2.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换为 v6.2.2 版本</span></span><br><span class="line">$ nvm use v6.2.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前 node 实现的 ES6特性</span></span><br><span class="line">$ node --v8-options | grep harmony</span><br></pre></td></tr></table></figure>
<h3 id="3-2-2-查看环境对-ES6-的支持度"><a href="#3-2-2-查看环境对-ES6-的支持度" class="headerlink" title="3.2.2 查看环境对 ES6 的支持度"></a>3.2.2 查看环境对 ES6 的支持度</h3><p><strong>浏览器环境</strong>：直接访问<a href="http://ruanyf.github.io/es-checker/" target="_blank" rel="external">http://ruanyf.github.io/es-checker/</a></p>
<p><strong>node环境</strong>：安装<code>ES-Checker</code>的 node版<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g es-checker</span><br><span class="line">$ es-checker</span><br></pre></td></tr></table></figure></p>
<h1 id="4-Babel转码器"><a href="#4-Babel转码器" class="headerlink" title="4 Babel转码器"></a>4 Babel转码器</h1><h2 id="4-1-安装转码器"><a href="#4-1-安装转码器" class="headerlink" title="4.1 安装转码器"></a>4.1 安装转码器</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save-dev babel-preset-es2015</span><br><span class="line">$ npm install --save-dev babel-preset-react</span><br><span class="line">$ npm install --save-dev babel-preset-stage-3</span><br></pre></td></tr></table></figure>
<h2 id="4-2-配置转码规则"><a href="#4-2-配置转码规则" class="headerlink" title="4.2 配置转码规则"></a>4.2 配置转码规则</h2><p> <strong>注意：</strong>所有<code>Babel</code>工具和模块都依赖<code>.babelrc</code>配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在项目根目录编写 babel 配置文件</span></span><br><span class="line">$ vim .babelrc</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">"presets"</span>: [</span><br><span class="line">		<span class="string">"es2015"</span>,</span><br><span class="line">		<span class="string">"react"</span>,</span><br><span class="line">		<span class="string">"stage-3"</span></span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-3-命令行工具"><a href="#4-3-命令行工具" class="headerlink" title="4.3 命令行工具"></a>4.3 命令行工具</h2><h3 id="4-3-1-将-es6-脚本编译为-es5-版本"><a href="#4-3-1-将-es6-脚本编译为-es5-版本" class="headerlink" title="4.3.1 将 es6 脚本编译为 es5 版本"></a>4.3.1 将 es6 脚本编译为 es5 版本</h3><p><em>编译前(example.js)</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> input = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">input.map(item =&gt; item + <span class="number">1</span>);</span><br></pre></td></tr></table></figure></p>
<p><em>使用命令行工具编译</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ babel example.js</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> input = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">input.map(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item + <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="4-3-2-babel-node命令"><a href="#4-3-2-babel-node命令" class="headerlink" title="4.3.2 babel-node命令"></a>4.3.2 <code>babel-node</code>命令</h3><p> 类似<code>node</code>，存在两种模式：<code>REPL</code>和<code>直接运行文件</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入 REPL 模式</span></span><br><span class="line">$ babel-node</span><br><span class="line"> (x =&gt; x + 2)(1)</span><br><span class="line"> 3</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ babel-node example.js</span><br></pre></td></tr></table></figure>
<h3 id="4-3-3-babel-register模块"><a href="#4-3-3-babel-register模块" class="headerlink" title="4.3.3 babel-register模块"></a>4.3.3 <code>babel-register</code>模块</h3><p> <strong>说明：</strong>babel-register模块改写require命令，为它加上一个钩子。此后，每当使用require加载.js、.jsx、.es和.es6后缀名的文件，就会先用Babel进行转码。<br> <strong>注意：</strong>只适合开发环境中使用</p>
<ul>
<li>不属于<code>babel-cli</code>，需要单独安装</li>
<li>必需先加载<code>babel-register</code></li>
<li>支持的文件后缀 <code>.js</code> <code>jsx</code> <code>.es</code> <code>.es6</code></li>
</ul>
<p><em>index.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 先加载 babel-register，后面的才能自动转换</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">"babel-register"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">"./example.js"</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="4-3-4-babel-core"><a href="#4-3-4-babel-core" class="headerlink" title="4.3.4 babel-core"></a>4.3.4 <code>babel-core</code></h3><p>基本使用<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> babel = <span class="built_in">require</span>(<span class="string">'babel-core'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串转码</span></span><br><span class="line">babel.transform(<span class="string">'code();'</span>, options);</span><br><span class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件转码（异步）</span></span><br><span class="line">babel.transformFile(<span class="string">'filename.js'</span>, options, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">  result; <span class="comment">// =&gt; &#123; code, map, ast &#125;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件转码（同步）</span></span><br><span class="line">babel.transformFileSync(<span class="string">'filename.js'</span>, options);</span><br><span class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Babel AST转码</span></span><br><span class="line">babel.transformFromAst(ast, code, options);</span><br><span class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></span><br></pre></td></tr></table></figure></p>
<p>例子<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> es6Code = <span class="string">'let x = n =&gt; n + 1'</span>;</span><br><span class="line"><span class="keyword">var</span> es5Code = <span class="built_in">require</span>(<span class="string">'babel-core'</span>)</span><br><span class="line">  .transform(es6Code, &#123;</span><br><span class="line">    presets: [<span class="string">'es2015'</span>]</span><br><span class="line">  &#125;)</span><br><span class="line">  .code;</span><br></pre></td></tr></table></figure></p>
<h3 id="4-3-5-babel-polyfill"><a href="#4-3-5-babel-polyfill" class="headerlink" title="4.3.5 babel-polyfill"></a>4.3.5 <code>babel-polyfill</code></h3><p> <strong>说明：</strong><code>Babel</code>默认只转换新的<code>JavaScript</code>句法（syntax），而不转换新的<code>API</code>。除非使用<code>babel-polyfill</code>。<br> <strong>注意：</strong><code>Babel</code>默认不转码的<code>API</code>非常多，详细清单可以查看<code>babel-plugin-transform-runtime</code>。</p>
<p>安装到当前环境<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save babel-polyfill</span><br></pre></td></tr></table></figure></p>
<p>引入<code>babel-polyfill</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'babel-polyfill'</span>;</span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'babel-polyfill'</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="4-3-6-浏览器环境"><a href="#4-3-6-浏览器环境" class="headerlink" title="4.3.6 浏览器环境"></a>4.3.6 浏览器环境</h3><hr>
<h4 id="实时转换"><a href="#实时转换" class="headerlink" title="实时转换"></a>实时转换</h4><ol>
<li><p>获取<code>babel</code>的浏览器版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># node_modules/babel-core/browser.js</span></span><br><span class="line">$ npm install babel-core@5</span><br></pre></td></tr></table></figure>
</li>
<li><p>在页面中使用（需要注明<code>type=&quot;text/babel&quot;</code>）</p>
<figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/babel-core/browser.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/babel"</span>&gt;</span><span class="javascript"></span><br><span class="line">	<span class="keyword">let</span> input = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">	input.map(item =&gt; item + <span class="number">1</span>);</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h4 id="打包为生产环境的代码"><a href="#打包为生产环境的代码" class="headerlink" title="打包为生产环境的代码"></a>打包为生产环境的代码</h4><p> <strong>说明：</strong>配合<code>browserify</code>使用<br> <strong>注意：</strong>生产环境需要加载已经转码完成的脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ npm install browserify -g</span><br><span class="line">$ npm install --save-dev babelify babel-preset-es2015</span><br><span class="line"></span><br><span class="line">$ browserify es6.js -o bundle.js -t [ babelify --presets [ es2015 ] ]</span><br></pre></td></tr></table></figure>
<h3 id="4-3-7-在线转换"><a href="#4-3-7-在线转换" class="headerlink" title="4.3.7 在线转换"></a>4.3.7 在线转换</h3><p><a href="https://babeljs.io/repl/" target="_blank" rel="external">https://babeljs.io/repl/</a></p>
<h3 id="4-3-8-与其它工具的配合"><a href="#4-3-8-与其它工具的配合" class="headerlink" title="4.3.8 与其它工具的配合"></a>4.3.8 与其它工具的配合</h3><h4 id="4-3-8-1-ESLint"><a href="#4-3-8-1-ESLint" class="headerlink" title="4.3.8.1 ESLint"></a>4.3.8.1 ESLint</h4><p> 用于静态检查代码的语法和风格</p>
<ol>
<li><p>安装 ESLint</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save-dev eslint babel-eslint</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置<code>.eslintrc</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"parser"</span>: <span class="string">"babel-eslint"</span>,</span><br><span class="line">  <span class="string">"rules"</span>: &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置<code>.package.json</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"my-module"</span>,</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"lint"</span>: <span class="string">"eslint my-files.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"babel-eslint"</span>: <span class="string">"..."</span>,</span><br><span class="line">    <span class="string">"eslint"</span>: <span class="string">"..."</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="4-3-8-2-Mocha"><a href="#4-3-8-2-Mocha" class="headerlink" title="4.3.8.2 Mocha"></a>4.3.8.2 Mocha</h4><p> 一个测试框架，如果需要执行使用ES6语法的测试脚本，可以修改<code>package.json</code>的<code>scripts.test</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"test"</span>: <span class="string">"mocha --ui qunit --compilers js:babel-core/register"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="5-Traceur转码器"><a href="#5-Traceur转码器" class="headerlink" title="5 Traceur转码器"></a>5 Traceur转码器</h1><h1 id="6-ECMAScript-7"><a href="#6-ECMAScript-7" class="headerlink" title="6 ECMAScript 7"></a>6 ECMAScript 7</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_2 let和const命令/" itemprop="url">
                  2 let和const命令(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:02:11+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_2 let和const命令/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_2 let和const命令/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-let命令"><a href="#1-let命令" class="headerlink" title="1 let命令"></a>1 let命令</h1><p>用来声明变量</p>
<ol>
<li>只在声明时所在的<code>代码块</code>内有效</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a <span class="comment">// ReferenceError: a is not defined.</span></span><br><span class="line">b <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<ol>
<li>for循环</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [];</span><br><span class="line"><span class="comment">// 每一次循环的 i 其实都是一个新的变量</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  a[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line">a[<span class="number">6</span>](); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure>
<ol>
<li>不存在变量提升</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 变量一定要在声明后使用，否则报错。</span></span><br><span class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// 输出undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(bar); <span class="comment">// 报错ReferenceError</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">let</span> bar = <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<ol>
<li>暂时性死区<br><strong>说明：</strong>在代码块内，使用<code>let</code>命令声明变量之前，该变量都是不可用的。这在语法上，称为<code>暂时性死区（temporal dead zone，简称TDZ）</code>。<br><strong>注意：</strong><code>暂时性死区</code>也意味着<code>typeof</code>不再是一个百分之百安全的操作。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> x; <span class="comment">// ReferenceError</span></span><br><span class="line"><span class="keyword">let</span> x;</span><br></pre></td></tr></table></figure>
<ol>
<li>不允许重复声明<br><strong>说明：</strong><code>let</code>不允许在相同作用域内，重复声明同一个变量。<br><strong>注意：</strong>不能在函数内部重新用<code>let</code>声明参数</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> arg; <span class="comment">// 报错</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">let</span> arg; <span class="comment">// 不报错</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-块级作用域"><a href="#2-块级作用域" class="headerlink" title="2 块级作用域"></a>2 块级作用域</h1><p><strong>说明：</strong><code>let</code>实际上为JavaScript新增了块级作用域。<br><strong>注意：</strong>块级作用域的出现，实际上使得获得广泛应用的<code>立即执行匿名函数</code>（IIFE）不再必要了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IIFE写法</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> tmp = ...;</span><br><span class="line">  ...</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 块级作用域写法</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> tmp = ...;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-1-块级作用域与函数声明"><a href="#2-1-块级作用域与函数声明" class="headerlink" title="2.1 块级作用域与函数声明"></a>2.1 块级作用域与函数声明</h2><p><strong>说明：</strong>ES6引入了块级作用域，明确允许在块级作用域之中声明函数。<br><strong>注意：</strong>ES6的块级作用域允许声明函数的规则，只在使用<code>{}</code>的情况下成立，如果没有使用<code>{}</code>，就会报错<br>环境|在块级作用域中声明函数|声明提升<br>-|-|-<br>标准ES5环境|不可以|会<br>标准ES6环境|可以|不会<br>浏览器ES5环境|可以|会<br>浏览器ES6环境|可以|会</p>
<p><strong>技巧：</strong>考虑到环境导致的行为差异太大，应该避免在块级作用域内声明函数。如果确实需要，也应该写成函数表达式，而不是函数声明语句。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="comment">// 重复声明一次函数f</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  f();</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure></p>
<h1 id="3-const命令"><a href="#3-const命令" class="headerlink" title="3 const命令"></a>3 const命令</h1><p><strong>说明：</strong>const声明一个只读的常量<br><strong>注意：</strong>将一个对象声明为常量必须非常小心<br><strong>扩展：</strong>如果真的想将对象冻结，应该使用<code>Object.freeze</code>方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> constantize = (obj) =&#123;</span><br><span class="line">  <span class="built_in">Object</span>.freeze(obj);</span><br><span class="line">  <span class="built_in">Object</span>.keys(obj).forEach( (key, value) =&#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="keyword">typeof</span> obj[key] === <span class="string">'object'</span> ) &#123;</span><br><span class="line">      constantize( obj[key] );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>const一旦声明变量，就必须立即初始化，不能留到以后赋值</li>
<li>一旦声明，常量的值就不能改变</li>
<li>只在声明所在的块级作用域内有效（类似<code>let</code>）</li>
<li>不可以重复声明（类似<code>let</code>）</li>
<li>不会发生声明提升（类似<code>let</code>）</li>
<li>存在暂时性死区（类似<code>let</code>）</li>
<li><code>const</code>命令只是保证变量名指向的地址不变，并不保证该地址的数据不变<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PI = <span class="number">3.1415</span>;</span><br><span class="line">PI <span class="comment">// 3.1415</span></span><br><span class="line"></span><br><span class="line">PI = <span class="number">3</span>;</span><br><span class="line"><span class="comment">// TypeError: Assignment to constant variable.</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="4-全局对象的属性"><a href="#4-全局对象的属性" class="headerlink" title="4 全局对象的属性"></a>4 全局对象的属性</h1><p>未声明的全局变量，自动成为全局对象<code>window</code>的属性，这被认为是<code>JavaScript</code>语言最大的设计败笔之一，ES6改变了这一点：</p>
<ul>
<li><code>var</code>命令和<code>function</code>命令声明的全局变量，依旧是全局对象的属性</li>
<li><code>let</code>命令、<code>const</code>命令、<code>class</code>命令声明的全局变量，不属于全局对象的属性（从ES6开始，全局变量将逐步与全局对象的属性脱钩）</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="comment">// 如果在Node的REPL环境，可以写成global.a</span></span><br><span class="line"><span class="comment">// 或者采用通用方法，写成this.a</span></span><br><span class="line"><span class="built_in">window</span>.a <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">window</span>.b <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_3 变量的解构赋值/" itemprop="url">
                  3 变量的解构赋值(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:01:59+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_3 变量的解构赋值/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_3 变量的解构赋值/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>从数组和对象中提取值，对变量进行赋值，这被称为解构（Destructuring）</p>
<p>#1 数组的解构赋值</p>
<h2 id="1-1-基本使用"><a href="#1-1-基本使用" class="headerlink" title="1.1 基本使用"></a>1.1 基本使用</h2><h3 id="1-1-1-完全解构"><a href="#1-1-1-完全解构" class="headerlink" title="1.1.1 完全解构"></a>1.1.1 完全解构</h3><p><strong>条件：</strong>等号两边的模式相同<br><strong>描述：</strong>左边所有变量都被赋值，所有值都被提取出来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [foo, [[bar], baz]] = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]];</span><br><span class="line">foo <span class="comment">// 1</span></span><br><span class="line">bar <span class="comment">// 2</span></span><br><span class="line">baz <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [ , , third] = [<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>];</span><br><span class="line">third <span class="comment">// "baz"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x, , y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [head, ...tail] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">head <span class="comment">// 1</span></span><br><span class="line">tail <span class="comment">// [2, 3, 4]</span></span><br></pre></td></tr></table></figure>
<h3 id="1-1-2-不完全解构"><a href="#1-1-2-不完全解构" class="headerlink" title="1.1.2 不完全解构"></a>1.1.2 不完全解构</h3><p><strong>条件：</strong>即等号左边的模式，只匹配一部分的等号右边的数组<br><strong>描述：</strong>左边所有变量都被赋值，但没有提取出右边所有的值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [x, y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [a, [b], d] = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>];</span><br><span class="line">a <span class="comment">// 1</span></span><br><span class="line">b <span class="comment">// 2</span></span><br><span class="line">d <span class="comment">// 4</span></span><br></pre></td></tr></table></figure></p>
<h3 id="1-1-3-解构失败"><a href="#1-1-3-解构失败" class="headerlink" title="1.1.3 解构失败"></a>1.1.3 解构失败</h3><p><strong>描述：</strong>解构没有报错，但存在没被赋值的变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [x, y, ...z] = [<span class="string">'a'</span>];</span><br><span class="line">x <span class="comment">// "a"</span></span><br><span class="line">y <span class="comment">// undefined</span></span><br><span class="line">z <span class="comment">// []</span></span><br></pre></td></tr></table></figure>
<h3 id="1-1-4-报错"><a href="#1-1-4-报错" class="headerlink" title="1.1.4 报错"></a>1.1.4 报错</h3><p><strong>条件：</strong>等号的右边不是数组<br><strong>扩展：</strong>事实上，只要某种数据结构具有<code>Iterator</code>接口，都可以采用数组形式的解构赋值。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 转为对象以后不具备Iterator接口 */</span></span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="literal">NaN</span>;</span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 本身就不具备Iterator接口 */</span></span><br><span class="line"><span class="keyword">let</span> [foo] = &#123;&#125;;</span><br></pre></td></tr></table></figure></p>
<p>##1.2 默认值</p>
<p>解构赋值允许指定默认值。</p>
<h3 id="1-2-1-默认值生效条件"><a href="#1-2-1-默认值生效条件" class="headerlink" title="1.2.1 默认值生效条件"></a>1.2.1 默认值生效条件</h3><p>通过模式匹配对应的数组成员<code>===</code> <code>undefined</code>，默认值才会生效</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 生效 */</span></span><br><span class="line"><span class="keyword">var</span> [x = <span class="number">1</span>] = [<span class="literal">undefined</span>];</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 不生效 */</span></span><br><span class="line"><span class="keyword">var</span> [x = <span class="number">1</span>] = [<span class="literal">null</span>];</span><br><span class="line">x <span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-2-默认值使用表达式"><a href="#1-2-2-默认值使用表达式" class="headerlink" title="1.2.2 默认值使用表达式"></a>1.2.2 默认值使用表达式</h3><p><strong>会出现惰性求值：</strong>即只有在用到的时候（默认值生效），才会求值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不会执行，因为 x 的默认值没生效</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'aaa'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x = f()] = [<span class="number">1</span>];</span><br></pre></td></tr></table></figure>
<h3 id="1-2-3-默认值引用其它变量"><a href="#1-2-3-默认值引用其它变量" class="headerlink" title="1.2.3 默认值引用其它变量"></a>1.2.3 默认值引用其它变量</h3><p><strong>注意：</strong>该变量必须已经声明，否则报错</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 正确使用 */</span></span><br><span class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [];     <span class="comment">// x=1; y=1</span></span><br><span class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [<span class="number">2</span>];    <span class="comment">// x=2; y=2</span></span><br><span class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [<span class="number">1</span>, <span class="number">2</span>]; <span class="comment">// x=1; y=2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 错误使用 */</span></span><br><span class="line"><span class="keyword">let</span> [x = y, y = <span class="number">1</span>] = [];     <span class="comment">// ReferenceError</span></span><br></pre></td></tr></table></figure>
<p>#2 对象的解构赋值<br>对象的解构与数组有一个重要的不同</p>
<ul>
<li>数组：元素是按次序排列的，变量的取值由它的<code>位置</code>决定</li>
<li>对象：属性没有次序，变量必须与属性<code>同名</code>，才能取到正确的值</li>
</ul>
<p><code>[</code>var<code>|</code>let<code>|</code>const<code>]</code> {模式<code>:[</code>赋值变量<code>]</code>} = {属性1: 属性1值};</p>
<h2 id="2-1-变量必须与属性同名"><a href="#2-1-变量必须与属性同名" class="headerlink" title="2.1 变量必须与属性同名"></a>2.1 变量必须与属性同名</h2><p>对象的解构赋值的内部机制，是先找到同名属性，然后再赋给对应的变量。真正被赋值的是后者，而不是前者</p>
<p>如果打算让被赋值变量和模式同名，则可以省略模式<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123; bar, foo &#125; = &#123; foo: <span class="string">"aaa"</span>, bar: <span class="string">"bbb"</span> &#125;;</span><br><span class="line">foo <span class="comment">// "aaa"</span></span><br><span class="line">bar <span class="comment">// "bbb"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; baz &#125; = &#123; foo: <span class="string">"aaa"</span>, bar: <span class="string">"bbb"</span> &#125;;</span><br><span class="line">baz <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure></p>
<p>否则<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123; foo: baz &#125; = &#123; foo: <span class="string">"aaa"</span>, bar: <span class="string">"bbb"</span> &#125;;</span><br><span class="line">baz <span class="comment">// "aaa"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123; first: <span class="string">'hello'</span>, last: <span class="string">'world'</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; first: f, last: l &#125; = obj;</span><br><span class="line">f <span class="comment">// 'hello'</span></span><br><span class="line">l <span class="comment">// 'world'</span></span><br></pre></td></tr></table></figure></p>
<h2 id="2-2-变量的声明和赋值是一体的"><a href="#2-2-变量的声明和赋值是一体的" class="headerlink" title="2.2 变量的声明和赋值是一体的"></a>2.2 变量的声明和赋值是一体的</h2><p>对于<code>let</code>和`const来说，变量不能重新声明，所以一旦赋值的变量以前声明过</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> foo;</span><br><span class="line"><span class="keyword">let</span> &#123;foo&#125; = &#123;foo: <span class="number">1</span>&#125;; <span class="comment">// SyntaxError: Duplicate declaration "foo"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> baz;</span><br><span class="line"><span class="keyword">let</span> &#123;bar: baz&#125; = &#123;bar: <span class="number">1</span>&#125;; <span class="comment">// SyntaxError: Duplicate declaration "baz"</span></span><br></pre></td></tr></table></figure>
<h2 id="2-3-解构嵌套结构的对象"><a href="#2-3-解构嵌套结构的对象" class="headerlink" title="2.3 解构嵌套结构的对象"></a>2.3 解构嵌套结构的对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  p: [</span><br><span class="line">    <span class="string">"Hello"</span>,</span><br><span class="line">    &#123; y: <span class="string">"World"</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; p: [x, &#123; y &#125;] &#125; = obj;</span><br><span class="line">x <span class="comment">// "Hello"</span></span><br><span class="line">y <span class="comment">// "World"</span></span><br></pre></td></tr></table></figure>
<h2 id="2-4-指定默认值"><a href="#2-4-指定默认值" class="headerlink" title="2.4 指定默认值"></a>2.4 指定默认值</h2><p>默认值生效的条件是，对象的属性值严格等于<code>undefined</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123;x = <span class="number">3</span>&#125; = &#123;&#125;;</span><br><span class="line">x <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;x, y = <span class="number">5</span>&#125; = &#123;x: <span class="number">1</span>&#125;;</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; message: msg = <span class="string">"Something went wrong"</span> &#125; = &#123;&#125;;</span><br><span class="line">msg <span class="comment">// "Something went wrong"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="2-5-解构失败"><a href="#2-5-解构失败" class="headerlink" title="2.5 解构失败"></a>2.5 解构失败</h2><p>如果解构失败，变量的值等于<code>undefined</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1. 无法匹配到模式 */</span></span><br><span class="line"><span class="keyword">var</span> &#123;foo&#125; = &#123;bar: <span class="string">'baz'</span>&#125;;</span><br><span class="line">foo <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2. 子对象所在的父属性 */</span></span><br><span class="line"><span class="keyword">var</span> &#123;foo: &#123;bar&#125;&#125; = &#123;baz: <span class="string">'baz'</span>&#125;;<span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
<h2 id="2-6-已经声明的变量"><a href="#2-6-已经声明的变量" class="headerlink" title="2.6 已经声明的变量"></a>2.6 已经声明的变量</h2><p>如果要将一个已经声明的变量用于解构赋值，必须非常小心<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x;</span><br><span class="line"></span><br><span class="line"><span class="comment">// JavaScript引擎会将&#123;x&#125;理解成一个代码块，从而发生语法错误</span></span><br><span class="line">&#123;x&#125; = &#123;x: <span class="number">1</span>&#125;;<span class="comment">// SyntaxError: syntax error</span></span><br></pre></td></tr></table></figure></p>
<p>将整个解构赋值语句，放在一个圆括号里面，就可以正确执行<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x;</span><br><span class="line">()&#123;x&#125; = &#123;x: <span class="number">1</span>&#125;);</span><br><span class="line">x <span class="comment">// 1</span></span><br></pre></td></tr></table></figure></p>
<p>#3 字符串的解构赋值<br>字符串也可以解构赋值。这是因为此时，字符串被转换成了一个类似数组的对象。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [a, b, c, d, e] = <span class="string">'hello'</span>;</span><br><span class="line">a <span class="comment">// "h"</span></span><br><span class="line">b <span class="comment">// "e"</span></span><br><span class="line">c <span class="comment">// "l"</span></span><br><span class="line">d <span class="comment">// "l"</span></span><br><span class="line">e <span class="comment">// "o"</span></span><br></pre></td></tr></table></figure></p>
<p>类似数组的对象都有一个length属性，因此还可以对这个属性解构赋值。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;length : len&#125; = <span class="string">'hello'</span>;</span><br><span class="line">len <span class="comment">// 5</span></span><br></pre></td></tr></table></figure></p>
<p>#4 数值和布尔值的解构赋值<br><strong>说明：</strong>解构赋值时，如果等号右边是数值和布尔值，则会先转为对象<br><strong>注意：</strong><code>undefined</code>和<code>null</code>无法转为对象，所以对它们进行解构赋值，都会报错</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;toString: s&#125; = <span class="number">123</span>;</span><br><span class="line">s === <span class="built_in">Number</span>.prototype.toString <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;toString: s&#125; = <span class="literal">true</span>;</span><br><span class="line">s === <span class="built_in">Boolean</span>.prototype.toString <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; prop: x &#125; = <span class="literal">undefined</span>; <span class="comment">// TypeError</span></span><br><span class="line"><span class="keyword">let</span> &#123; prop: y &#125; = <span class="literal">null</span>; <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure>
<p>#5 函数参数的解构赋值<br>函数的参数也可以使用解构赋值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">[x, y]</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add([<span class="number">1</span>, <span class="number">2</span>]); <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]].map(([a, b]) =a + b);</span><br></pre></td></tr></table></figure>
<h2 id="5-1-默认值"><a href="#5-1-默认值" class="headerlink" title="5.1 默认值"></a>5.1 默认值</h2><p><strong>注意：</strong>分两种情况</p>
<ol>
<li><p>给解构后被赋值的变量提供默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">&#123;x = 0, y = 0&#125; = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">move(&#123;x: <span class="number">3</span>, y: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></span><br><span class="line">move(&#123;x: <span class="number">3</span>&#125;); <span class="comment">// [3, 0]</span></span><br><span class="line">move(&#123;&#125;); <span class="comment">// [0, 0]</span></span><br><span class="line">move(); <span class="comment">// [0, 0]，参数对象默认值生效，为&#123;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>给传入的参数提供默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">&#123;x, y&#125; = &#123; x: 0, y: 0 &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">move(&#123;x: <span class="number">3</span>, y: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></span><br><span class="line">move(&#123;x: <span class="number">3</span>&#125;); <span class="comment">// [3, undefined]</span></span><br><span class="line">move(&#123;&#125;); <span class="comment">// [undefined, undefined]</span></span><br><span class="line">move(); <span class="comment">// [0, 0]</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>#6 圆括号的解构赋值</p>
<p>##6.1 不能使用圆括号的情形</p>
<p><strong>说明：</strong>ES6的规则是，只要有可能导致解构的歧义，就不得使用圆括号。<br><strong>建议：</strong>只要有可能，就不要在模式中放置圆括号。</p>
<ol>
<li><p>变量声明语句中，不能带有圆括号</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全部报错</span></span><br><span class="line"><span class="keyword">var</span> [(a)] = [<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;x: (c)&#125; = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> (&#123;x: c&#125;) = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> &#123;(x: c)&#125; = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> &#123;(x): c&#125; = &#123;&#125;;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; o: (&#123; p: p &#125;) &#125; = &#123; o: &#123; p: <span class="number">2</span> &#125; &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数参数中，模式不能带有圆括号<br>函数参数也属于变量声明，因此不能带有圆括号</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">[(z</span>)]) </span>&#123; <span class="keyword">return</span> z; &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>赋值语句中，不能将整个模式，或嵌套模式中的一层，放在圆括号之中</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全部报错</span></span><br><span class="line">(&#123; p: a &#125;) = &#123; p: <span class="number">42</span> &#125;;</span><br><span class="line">([a]) = [<span class="number">5</span>];</span><br><span class="line">[(&#123; p: a &#125;), &#123; x: c &#125;] = [&#123;&#125;, &#123;&#125;];</span><br></pre></td></tr></table></figure>
<h2 id="6-2-可以使用圆括号的情形"><a href="#6-2-可以使用圆括号的情形" class="headerlink" title="6.2 可以使用圆括号的情形"></a>6.2 可以使用圆括号的情形</h2><p>赋值语句的非模式部分</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[(b)] = [<span class="number">3</span>]; <span class="comment">// 正确</span></span><br><span class="line">(&#123; p: (d) &#125; = &#123;&#125;); <span class="comment">// 正确</span></span><br><span class="line">[(<span class="built_in">parseInt</span>.prop)] = [<span class="number">3</span>]; <span class="comment">// 正确</span></span><br></pre></td></tr></table></figure>
<p>#7 用途的解构赋值</p>
<ol>
<li>交换变量的值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x, y] = [y, x];</span><br></pre></td></tr></table></figure>
<ol>
<li>从函数返回多个值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回一个数组</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> [a, b, c] = example();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一个对象</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    foo: <span class="number">1</span>,</span><br><span class="line">    bar: <span class="number">2</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> &#123; foo, bar &#125; = example();</span><br></pre></td></tr></table></figure>
<ol>
<li><p>函数参数的定义</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 参数是一组有次序的值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">[x, y, z]</span>) </span>&#123; ... &#125;</span><br><span class="line">f([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数是一组无次序的值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">&#123;x, y, z&#125;</span>) </span>&#123; ... &#125;</span><br><span class="line">f(&#123;z: <span class="number">3</span>, y: <span class="number">2</span>, x: <span class="number">1</span>&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取JSON数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonData = &#123;</span><br><span class="line">  id: <span class="number">42</span>,</span><br><span class="line">  status: <span class="string">"OK"</span>,</span><br><span class="line">  data: [<span class="number">867</span>, <span class="number">5309</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; id, status, data: number &#125; = jsonData;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(id, status, number);</span><br><span class="line"><span class="comment">// 42, "OK", [867, 5309]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>函数参数的默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">jQuery.ajax = <span class="function"><span class="keyword">function</span> (<span class="params">url, &#123;</span><br><span class="line">  async = true,</span><br><span class="line">  beforeSend = function (</span>) </span>&#123;&#125;,</span><br><span class="line">  cache = <span class="literal">true</span>,</span><br><span class="line">  complete = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  crossDomain = <span class="literal">false</span>,</span><br><span class="line">  global = <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// ... more config</span></span><br><span class="line">&#125;) &#123;</span><br><span class="line">  <span class="comment">// ... do stuff</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历Map结构</p>
</li>
</ol>
<p>Iterator配合解构赋值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">map.set(<span class="string">'first'</span>, <span class="string">'hello'</span>);</span><br><span class="line">map.set(<span class="string">'second'</span>, <span class="string">'world'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key + <span class="string">" is "</span> + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// first is hello</span></span><br><span class="line"><span class="comment">// second is world</span></span><br></pre></td></tr></table></figure></p>
<p>如果只想获取键名，或者只想获取键值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取键名</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取键值</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [,value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>输入模块的指定方法<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; SourceMapConsumer, SourceNode &#125; = <span class="built_in">require</span>(<span class="string">"source-map"</span>);</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_4 字符串的扩展/" itemprop="url">
                  4 字符串的扩展(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:01:44+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_4 字符串的扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_4 字符串的扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="4-1-字符的unicode表示法"><a href="#4-1-字符的unicode表示法" class="headerlink" title="4.1 字符的unicode表示法"></a>4.1 字符的unicode表示法</h2><table>
<thead>
<tr>
<th>unicode表示法</th>
<th>码点</th>
<th>兼容性</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\uxxxx</code></td>
<td>一个两个字节长度的16进制数字</td>
<td>all</td>
</tr>
<tr>
<td><code>\uxxxx\uxxxx</code></td>
<td>两个两个字节长度的16进制数字</td>
<td>all</td>
</tr>
<tr>
<td><code>\u{xx...}</code></td>
<td>码点为任意unicode编码</td>
<td>es6+</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"\u&#123;20BB7&#125;"</span></span><br><span class="line"><span class="comment">// "𠮷"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"\u&#123;41&#125;\u&#123;42&#125;\u&#123;43&#125;"</span></span><br><span class="line"><span class="comment">// "ABC"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> hello = <span class="number">123</span>;</span><br><span class="line">hell\u&#123;<span class="number">6</span>F&#125; <span class="comment">// 123</span></span><br><span class="line"></span><br><span class="line"><span class="string">'\u&#123;1F680&#125;'</span> === <span class="string">'\uD83D\uDE80'</span></span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="4-2-codePointAt"><a href="#4-2-codePointAt" class="headerlink" title="4.2 codePointAt()"></a>4.2 codePointAt()</h2><p><strong>背景：</strong><code>javascript</code>使用<code>utf-16</code>（两个字节）存储字符，使用<code>charCodeAt</code>无法正确处理四字节字符</p>
<p>类似<code>charCodeAt</code>，区别是<code>codePointAt</code>能够正确识别四字节字符（比如<code>吉祥</code>）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'吉a'</span>;</span><br><span class="line"></span><br><span class="line">s.codePointAt(<span class="number">0</span>) <span class="comment">// 134071(吉,0xD842 0xDFB7)</span></span><br><span class="line">s.codePointAt(<span class="number">1</span>) <span class="comment">// 57271（0xDFB7）</span></span><br><span class="line"></span><br><span class="line">s.charCodeAt(<span class="number">2</span>) <span class="comment">// 97</span></span><br><span class="line">s.codePointAt(<span class="number">2</span>) <span class="comment">// 97</span></span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong><code>codePointAt</code>仍会按照两个字节一个字符的方式计算字符串中字符数量，因此传递给<code>codePointAt</code>的参数和<code>charCodeAt</code>是一样的。<br><strong>扩展：</strong>使用<code>for-of</code>可以正确识别32位（4字节）UTF-16字符。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'吉a'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> s) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(ch.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 20bb7</span></span><br><span class="line"><span class="comment">// 61</span></span><br></pre></td></tr></table></figure></p>
<p><strong>技巧：</strong>使用<code>codePointAt</code>获取字符的<code>UTF-16</code>完整编码，并判断其大小，就可以识别4字节字符。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is32Bit</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> c.codePointAt(<span class="number">0</span>) <span class="number">0xFFFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">is32Bit(<span class="string">"𠮷"</span>) <span class="comment">// true</span></span><br><span class="line">is32Bit(<span class="string">"a"</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure></p>
<h2 id="4-3-String-fromCodePoint"><a href="#4-3-String-fromCodePoint" class="headerlink" title="4.3 String.fromCodePoint()"></a>4.3 String.fromCodePoint()</h2><p><strong>背景：</strong><code>String.fromCharCode</code>用于从码点返回对应的字符，但对32位的<code>UTF-16</code>字符进行转换会发生溢出。</p>
<p><code>String.fromCodePoint</code>对应<code>codePointAt</code>，可以正确返回32为<code>UTF-16</code>字符对应的字符；当传递多个参数给<code>String.fromCodePoint</code>时，会返回每个参数（码点）对应的字符拼接成的字符串。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>)</span><br><span class="line"><span class="comment">// "𠮷"</span></span><br><span class="line"><span class="built_in">String</span>.fromCodePoint(<span class="number">0x78</span>, <span class="number">0x1f680</span>, <span class="number">0x79</span>) === <span class="string">'x\uD83D\uDE80y'</span></span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="4-4-字符串的遍历器接口"><a href="#4-4-字符串的遍历器接口" class="headerlink" title="4.4 字符串的遍历器接口"></a>4.4 字符串的遍历器接口</h2><p><strong>说明：</strong>es6为字符串添加了便利器接口，因而可以通过<code>for-of</code>遍历字符串。<br><strong>特点：</strong>能够正确识别码点大于<code>\uffff</code>的字符<br><strong>技巧：</strong>利用<code>for-of</code>计算字符串正确的字符个数（传统的<code>for</code>和<code>for-in</code>无法做到）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> text = <span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> text) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// "吉"</span></span><br></pre></td></tr></table></figure>
<h2 id="4-5-at"><a href="#4-5-at" class="headerlink" title="4.5 at()"></a>4.5 at()</h2><p><strong>说明：</strong>字符串的方法（提案状态？），能够识别码点大于<code>\uffff</code>的字符<br><strong>ES5：</strong>字符串的<code>charAt</code>方法用于返回字符串给定位置的字符，但不能正确识别码点大于<code>\uffff</code>的字符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'吉'</span>.at(<span class="number">0</span>) <span class="comment">// "吉"</span></span><br></pre></td></tr></table></figure>
<h2 id="4-6-normalize"><a href="#4-6-normalize" class="headerlink" title="4.6 normalize()"></a>4.6 normalize()</h2><p><strong>说明：</strong>es6提供字符串实例的<code>normalize</code>方法，用来将字符的不同表示方法统一为同样的形式，称为<code>unicode正规化</code>。</p>
<h2 id="4-7-includes-startsWith-endsWith"><a href="#4-7-includes-startsWith-endsWith" class="headerlink" title="4.7 includes(), startsWith(), endsWith()"></a>4.7 includes(), startsWith(), endsWith()</h2><table>
<thead>
<tr>
<th>方法</th>
<th>返回值</th>
<th>第二个参数(可选)</th>
</tr>
</thead>
<tbody>
<tr>
<td>includes</td>
<td>布尔值，表示是否找到了参数字符串</td>
<td>开始搜索的位置</td>
</tr>
<tr>
<td>startsWith</td>
<td>布尔值，表示参数字符串是否在源字符串的头部</td>
<td>开始搜索的位置</td>
</tr>
<tr>
<td>endsWith</td>
<td>布尔值，表示参数字符串是否在源字符串的尾部</td>
<td>停止搜索的位置</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</span><br><span class="line"></span><br><span class="line">s.startsWith(<span class="string">'world'</span>, <span class="number">6</span>) <span class="comment">// true</span></span><br><span class="line">s.endsWith(<span class="string">'Hello'</span>, <span class="number">5</span>) <span class="comment">// true</span></span><br><span class="line">s.includes(<span class="string">'Hello'</span>, <span class="number">6</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h2 id="4-8-repeat"><a href="#4-8-repeat" class="headerlink" title="4.8 repeat()"></a>4.8 repeat()</h2><p><strong>用途：</strong>返回一个将源字符串重复n次的新字符串<br><strong>注意：</strong>如果参数不是整数，将会按照一定规则取整<br>非整数参数|转换后<br>-|-<br>小数|向下取整<br>负数或<code>Infinity</code>|报错<br>0~-1|0<br><code>NaN</code>|0<br>字符串|相应的数字</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'x'</span>.repeat(<span class="number">3</span>) <span class="comment">// "xxx"</span></span><br><span class="line"><span class="string">'hello'</span>.repeat(<span class="number">2</span>) <span class="comment">// "hellohello"</span></span><br><span class="line"><span class="string">'na'</span>.repeat(<span class="number">0</span>) <span class="comment">// ""</span></span><br><span class="line"></span><br><span class="line"><span class="string">'na'</span>.repeat(<span class="number">-0.9</span>) <span class="comment">// ""</span></span><br><span class="line"><span class="string">'na'</span>.repeat(<span class="string">'na'</span>) <span class="comment">// ""</span></span><br><span class="line"><span class="string">'na'</span>.repeat(<span class="string">'3'</span>) <span class="comment">// "nanana"</span></span><br></pre></td></tr></table></figure>
<p>##4.9 padStart(), padEnd()</p>
<p><strong>ES7：</strong>补全字符串的长度<br>函数|用途<br>-|-<br>padStart|用于头部补全<br>padEnd|用于尾部补全</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>第一个参数</td>
<td>指定字符串的最小长度</td>
</tr>
<tr>
<td>第二个参数（可选）</td>
<td>用来补全的字符串，默认为空格。如果用来补全的字符串与原字符串，两者的长度之和超过了指定的最小长度，则会截去超出位数的补全字符串</td>
</tr>
</tbody>
</table>
<p><strong>注意：</strong>如果原字符串的长度，等于或大于指定的最小长度，则返回原字符串。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为数值补全指定位数</span></span><br><span class="line"><span class="string">'1'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000001"</span></span><br><span class="line"><span class="string">'12'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000012"</span></span><br><span class="line"><span class="string">'123456'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000123456"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 提示字符串格式</span></span><br><span class="line"><span class="string">'12'</span>.padStart(<span class="number">10</span>, <span class="string">'YYYY-MM-DD'</span>) <span class="comment">// "YYYY-MM-12"</span></span><br><span class="line"><span class="string">'09-12'</span>.padStart(<span class="number">10</span>, <span class="string">'YYYY-MM-DD'</span>) <span class="comment">// "YYYY-09-12"</span></span><br></pre></td></tr></table></figure>
<p>##4.10 模版字符串</p>
<p><strong>语法：</strong>使用反引号括起来</p>
<ul>
<li>可以当作普通字符串来使用，也可以用来定义多行字符串</li>
<li>可以在字符串中<code>嵌入变量</code></li>
<li>如果模版字符串中使用反引号，则前面要用<code>反斜杠转义</code></li>
<li>所有的<code>空格和缩进</code>都会被保留在输出之中，不需要的话可以使用<code>trim</code>方法消除</li>
<li>模板字符串中嵌入变量，需要将变量名写在<code>${}</code>之中</li>
</ul>
<h3 id="4-10-1-嵌入JS表达式"><a href="#4-10-1-嵌入JS表达式" class="headerlink" title="4.10.1 嵌入JS表达式"></a>4.10.1 嵌入<code>JS表达式</code></h3><p>大括号内部可以放入任意的JavaScript表达式，可以</p>
<ul>
<li>进行运算</li>
<li>引用对象属性</li>
<li>调用函数</li>
</ul>
<p><strong>注意：</strong></p>
<ul>
<li>如果<code>${}</code>中的值不是字符串，将按照一般的规则转为字符串</li>
<li>如果<code>${}</code>内部是一个字符串，将会原样输出</li>
<li>如果模板字符串中的变量没有声明，将报错</li>
<li>通过<code>${}</code>，模板字符串甚至还能嵌套</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// 定义返回模版字符串的函数</span><br><span class="line">const tmpl = addrs =`</span><br><span class="line">  &lt;table&gt;</span><br><span class="line">  $&#123;addrs.map(addr =`</span><br><span class="line">    &lt;tr&gt;&lt;td&gt;$&#123;addr.first&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;&lt;td&gt;$&#123;addr.last&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">  `).join('')&#125;</span><br><span class="line">  &lt;/table&gt;</span><br><span class="line">`;</span><br><span class="line"></span><br><span class="line">// 定义填充模版字符串的数据</span><br><span class="line">const data = [</span><br><span class="line">    &#123; first: '&lt;Jane&gt;', last: 'Bond' &#125;,</span><br><span class="line">    &#123; first: 'Lars', last: '&lt;Croft&gt;' &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">console.log(tmpl(data));</span><br><span class="line">// &lt;table&gt;</span><br><span class="line">//</span><br><span class="line">//   &lt;tr&gt;&lt;td&gt;&lt;Jane&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">//   &lt;tr&gt;&lt;td&gt;Bond&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">//</span><br><span class="line">//   &lt;tr&gt;&lt;td&gt;Lars&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">//   &lt;tr&gt;&lt;td&gt;&lt;Croft&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">//</span><br><span class="line">// &lt;/table&gt;</span><br></pre></td></tr></table></figure>
<p>##4.11 实例：模版编译</p>
<p><em>l04_template.vue</em><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	export default &#123;</span><br><span class="line">		data () &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				template: '',</span><br><span class="line">				templateCompiled: '',</span><br><span class="line">				templateOutput: ''</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			/**</span><br><span class="line">			* 模版编译函数</span><br><span class="line">			* @param &#123;string&#125; template 模版字符串</span><br><span class="line">			* @return &#123;string&#125; 可执行的js代码</span><br><span class="line">			*/</span><br><span class="line">			compile: function (template)&#123;</span><br><span class="line">			  var evalExpr = /&lt;%=(.+?)%&gt;/g;</span><br><span class="line">			  var expr = /&lt;%([\s\S]+?)%&gt;/g;</span><br><span class="line"></span><br><span class="line">			  template = template</span><br><span class="line">			    .replace(evalExpr, '`); \n  echo( $1 ); \n  echo(`')</span><br><span class="line">			    .replace(expr, '`); \n $1 \n  echo(`');</span><br><span class="line"></span><br><span class="line">			  template = 'echo(`' + template + '`);';</span><br><span class="line"></span><br><span class="line">			  var script =</span><br><span class="line">			  `(function parse(data)&#123;</span><br><span class="line">			    var output = "";</span><br><span class="line"></span><br><span class="line">			    function echo(html)&#123;</span><br><span class="line">			      output += html;</span><br><span class="line">			    &#125;</span><br><span class="line"></span><br><span class="line">			    $&#123; template &#125;</span><br><span class="line"></span><br><span class="line">			    return output;</span><br><span class="line">			  &#125;)`;</span><br><span class="line"></span><br><span class="line">			  return script;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		ready: function () &#123;</span><br><span class="line">			// 定义原始模版</span><br><span class="line">			this.template = `</span><br><span class="line">			&lt;ul&gt;</span><br><span class="line">			  &lt;% for(var i=0; i &lt; data.supplies.length; i++) &#123; %&gt;</span><br><span class="line">			    &lt;li&gt;&lt;%= data.supplies[i] %&gt;&lt;/li&gt;</span><br><span class="line">			  &lt;% &#125; %&gt;</span><br><span class="line">			&lt;/ul&gt;</span><br><span class="line">			`;</span><br><span class="line">			this.templateCompiled = this.compile(this.template);</span><br><span class="line"></span><br><span class="line">			// eval 中的代码会定义一个函数，并返回这个函数的引用</span><br><span class="line">			var parse = eval(this.templateCompiled);</span><br><span class="line"></span><br><span class="line">			// 调用函数完成拼接</span><br><span class="line">			this.templateOutput = parse(&#123; supplies: [ "broom", "mop", "cleaner" ] &#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;h3&gt;模版&lt;/h3&gt;</span><br><span class="line">	&lt;code&gt;&#123;&#123;template&#125;&#125;&lt;/code&gt;</span><br><span class="line">	&lt;h3&gt;编译后的模版&lt;/h3&gt;</span><br><span class="line">	&lt;code&gt;&#123;&#123;templateCompiled&#125;&#125;&lt;/code&gt;</span><br><span class="line">	&lt;h3&gt;灌入数据的模版&lt;/h3&gt;</span><br><span class="line">	&lt;code&gt;&#123;&#123;templateOutput&#125;&#125;&lt;/code&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http://localhost:8080/#!/l04</span></span><br><span class="line">$ npm start</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1469070909258.png" alt="Alt text"></p>
<p>##4.12 标签模版</p>
<p><strong>说明：</strong>一种针对模版字符串的特殊函数调用。<br><strong>语法：</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">函数名<span class="string">`模<span class="subst">$&#123;表达式1&#125;</span>版字<span class="subst">$&#123;表达式2&#125;</span>串`</span>;</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line">* @param &#123;array like&#125; 第一个参数</span><br><span class="line">* @param &#123;...string&#125; 不定参数</span><br><span class="line">*/</span></span><br><span class="line">函数名([<span class="string">'模'</span>,<span class="string">'版'</span>,<span class="string">'字'</span>,<span class="string">'符'</span>,<span class="string">'串'</span>], 表达式<span class="number">1</span>返回值, 表达式<span class="number">2</span>返回值);</span><br></pre></td></tr></table></figure></p>
<p><strong>参数：</strong>调用函数传入的第一个参数有一个<code>row</code>属性，是一个和第一个参数本身内容相同的数组，不过元素中的所有<code>\</code>都被转义了，从而可以获得字符串的原始版本。<br><strong>用途：</strong>通过实现相应的处理模版字符串的函数，<code>标签模版</code>常用于</p>
<ul>
<li>处理<code>HTML</code>字符串过滤</li>
<li>多语言转换（国际化处理）</li>
<li>为模版增加条件判断和循环处理等模版基础能力</li>
<li>嵌入其它语言</li>
</ul>
<p><em>l04_taggedTemplate.vue</em><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	export default &#123;</span><br><span class="line">		data () &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				template: "Hello $&#123; a + b &#125; world $&#123; a * b&#125;",</span><br><span class="line">				templateOutput: ''</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			/**</span><br><span class="line">			 * 将各个参数按照原来的位置拼合回去(写法1)</span><br><span class="line">			 * @param  &#123;array&#125; literals 被插入的表达式隔开的字符串组成的数组</span><br><span class="line">			 * @return &#123;string&#125;     各个参数按照原来的位置拼合的字符串     </span><br><span class="line">			 */</span><br><span class="line">			passthru1: function (literals) &#123;</span><br><span class="line">				var result = ''</span><br><span class="line">				var i = 0</span><br><span class="line">				while (i &lt; literals.length) &#123;</span><br><span class="line">					// 拼接单纯的字符串</span><br><span class="line">					result += literals[i++]</span><br><span class="line"></span><br><span class="line">					// 拼接插入的表达式运算结果</span><br><span class="line">					if (i &lt; arguments.length) &#123;</span><br><span class="line">						result += arguments[i]</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				return result;</span><br><span class="line">			&#125;,</span><br><span class="line">			/**</span><br><span class="line">			 * 将各个参数按照原来的位置拼合回去(写法2)</span><br><span class="line">			 * @param  &#123;array&#125;    literals 被插入的表达式隔开的字符串组成的数组</span><br><span class="line">			 * @param  &#123;...array&#125; values   插入的所有表达式结果（从左到右摘出来）</span><br><span class="line">			 * @return &#123;string&#125;     各个参数按照原来的位置拼合的字符串 </span><br><span class="line">			 */</span><br><span class="line">			passthru2: function (literals, ...values) &#123;</span><br><span class="line">				var output = ''</span><br><span class="line">				for (var index = 0; index &lt; values.length; index++) &#123;</span><br><span class="line">					output +=literals[index] + values[index]</span><br><span class="line">				&#125;</span><br><span class="line">				// 被插入的表达式隔开的字符串组成的数组 比 插入的所有表达式结果长度大1</span><br><span class="line">				output += literals[index]</span><br><span class="line"></span><br><span class="line">				return output</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		ready: function () &#123;</span><br><span class="line">			let a = 2</span><br><span class="line">			let b = 4</span><br><span class="line">			this.templateOutput = this.passthru2`Hello $&#123; a + b &#125; world $&#123; a * b&#125;`</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;p&gt;运行&lt;/p&gt;</span><br><span class="line">	&lt;code&gt;passthru`&#123;&#123;template&#125;&#125;`&lt;/code&gt;</span><br><span class="line">	&lt;p&gt;输出&lt;/p&gt;</span><br><span class="line">	&lt;code&gt;&#123;&#123;templateOutput&#125;&#125;&lt;/code&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p>
<p>##4.13 String.raw()</p>
<p><strong>用途：</strong>两种使用方式</p>
<ul>
<li>作为模版标签使用</li>
<li>作为普通函数调用<figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span><br><span class="line">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">		data () &#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;</span><br><span class="line">				hiHuanhang: <span class="string">''</span>,</span><br><span class="line">				hiUtf16: <span class="string">''</span>,</span><br><span class="line">				test1: <span class="string">''</span>,</span><br><span class="line">				test2: <span class="string">''</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 自己视线一个 String.raw</span><br><span class="line">			 * @param  &#123;array&#125;    strings 被插入的表达式隔开的字符串组成的类数组,需要有raw属性</span><br><span class="line">			 * @param  &#123;...string&#125; value   插入的表达式返回值</span><br><span class="line">			 * @return &#123;string&#125;            转义后的字符串</span><br><span class="line">			 */</span></span><br><span class="line">			myRaw: <span class="function"><span class="keyword">function</span> (<span class="params">strings, ...value</span>) </span>&#123;</span><br><span class="line">				<span class="keyword">var</span> output = <span class="string">''</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; values.length; index++) &#123;</span><br><span class="line">					output += strings.raw[index] + values[index];</span><br><span class="line">				&#125;</span><br><span class="line">				output += strings.raw[index];</span><br><span class="line">				<span class="keyword">return</span> output;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		ready: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* 用法1:当作模版标签使用 */</span></span><br><span class="line">			<span class="keyword">this</span>.hiHuanhang = <span class="built_in">String</span>.raw<span class="string">`Hi\n<span class="subst">$&#123;2+3&#125;</span>!`</span>;</span><br><span class="line">			<span class="comment">// "Hi\\n5!"</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">this</span>.hiUtf16 = <span class="built_in">String</span>.raw<span class="string">`Hi\u000A!`</span>;</span><br><span class="line">			<span class="comment">// 'Hi\\u000A!'</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">/* 用法2:当作普通函数调用 */</span></span><br><span class="line">			<span class="keyword">this</span>.test1 = <span class="built_in">String</span>.raw(&#123; raw: <span class="string">'test'</span> &#125;, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">			<span class="comment">// 't0e1s2t'</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// 等同于</span></span><br><span class="line">			<span class="keyword">this</span>.test2 = <span class="built_in">String</span>.raw(&#123; raw: [<span class="string">'t'</span>,<span class="string">'e'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>] &#125;, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>转换换行符<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;hiHuanhang&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>转换utf-16表示方式<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;hiUtf16&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>当做普通函数调用<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;test2&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_5 正则的扩展/" itemprop="url">
                  5 正则的扩展(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:01:35+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_5 正则的扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_5 正则的扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="5-1-RegExp构造函数"><a href="#5-1-RegExp构造函数" class="headerlink" title="5.1 RegExp构造函数"></a>5.1 RegExp构造函数</h2><p>与es5相比，es6<code>RegExp</code>函数支持第一个参数为正则表达式的同时，还能设置第二个参数，第二个参数设置的正则修饰符将会覆盖第一个参数中的正则修饰符<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 构造器方式 */</span></span><br><span class="line"><span class="keyword">let</span> r1 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'xzy'</span>, <span class="string">'i'</span>)<span class="comment">// 方式1(es5/es6): 第一个参数为字符串</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r2 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/xyz/i</span>)<span class="comment">// 方式2(es5/es6): 第一个参数为正则表达式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r3 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/xyz/ig</span>, <span class="string">'i'</span>)<span class="comment">//  方式3(es5/es6):第一个参数为正则表达式，且支持第二个参数设置正则表达式修饰符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 正则对象(es5/es6) */</span></span><br><span class="line"><span class="keyword">let</span> r4 = <span class="regexp">/xyz/i</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-2-字符串的正则方法"><a href="#5-2-字符串的正则方法" class="headerlink" title="5.2 字符串的正则方法"></a>5.2 字符串的正则方法</h2><p>在<code>es6</code>中，字符串的四个与正则相关的方法全部会调用<code>RegExp</code>对象定义的相应方法</p>
<table>
<thead>
<tr>
<th>字符串实例方法</th>
<th>被调用的<code>RegExp</code>的方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>String.prototype.<code>match</code></td>
<td>RegExp.prototype[Symbol.<code>match</code>]</td>
</tr>
<tr>
<td>String.prototype.<code>replace</code></td>
<td>RegExp.prototype[Symbol.<code>replace</code>]</td>
</tr>
<tr>
<td>String.prototype.<code>search</code></td>
<td>RegExp.prototype[Symbol.<code>search</code>]</td>
</tr>
<tr>
<td>String.prototype.<code>split</code></td>
<td>RegExp.prototype[Symbol.<code>split</code>]</td>
</tr>
</tbody>
</table>
<h2 id="5-3-u修饰符"><a href="#5-3-u修饰符" class="headerlink" title="5.3 u修饰符"></a>5.3 u修饰符</h2><table>
<thead>
<tr>
<th>比较点</th>
<th>场景</th>
<th>不带u修饰符</th>
<th>带u修饰符</th>
</tr>
</thead>
<tbody>
<tr>
<td>点字符(<code>.</code>)</td>
<td>(字符串中)当匹配目标码点 0xFFFF</td>
<td>无法匹配</td>
<td>正确匹配</td>
</tr>
<tr>
<td>Unicode字符表示法（<code>\u{}</code>）</td>
<td></td>
<td>当做正则量词</td>
<td>正确识别</td>
</tr>
<tr>
<td>量词（<code>{}</code>）</td>
<td>(正则表达式中)跟在码点大于<code>0xFFFF</code>的字符后面</td>
<td>无法识别</td>
<td>正确识别为量词</td>
</tr>
<tr>
<td>预定义模式</td>
<td>(字符串中)当匹配目标码点 0xFFFF</td>
<td>无法匹配</td>
<td>正确匹配</td>
</tr>
<tr>
<td><code>i</code>修饰符</td>
<td>(字符串中)当匹配目标为非规范的字符</td>
<td>无法匹配</td>
<td>正确匹配</td>
</tr>
</tbody>
</table>
<h2 id="5-4-y修饰符"><a href="#5-4-y修饰符" class="headerlink" title="5.4 y修饰符"></a>5.4 y修饰符</h2><p><strong>粘连（sticky）修饰符：</strong>类似<code>g</code>修饰符，会进行全文匹配，区别在于</p>
<ul>
<li><code>g</code>修饰符每次都从<code>lastIndex</code>属性开始，从这个位置开始往后搜索，发现匹配为止</li>
<li><code>y</code>修饰符每次也从<code>lastIndex</code>属性开始，从这个位置开始往后搜索，但要求在<code>lastIndex</code>指定的位置就发现匹配，否则返回 <code>null</code></li>
</ul>
<h3 id="5-4-1-和-g-修饰符的区别"><a href="#5-4-1-和-g-修饰符的区别" class="headerlink" title="5.4.1 和 g 修饰符的区别"></a>5.4.1 和 g 修饰符的区别</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="string">'aaa_aa_a'</span></span><br><span class="line"><span class="keyword">const</span> rg = <span class="regexp">/a+/g</span></span><br><span class="line"><span class="keyword">const</span> ry = <span class="regexp">/a+/y</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result</span><br><span class="line"><span class="comment">/* g 修饰符 */</span></span><br><span class="line"><span class="built_in">console</span>.log(rg.exec(s))<span class="comment">// ["aaa", index: 0, input: "aaa_aa_a"]</span></span><br><span class="line"><span class="built_in">console</span>.log(rg.exec(s))<span class="comment">// ["aa", index: 4, input: "aaa_aa_a"]</span></span><br><span class="line"><span class="built_in">console</span>.log(rg.exec(s))<span class="comment">// ["a", index: 7, input: "aaa_aa_a"]</span></span><br><span class="line"><span class="built_in">console</span>.log(rg.exec(s))<span class="comment">// null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* y 修饰符 */</span></span><br><span class="line"><span class="built_in">console</span>.log(ry.exec(s))<span class="comment">// ["aaa", index: 0, input: "aaa_aa_a"]</span></span><br><span class="line"><span class="built_in">console</span>.log(ry.exec(s))</span><br></pre></td></tr></table></figure>
<h3 id="5-4-2-从字符串提取-tokeb-词元"><a href="#5-4-2-从字符串提取-tokeb-词元" class="headerlink" title="5.4.2 从字符串提取 tokeb (词元)"></a>5.4.2 从字符串提取 tokeb (词元)</h3><p><strong>说明：</strong>根据<code>y</code>修饰符<code>粘连</code>的特性，可以利用这一点敏感地识别到提取词元过程中是否有异常字符出现。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	methods: &#123;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 逐个取出字符串中的词元</span><br><span class="line">		 * @param  &#123;RegExp&#125; TOKEN_REGEX 正则实例</span><br><span class="line">		 * @param  &#123;String&#125; str 目标字符串</span><br><span class="line">		 * @return &#123;Array&#125; 词元数组  </span><br><span class="line">		 */</span></span><br><span class="line">		tokenize (TOKEN_REGEX, str) &#123;</span><br><span class="line">			<span class="keyword">let</span> result = []</span><br><span class="line">			<span class="keyword">let</span> match</span><br><span class="line">			<span class="keyword">while</span> (match = TOKEN_REGEX.exec(str)) &#123;</span><br><span class="line">				result.push(match[<span class="number">1</span>])</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> result</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	ready: <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="comment">/** 从字符串提取 tokeb (词元)  */</span></span><br><span class="line">		<span class="comment">/* g 修饰符 */</span></span><br><span class="line">		<span class="keyword">const</span> TOKEN_G = <span class="regexp">/\s*(\+|[0-9]+)\s*/g</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.tokenize(TOKEN_G, <span class="string">'3 + 4'</span>))<span class="comment">// ["3", "+", "4"]</span></span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.tokenize(TOKEN_G, <span class="string">'3x + 4'</span>))<span class="comment">// ["3", "+", "4"]</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">/* y 修饰符 */</span></span><br><span class="line">		<span class="keyword">const</span> TOKEN_Y = <span class="regexp">/\s*(\+|[0-9]+)\s*/y</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.tokenize(TOKEN_Y, <span class="string">'3 + 4'</span>))<span class="comment">// ["3", "+", "4"]</span></span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.tokenize(TOKEN_Y, <span class="string">'3x + 4'</span>))<span class="comment">// ["3"]</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-5-sticky属性"><a href="#5-5-sticky属性" class="headerlink" title="5.5 sticky属性"></a>5.5 sticky属性</h2><p><code>RegExp.prototype.sticky</code>：是否设置了<code>y</code>修饰符<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> r = <span class="regexp">/hello\d/y</span></span><br><span class="line">r.sticky <span class="comment">// true</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-6-flags属性"><a href="#5-6-flags属性" class="headerlink" title="5.6 flags属性"></a>5.6 flags属性</h2><p><code>RegExp.prototype.flags</code>：返回正则表达式的修饰符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES5的source属性</span></span><br><span class="line"><span class="comment">// 返回正则表达式的正文</span></span><br><span class="line">/abc/ig.source</span><br><span class="line"><span class="comment">// "abc"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的flags属性</span></span><br><span class="line"><span class="comment">// 返回正则表达式的修饰符</span></span><br><span class="line">/abc/ig.flags</span><br><span class="line"><span class="comment">// 'gi'</span></span><br></pre></td></tr></table></figure>
<h2 id="5-7-RegExp-escape"><a href="#5-7-RegExp-escape" class="headerlink" title="5.7 RegExp.escape()"></a>5.7 RegExp.escape()</h2><p><strong>功能：</strong>将字符串中有特殊正则含义的字符转义掉<br><strong>注意：</strong>曾被建议加入<code>ES7</code>，由于安全风险没被采纳</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原始字符串</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">'hello. how are you?'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// escape 处理后的字符串</span></span><br><span class="line"><span class="keyword">const</span> regStr = <span class="keyword">this</span>.escapeRegExp(str)<span class="comment">// hello\. how are you\?</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 escape 处理后的字符串构建正则实例</span></span><br><span class="line"><span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(regStr, <span class="string">'g'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="5-8-后行断言"><a href="#5-8-后行断言" class="headerlink" title="5.8 后行断言"></a>5.8 后行断言</h2><p>提案阶段，在<code>ES7</code>中加入。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Sean" />
          <p class="site-author-name" itemprop="name">Sean</p>
          <p class="site-description motion-element" itemprop="description">整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">98</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sean</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"lapuda-er"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  

</body>
</html>
