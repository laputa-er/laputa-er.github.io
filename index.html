<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...">
<meta property="og:type" content="website">
<meta property="og:title" content="Sean">
<meta property="og:url" content="http://laputa-er.github.io/index.html">
<meta property="og:site_name" content="Sean">
<meta property="og:description" content="整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sean">
<meta name="twitter:description" content="整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://laputa-er.github.io/"/>

  <title> Sean </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Sean</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">笔记分享</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_6 数值的扩展/" itemprop="url">
                  6 数值的扩展(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:37:28+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_6 数值的扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_6 数值的扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="6-1-二进制和八进制表示法"><a href="#6-1-二进制和八进制表示法" class="headerlink" title="6.1 二进制和八进制表示法"></a>6.1 二进制和八进制表示法</h2><table>
<thead>
<tr>
<th>进制</th>
<th>前缀</th>
<th>支持情况</th>
</tr>
</thead>
<tbody>
<tr>
<td>二进制</td>
<td>0b(0B)</td>
<td>>=es6</td>
</tr>
<tr>
<td>八进制</td>
<td>0o(0O)</td>
<td>>=es6</td>
</tr>
<tr>
<td>八进制</td>
<td>0</td>
<td>es5(非严格模式)</td>
</tr>
<tr>
<td>十六进制</td>
<td>0x(0X)</td>
<td>>=es5</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 Number 将二进制和八进制字符串转为 10 进制</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="string">'ob111'</span>)<span class="comment">// 7</span></span><br></pre></td></tr></table></figure>
<h2 id="6-2-Number-isFinite-Number-isNaN"><a href="#6-2-Number-isFinite-Number-isNaN" class="headerlink" title="6.2 Number.isFinite(), Number.isNaN()"></a>6.2 Number.isFinite(), Number.isNaN()</h2><h3 id="6-2-1-基础"><a href="#6-2-1-基础" class="headerlink" title="6.2.1 基础"></a>6.2.1 基础</h3><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
<th>参数为非数字时</th>
<th>兼容性</th>
</tr>
</thead>
<tbody>
<tr>
<td>isFinate</td>
<td>检查是否非无穷</td>
<td>通过 Number 转为数字，再判断</td>
<td>>=es3</td>
</tr>
<tr>
<td>isNaN</td>
<td>检查是否非数字</td>
<td>通过 Number 转为数字，再判断</td>
<td>>=es3</td>
</tr>
<tr>
<td>Number.isFinate</td>
<td>检查是否非无穷</td>
<td>返回 false</td>
<td>>=es6</td>
</tr>
<tr>
<td>Number.isNaN</td>
<td>检查是否非数字</td>
<td>返回 false</td>
<td>>=es7</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Number</span>.isFinite(<span class="number">15</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="number">0.8</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">NaN</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">Infinity</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(-<span class="literal">Infinity</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="string">'foo'</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="string">'15'</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">true</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="number">15</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'15'</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">true</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="number">9</span>/<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'true'</span>/<span class="number">0</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'true'</span>/<span class="string">'true'</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="number">25</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="string">"25"</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="number">25</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isFinite(<span class="string">"25"</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="string">"NaN"</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isNaN(<span class="string">"NaN"</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="6-2-2-es5环境下的polyfill"><a href="#6-2-2-es5环境下的polyfill" class="headerlink" title="6.2.2 es5环境下的polyfill"></a>6.2.2 es5环境下的polyfill</h3><p>借助传统的 <code>isNaN</code>和<code>isFinate</code>来实现自定义的<code>Number.isNaN</code>和<code>Number.isFinate</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> global_isFinite = global.isFinite</span><br><span class="line">	<span class="keyword">const</span> global_isNaN = global.isNaN</span><br><span class="line">	<span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isFinite'</span>, &#123;</span><br><span class="line">		value: <span class="function"><span class="keyword">function</span> <span class="title">isFinite</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; global_isFinite(value)</span><br><span class="line">		&#125;,</span><br><span class="line">		configurable: <span class="literal">true</span>,</span><br><span class="line">		enumerable: <span class="literal">false</span>,</span><br><span class="line">		writable: <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isNaN'</span>, &#123;</span><br><span class="line">		value: <span class="function"><span class="keyword">function</span> <span class="title">isNaN</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; global_isNaN(value)</span><br><span class="line">		&#125;,</span><br><span class="line">		configurable: <span class="literal">true</span>,</span><br><span class="line">		enumerable: <span class="literal">false</span>,</span><br><span class="line">		writable: <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)(<span class="built_in">window</span>);</span><br></pre></td></tr></table></figure>
<h2 id="6-3-Number-parseInt-Number-parseFloat"><a href="#6-3-Number-parseInt-Number-parseFloat" class="headerlink" title="6.3 Number.parseInt(), Number.parseFloat()"></a>6.3 Number.parseInt(), Number.parseFloat()</h2><p>ES6将<code>parseInt()</code>和<code>parseFloat()</code>移植到 <code>Number</code>对象上面。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES5的写法</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'12.34'</span>) <span class="comment">// 12</span></span><br><span class="line"><span class="built_in">parseFloat</span>(<span class="string">'123.45#'</span>) <span class="comment">// 123.45</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的写法</span></span><br><span class="line"><span class="built_in">Number</span>.parseInt(<span class="string">'12.34'</span>) <span class="comment">// 12</span></span><br><span class="line"><span class="built_in">Number</span>.parseFloat(<span class="string">'123.45#'</span>) <span class="comment">// 123.45</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>.parseInt === <span class="built_in">parseInt</span> <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.parseFloat === <span class="built_in">parseFloat</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p> 这样处理的目的是逐步减少全局性方法，使得语言逐步模块化。</p>
<h2 id="6-4-Number-isInteger"><a href="#6-4-Number-isInteger" class="headerlink" title="6.4 Number.isInteger()"></a>6.4 Number.isInteger()</h2><p><strong>功能：</strong>用来判断一个值是否为整数<br><strong>注意：</strong>整数和浮点数存储方式是一样的，3和3.0都会被认为是整数</p>
<h4 id="6-4-1-基础"><a href="#6-4-1-基础" class="headerlink" title="6.4.1 基础"></a>6.4.1 基础</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25.0</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25.1</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isInteger(<span class="string">"15"</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isInteger(<span class="literal">true</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="6-4-2-es5环境下的-polyfill"><a href="#6-4-2-es5环境下的-polyfill" class="headerlink" title="6.4.2 es5环境下的 polyfill"></a>6.4.2 es5环境下的 polyfill</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">const</span> floor = <span class="built_in">Math</span>.floor,</span><br><span class="line">		<span class="built_in">isFinite</span> = global.isFinite;</span><br><span class="line">	<span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isInteger'</span>, &#123;</span><br><span class="line">		value: <span class="function"><span class="keyword">function</span> <span class="title">isInteger</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; <span class="built_in">isFinite</span>(value) &amp;&amp; value &gt; <span class="number">-9007199254740992</span> &amp;&amp; value &lt; <span class="number">9007199254740992</span> &amp;&amp; floor(value) === value;</span><br><span class="line">		&#125;,</span><br><span class="line">		configurable: <span class="literal">true</span>,</span><br><span class="line">		enumerable: <span class="literal">false</span>,</span><br><span class="line">		writable: <span class="literal">true</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)(<span class="built_in">window</span>)</span><br></pre></td></tr></table></figure>
<h2 id="6-5-Number-EPSILON"><a href="#6-5-Number-EPSILON" class="headerlink" title="6.5 Number.EPSILON"></a>6.5 Number.EPSILON</h2><p><strong>说明：</strong>一个极小的常量<code>2.220446049250313e-16</code><br><strong>用途：</strong>可以在浮点数计算中作为误差范围使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">withinErrorMargin</span> <span class="params">(left, right)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Math.abs(left - right) &lt; Number.EPSILON;</span><br><span class="line">&#125;</span><br><span class="line">withinErrorMargin(<span class="number">0.1</span> + <span class="number">0.2</span>, <span class="number">0.3</span>)</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">withinErrorMargin(<span class="number">0.2</span> + <span class="number">0.2</span>, <span class="number">0.3</span>)</span><br><span class="line"><span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h2 id="6-6-安全整数和-Number-isSafeInteger"><a href="#6-6-安全整数和-Number-isSafeInteger" class="headerlink" title="6.6 安全整数和 Number.isSafeInteger()"></a>6.6 安全整数和 Number.isSafeInteger()</h2><table>
<thead>
<tr>
<th>常量(ES6提供)</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Number.MAX_SAFE_INTEGER</code></td>
<td>JS支持的整数上限（9007199254740991）</td>
</tr>
<tr>
<td><code>Number.MIN_SAFE_INTEGER</code></td>
<td>JS支持的整数下限（-9007199254740991）</td>
</tr>
</tbody>
</table>
<h3 id="6-6-1-Number-isSafeInteger"><a href="#6-6-1-Number-isSafeInteger" class="headerlink" title="6.6.1 Number.isSafeInteger()"></a>6.6.1 Number.isSafeInteger()</h3><p> <strong>功能：</strong>判断一个整数是否落在这个<code>JS</code>能够支持的范围之内<br> <strong>技巧：</strong>验证运算结果是否落在安全整数的范围內，不要只验证运算结果，而要同时验证参与运算的每个值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="string">'a'</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">null</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">NaN</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">Infinity</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(-<span class="literal">Infinity</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">3</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">1.2</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">9007199254740990</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">9007199254740992</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MIN_SAFE_INTEGER - <span class="number">1</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MIN_SAFE_INTEGER) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MAX_SAFE_INTEGER) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MAX_SAFE_INTEGER + <span class="number">1</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">* 检验 操作数 和 操作结果 的是否为安全整数，以确保运算过程正确</span><br><span class="line">* @param  &#123;number&#125; left   左操作数</span><br><span class="line">* @param  &#123;number&#125; right  右操作数</span><br><span class="line">* @param  &#123;number&#125; result 结果</span><br><span class="line">* @return &#123;number&#125; 结果</span><br><span class="line">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trusty</span> (<span class="params">left, right, result</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (</span><br><span class="line">		<span class="built_in">Number</span>.isSafeInteger(left) &amp;&amp;</span><br><span class="line">		<span class="built_in">Number</span>.isSafeInteger(right) &amp;&amp; </span><br><span class="line">		<span class="built_in">Number</span>.isSafeInteger(result)</span><br><span class="line">		) &#123;</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RangeError</span>(<span class="string">'Operation cannot be trusted!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">trusty(<span class="number">9007199254740993</span>, <span class="number">990</span>, <span class="number">9007199254740993</span> - <span class="number">990</span>)<span class="comment">// RangeError: Operation cannot be trusted!</span></span><br><span class="line">trusty(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)<span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<h3 id="6-6-2-es5-环境下的-polyfill"><a href="#6-6-2-es5-环境下的-polyfill" class="headerlink" title="6.6.2 es5 环境下的 polyfill"></a>6.6.2 es5 环境下的 polyfill</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">* es5 环境下的 polyfill</span><br><span class="line">*/</span></span><br><span class="line"><span class="built_in">Number</span>.isSafeInteger = <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (<span class="keyword">typeof</span> n === <span class="string">'number'</span></span><br><span class="line">			&amp;&amp; <span class="built_in">Math</span>.round(n) === n</span><br><span class="line">			&amp;&amp; <span class="built_in">Number</span>.MIN_SAFE_INTEGER &lt;= n</span><br><span class="line">			&amp;&amp; n &lt;= <span class="built_in">Number</span>.MAX_SAFE_INTEGER);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="6-7-Math-对象的扩展"><a href="#6-7-Math-对象的扩展" class="headerlink" title="6.7 Math 对象的扩展"></a>6.7 Math 对象的扩展</h2><p>es6在 Math 对象上新增了17个与数学相关的静态方法</p>
<h3 id="6-7-1-常用（7个）"><a href="#6-7-1-常用（7个）" class="headerlink" title="6.7.1 常用（7个）"></a>6.7.1 常用（7个）</h3><table>
<thead>
<tr>
<th>静态方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Math.truc</td>
<td>去除一个数的小数部分</td>
</tr>
<tr>
<td>Math.sign</td>
<td>判断一个数到底是正数、负数、还是零</td>
</tr>
<tr>
<td>Math.cbrt</td>
<td>计算一个数的立方根</td>
</tr>
<tr>
<td>Math.clz32</td>
<td>返回一个数的32位无符号整数形式有多少个前导0</td>
</tr>
<tr>
<td>Math.imul</td>
<td>返回两个数以32位带符号整数形式相乘的结果</td>
</tr>
<tr>
<td>Math.fround</td>
<td>返回一个数的单精度浮点数形式</td>
</tr>
<tr>
<td>Math.hypot</td>
<td>返回所有参数的平方和的平方根</td>
</tr>
</tbody>
</table>
<h3 id="6-7-2-对数方法（4个）"><a href="#6-7-2-对数方法（4个）" class="headerlink" title="6.7.2 对数方法（4个）"></a>6.7.2 对数方法（4个）</h3><table>
<thead>
<tr>
<th>静态方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Math.expm1</td>
<td>返回e^x - 1. 即<code>Math.exp(x) - 1</code></td>
</tr>
<tr>
<td>Math.log1p</td>
<td>返回 1 + x 的自然对数，即<code>Math.log(1 + x)</code></td>
</tr>
<tr>
<td>Math.log10</td>
<td>返回 以10为底的 x 的对数</td>
</tr>
<tr>
<td>Math.log2</td>
<td>返回 以2为底的 x 的对数</td>
</tr>
</tbody>
</table>
<h3 id="6-7-3-三角函数方法（6个）"><a href="#6-7-3-三角函数方法（6个）" class="headerlink" title="6.7.3 三角函数方法（6个）"></a>6.7.3 三角函数方法（6个）</h3><table>
<thead>
<tr>
<th>静态方法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Math.sinh(x)</td>
<td>返回 x 的双曲正弦</td>
</tr>
<tr>
<td>Math.cosh(x)</td>
<td>返回 x 的双曲余弦</td>
</tr>
<tr>
<td>Math.tanh(x)</td>
<td>返回 x 的双曲正切</td>
</tr>
<tr>
<td>Math.asinh(x)</td>
<td>返回 x 的反双曲正弦</td>
</tr>
<tr>
<td>Math.aconsh(x)</td>
<td>返回 x 的反双曲余弦</td>
</tr>
<tr>
<td>Math.atanh(x)</td>
<td>返回 x 的反双曲正切</td>
</tr>
</tbody>
</table>
<h2 id="6-8-指数运算符"><a href="#6-8-指数运算符" class="headerlink" title="6.8 指数运算符"></a>6.8 指数运算符</h2><table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>**</code></td>
<td>指数运算符</td>
</tr>
<tr>
<td><code>**=</code></td>
<td>指数运算和等号结合</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> ** <span class="number">2</span><span class="comment">// 4</span></span><br><span class="line"><span class="number">2</span> ** <span class="number">3</span><span class="comment">// 8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">2</span>;</span><br><span class="line">a **= <span class="number">2</span>;<span class="comment">// 等同于 a = a * a</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">3</span>;</span><br><span class="line">b **= <span class="number">3</span>;<span class="comment">// 等同于 b = b * b * b;</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_1 ECMAScript 6 简介/" itemprop="url">
                  1 ECMAScript 6 简介(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:02:44+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_1 ECMAScript 6 简介/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_1 ECMAScript 6 简介/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-ECMAScript和JavaScript的关系"><a href="#1-ECMAScript和JavaScript的关系" class="headerlink" title="1 ECMAScript和JavaScript的关系"></a>1 ECMAScript和JavaScript的关系</h1><h1 id="2-ECMAScript的历史"><a href="#2-ECMAScript的历史" class="headerlink" title="2 ECMAScript的历史"></a>2 ECMAScript的历史</h1><h1 id="3-部署进度"><a href="#3-部署进度" class="headerlink" title="3 部署进度"></a>3 部署进度</h1><h2 id="3-1-浏览器兼容性"><a href="#3-1-浏览器兼容性" class="headerlink" title="3.1 浏览器兼容性"></a>3.1 浏览器兼容性</h2><p>各大浏览器对 <code>ES6</code>的支持情况：<a href="http://kangax.github.io/compat-table/es6/" target="_blank" rel="external">http://kangax.github.io/compat-table/es6/</a></p>
<h2 id="3-2-ES6环境搭建"><a href="#3-2-ES6环境搭建" class="headerlink" title="3.2 ES6环境搭建"></a>3.2 ES6环境搭建</h2><h3 id="3-2-1-NPM"><a href="#3-2-1-NPM" class="headerlink" title="3.2.1 NPM"></a>3.2.1 NPM</h3><p>Github：<a href="https://github.com/creationix/nvm" target="_blank" rel="external">https://github.com/creationix/nvm</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 nvm（安装后需要重启 Terminal）</span></span><br><span class="line">$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.1/install.sh | bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 激活 nvm</span></span><br><span class="line">$ <span class="built_in">source</span> ~/.nvm/nvm.sh </span><br><span class="line"></span><br><span class="line"><span class="comment"># 列举所有可安装的版本</span></span><br><span class="line">$ nvm ls-remote</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 v6.2.2（目前最新版），`nvm install node`默认也是最新版</span></span><br><span class="line">$ nvm install v6.2.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换为 v6.2.2 版本</span></span><br><span class="line">$ nvm use v6.2.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前 node 实现的 ES6特性</span></span><br><span class="line">$ node --v8-options | grep harmony</span><br></pre></td></tr></table></figure>
<h3 id="3-2-2-查看环境对-ES6-的支持度"><a href="#3-2-2-查看环境对-ES6-的支持度" class="headerlink" title="3.2.2 查看环境对 ES6 的支持度"></a>3.2.2 查看环境对 ES6 的支持度</h3><p><strong>浏览器环境</strong>：直接访问<a href="http://ruanyf.github.io/es-checker/" target="_blank" rel="external">http://ruanyf.github.io/es-checker/</a></p>
<p><strong>node环境</strong>：安装<code>ES-Checker</code>的 node版<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g es-checker</span><br><span class="line">$ es-checker</span><br></pre></td></tr></table></figure></p>
<h1 id="4-Babel转码器"><a href="#4-Babel转码器" class="headerlink" title="4 Babel转码器"></a>4 Babel转码器</h1><h2 id="4-1-安装转码器"><a href="#4-1-安装转码器" class="headerlink" title="4.1 安装转码器"></a>4.1 安装转码器</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save-dev babel-preset-es2015</span><br><span class="line">$ npm install --save-dev babel-preset-react</span><br><span class="line">$ npm install --save-dev babel-preset-stage-3</span><br></pre></td></tr></table></figure>
<h2 id="4-2-配置转码规则"><a href="#4-2-配置转码规则" class="headerlink" title="4.2 配置转码规则"></a>4.2 配置转码规则</h2><p> <strong>注意：</strong>所有<code>Babel</code>工具和模块都依赖<code>.babelrc</code>配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在项目根目录编写 babel 配置文件</span></span><br><span class="line">$ vim .babelrc</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">"presets"</span>: [</span><br><span class="line">		<span class="string">"es2015"</span>,</span><br><span class="line">		<span class="string">"react"</span>,</span><br><span class="line">		<span class="string">"stage-3"</span></span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-3-命令行工具"><a href="#4-3-命令行工具" class="headerlink" title="4.3 命令行工具"></a>4.3 命令行工具</h2><h3 id="4-3-1-将-es6-脚本编译为-es5-版本"><a href="#4-3-1-将-es6-脚本编译为-es5-版本" class="headerlink" title="4.3.1 将 es6 脚本编译为 es5 版本"></a>4.3.1 将 es6 脚本编译为 es5 版本</h3><p><em>编译前(example.js)</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> input = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">input.map(item =&gt; item + <span class="number">1</span>);</span><br></pre></td></tr></table></figure></p>
<p><em>使用命令行工具编译</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ babel example.js</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> input = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">input.map(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item + <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="4-3-2-babel-node命令"><a href="#4-3-2-babel-node命令" class="headerlink" title="4.3.2 babel-node命令"></a>4.3.2 <code>babel-node</code>命令</h3><p> 类似<code>node</code>，存在两种模式：<code>REPL</code>和<code>直接运行文件</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入 REPL 模式</span></span><br><span class="line">$ babel-node</span><br><span class="line"> (x =&gt; x + 2)(1)</span><br><span class="line"> 3</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ babel-node example.js</span><br></pre></td></tr></table></figure>
<h3 id="4-3-3-babel-register模块"><a href="#4-3-3-babel-register模块" class="headerlink" title="4.3.3 babel-register模块"></a>4.3.3 <code>babel-register</code>模块</h3><p> <strong>说明：</strong>babel-register模块改写require命令，为它加上一个钩子。此后，每当使用require加载.js、.jsx、.es和.es6后缀名的文件，就会先用Babel进行转码。<br> <strong>注意：</strong>只适合开发环境中使用</p>
<ul>
<li>不属于<code>babel-cli</code>，需要单独安装</li>
<li>必需先加载<code>babel-register</code></li>
<li>支持的文件后缀 <code>.js</code> <code>jsx</code> <code>.es</code> <code>.es6</code></li>
</ul>
<p><em>index.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 先加载 babel-register，后面的才能自动转换</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">"babel-register"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">"./example.js"</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="4-3-4-babel-core"><a href="#4-3-4-babel-core" class="headerlink" title="4.3.4 babel-core"></a>4.3.4 <code>babel-core</code></h3><p>基本使用<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> babel = <span class="built_in">require</span>(<span class="string">'babel-core'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串转码</span></span><br><span class="line">babel.transform(<span class="string">'code();'</span>, options);</span><br><span class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件转码（异步）</span></span><br><span class="line">babel.transformFile(<span class="string">'filename.js'</span>, options, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">  result; <span class="comment">// =&gt; &#123; code, map, ast &#125;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件转码（同步）</span></span><br><span class="line">babel.transformFileSync(<span class="string">'filename.js'</span>, options);</span><br><span class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Babel AST转码</span></span><br><span class="line">babel.transformFromAst(ast, code, options);</span><br><span class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></span><br></pre></td></tr></table></figure></p>
<p>例子<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> es6Code = <span class="string">'let x = n =&gt; n + 1'</span>;</span><br><span class="line"><span class="keyword">var</span> es5Code = <span class="built_in">require</span>(<span class="string">'babel-core'</span>)</span><br><span class="line">  .transform(es6Code, &#123;</span><br><span class="line">    presets: [<span class="string">'es2015'</span>]</span><br><span class="line">  &#125;)</span><br><span class="line">  .code;</span><br></pre></td></tr></table></figure></p>
<h3 id="4-3-5-babel-polyfill"><a href="#4-3-5-babel-polyfill" class="headerlink" title="4.3.5 babel-polyfill"></a>4.3.5 <code>babel-polyfill</code></h3><p> <strong>说明：</strong><code>Babel</code>默认只转换新的<code>JavaScript</code>句法（syntax），而不转换新的<code>API</code>。除非使用<code>babel-polyfill</code>。<br> <strong>注意：</strong><code>Babel</code>默认不转码的<code>API</code>非常多，详细清单可以查看<code>babel-plugin-transform-runtime</code>。</p>
<p>安装到当前环境<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save babel-polyfill</span><br></pre></td></tr></table></figure></p>
<p>引入<code>babel-polyfill</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'babel-polyfill'</span>;</span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'babel-polyfill'</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="4-3-6-浏览器环境"><a href="#4-3-6-浏览器环境" class="headerlink" title="4.3.6 浏览器环境"></a>4.3.6 浏览器环境</h3><hr>
<h4 id="实时转换"><a href="#实时转换" class="headerlink" title="实时转换"></a>实时转换</h4><ol>
<li><p>获取<code>babel</code>的浏览器版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># node_modules/babel-core/browser.js</span></span><br><span class="line">$ npm install babel-core@5</span><br></pre></td></tr></table></figure>
</li>
<li><p>在页面中使用（需要注明<code>type=&quot;text/babel&quot;</code>）</p>
<figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/babel-core/browser.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/babel"</span>&gt;</span><span class="javascript"></span><br><span class="line">	<span class="keyword">let</span> input = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">	input.map(item =&gt; item + <span class="number">1</span>);</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h4 id="打包为生产环境的代码"><a href="#打包为生产环境的代码" class="headerlink" title="打包为生产环境的代码"></a>打包为生产环境的代码</h4><p> <strong>说明：</strong>配合<code>browserify</code>使用<br> <strong>注意：</strong>生产环境需要加载已经转码完成的脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ npm install browserify -g</span><br><span class="line">$ npm install --save-dev babelify babel-preset-es2015</span><br><span class="line"></span><br><span class="line">$ browserify es6.js -o bundle.js -t [ babelify --presets [ es2015 ] ]</span><br></pre></td></tr></table></figure>
<h3 id="4-3-7-在线转换"><a href="#4-3-7-在线转换" class="headerlink" title="4.3.7 在线转换"></a>4.3.7 在线转换</h3><p><a href="https://babeljs.io/repl/" target="_blank" rel="external">https://babeljs.io/repl/</a></p>
<h3 id="4-3-8-与其它工具的配合"><a href="#4-3-8-与其它工具的配合" class="headerlink" title="4.3.8 与其它工具的配合"></a>4.3.8 与其它工具的配合</h3><h4 id="4-3-8-1-ESLint"><a href="#4-3-8-1-ESLint" class="headerlink" title="4.3.8.1 ESLint"></a>4.3.8.1 ESLint</h4><p> 用于静态检查代码的语法和风格</p>
<ol>
<li><p>安装 ESLint</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save-dev eslint babel-eslint</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置<code>.eslintrc</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"parser"</span>: <span class="string">"babel-eslint"</span>,</span><br><span class="line">  <span class="string">"rules"</span>: &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置<code>.package.json</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"my-module"</span>,</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"lint"</span>: <span class="string">"eslint my-files.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"babel-eslint"</span>: <span class="string">"..."</span>,</span><br><span class="line">    <span class="string">"eslint"</span>: <span class="string">"..."</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="4-3-8-2-Mocha"><a href="#4-3-8-2-Mocha" class="headerlink" title="4.3.8.2 Mocha"></a>4.3.8.2 Mocha</h4><p> 一个测试框架，如果需要执行使用ES6语法的测试脚本，可以修改<code>package.json</code>的<code>scripts.test</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"test"</span>: <span class="string">"mocha --ui qunit --compilers js:babel-core/register"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="5-Traceur转码器"><a href="#5-Traceur转码器" class="headerlink" title="5 Traceur转码器"></a>5 Traceur转码器</h1><h1 id="6-ECMAScript-7"><a href="#6-ECMAScript-7" class="headerlink" title="6 ECMAScript 7"></a>6 ECMAScript 7</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_2 let和const命令/" itemprop="url">
                  2 let和const命令(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:02:11+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_2 let和const命令/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_2 let和const命令/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-let命令"><a href="#1-let命令" class="headerlink" title="1 let命令"></a>1 let命令</h1><p>用来声明变量</p>
<ol>
<li>只在声明时所在的<code>代码块</code>内有效</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a <span class="comment">// ReferenceError: a is not defined.</span></span><br><span class="line">b <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<ol>
<li>for循环</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [];</span><br><span class="line"><span class="comment">// 每一次循环的 i 其实都是一个新的变量</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  a[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line">a[<span class="number">6</span>](); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure>
<ol>
<li>不存在变量提升</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 变量一定要在声明后使用，否则报错。</span></span><br><span class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// 输出undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(bar); <span class="comment">// 报错ReferenceError</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">let</span> bar = <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<ol>
<li>暂时性死区<br><strong>说明：</strong>在代码块内，使用<code>let</code>命令声明变量之前，该变量都是不可用的。这在语法上，称为<code>暂时性死区（temporal dead zone，简称TDZ）</code>。<br><strong>注意：</strong><code>暂时性死区</code>也意味着<code>typeof</code>不再是一个百分之百安全的操作。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> x; <span class="comment">// ReferenceError</span></span><br><span class="line"><span class="keyword">let</span> x;</span><br></pre></td></tr></table></figure>
<ol>
<li>不允许重复声明<br><strong>说明：</strong><code>let</code>不允许在相同作用域内，重复声明同一个变量。<br><strong>注意：</strong>不能在函数内部重新用<code>let</code>声明参数</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> arg; <span class="comment">// 报错</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">let</span> arg; <span class="comment">// 不报错</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-块级作用域"><a href="#2-块级作用域" class="headerlink" title="2 块级作用域"></a>2 块级作用域</h1><p><strong>说明：</strong><code>let</code>实际上为JavaScript新增了块级作用域。<br><strong>注意：</strong>块级作用域的出现，实际上使得获得广泛应用的<code>立即执行匿名函数</code>（IIFE）不再必要了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IIFE写法</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> tmp = ...;</span><br><span class="line">  ...</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 块级作用域写法</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> tmp = ...;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-1-块级作用域与函数声明"><a href="#2-1-块级作用域与函数声明" class="headerlink" title="2.1 块级作用域与函数声明"></a>2.1 块级作用域与函数声明</h2><p><strong>说明：</strong>ES6引入了块级作用域，明确允许在块级作用域之中声明函数。<br><strong>注意：</strong>ES6的块级作用域允许声明函数的规则，只在使用<code>{}</code>的情况下成立，如果没有使用<code>{}</code>，就会报错<br>环境|在块级作用域中声明函数|声明提升<br>-|-|-<br>标准ES5环境|不可以|会<br>标准ES6环境|可以|不会<br>浏览器ES5环境|可以|会<br>浏览器ES6环境|可以|会</p>
<p><strong>技巧：</strong>考虑到环境导致的行为差异太大，应该避免在块级作用域内声明函数。如果确实需要，也应该写成函数表达式，而不是函数声明语句。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="comment">// 重复声明一次函数f</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  f();</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure></p>
<h1 id="3-const命令"><a href="#3-const命令" class="headerlink" title="3 const命令"></a>3 const命令</h1><p><strong>说明：</strong>const声明一个只读的常量<br><strong>注意：</strong>将一个对象声明为常量必须非常小心<br><strong>扩展：</strong>如果真的想将对象冻结，应该使用<code>Object.freeze</code>方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> constantize = (obj) =&#123;</span><br><span class="line">  <span class="built_in">Object</span>.freeze(obj);</span><br><span class="line">  <span class="built_in">Object</span>.keys(obj).forEach( (key, value) =&#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="keyword">typeof</span> obj[key] === <span class="string">'object'</span> ) &#123;</span><br><span class="line">      constantize( obj[key] );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>const一旦声明变量，就必须立即初始化，不能留到以后赋值</li>
<li>一旦声明，常量的值就不能改变</li>
<li>只在声明所在的块级作用域内有效（类似<code>let</code>）</li>
<li>不可以重复声明（类似<code>let</code>）</li>
<li>不会发生声明提升（类似<code>let</code>）</li>
<li>存在暂时性死区（类似<code>let</code>）</li>
<li><code>const</code>命令只是保证变量名指向的地址不变，并不保证该地址的数据不变<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PI = <span class="number">3.1415</span>;</span><br><span class="line">PI <span class="comment">// 3.1415</span></span><br><span class="line"></span><br><span class="line">PI = <span class="number">3</span>;</span><br><span class="line"><span class="comment">// TypeError: Assignment to constant variable.</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="4-全局对象的属性"><a href="#4-全局对象的属性" class="headerlink" title="4 全局对象的属性"></a>4 全局对象的属性</h1><p>未声明的全局变量，自动成为全局对象<code>window</code>的属性，这被认为是<code>JavaScript</code>语言最大的设计败笔之一，ES6改变了这一点：</p>
<ul>
<li><code>var</code>命令和<code>function</code>命令声明的全局变量，依旧是全局对象的属性</li>
<li><code>let</code>命令、<code>const</code>命令、<code>class</code>命令声明的全局变量，不属于全局对象的属性（从ES6开始，全局变量将逐步与全局对象的属性脱钩）</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="comment">// 如果在Node的REPL环境，可以写成global.a</span></span><br><span class="line"><span class="comment">// 或者采用通用方法，写成this.a</span></span><br><span class="line"><span class="built_in">window</span>.a <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">window</span>.b <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_3 变量的解构赋值/" itemprop="url">
                  3 变量的解构赋值(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:01:59+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_3 变量的解构赋值/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_3 变量的解构赋值/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>从数组和对象中提取值，对变量进行赋值，这被称为解构（Destructuring）</p>
<p>#1 数组的解构赋值</p>
<h2 id="1-1-基本使用"><a href="#1-1-基本使用" class="headerlink" title="1.1 基本使用"></a>1.1 基本使用</h2><h3 id="1-1-1-完全解构"><a href="#1-1-1-完全解构" class="headerlink" title="1.1.1 完全解构"></a>1.1.1 完全解构</h3><p><strong>条件：</strong>等号两边的模式相同<br><strong>描述：</strong>左边所有变量都被赋值，所有值都被提取出来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [foo, [[bar], baz]] = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]];</span><br><span class="line">foo <span class="comment">// 1</span></span><br><span class="line">bar <span class="comment">// 2</span></span><br><span class="line">baz <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [ , , third] = [<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>];</span><br><span class="line">third <span class="comment">// "baz"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x, , y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [head, ...tail] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">head <span class="comment">// 1</span></span><br><span class="line">tail <span class="comment">// [2, 3, 4]</span></span><br></pre></td></tr></table></figure>
<h3 id="1-1-2-不完全解构"><a href="#1-1-2-不完全解构" class="headerlink" title="1.1.2 不完全解构"></a>1.1.2 不完全解构</h3><p><strong>条件：</strong>即等号左边的模式，只匹配一部分的等号右边的数组<br><strong>描述：</strong>左边所有变量都被赋值，但没有提取出右边所有的值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [x, y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [a, [b], d] = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>];</span><br><span class="line">a <span class="comment">// 1</span></span><br><span class="line">b <span class="comment">// 2</span></span><br><span class="line">d <span class="comment">// 4</span></span><br></pre></td></tr></table></figure></p>
<h3 id="1-1-3-解构失败"><a href="#1-1-3-解构失败" class="headerlink" title="1.1.3 解构失败"></a>1.1.3 解构失败</h3><p><strong>描述：</strong>解构没有报错，但存在没被赋值的变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [x, y, ...z] = [<span class="string">'a'</span>];</span><br><span class="line">x <span class="comment">// "a"</span></span><br><span class="line">y <span class="comment">// undefined</span></span><br><span class="line">z <span class="comment">// []</span></span><br></pre></td></tr></table></figure>
<h3 id="1-1-4-报错"><a href="#1-1-4-报错" class="headerlink" title="1.1.4 报错"></a>1.1.4 报错</h3><p><strong>条件：</strong>等号的右边不是数组<br><strong>扩展：</strong>事实上，只要某种数据结构具有<code>Iterator</code>接口，都可以采用数组形式的解构赋值。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 转为对象以后不具备Iterator接口 */</span></span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="literal">NaN</span>;</span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">let</span> [foo] = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 本身就不具备Iterator接口 */</span></span><br><span class="line"><span class="keyword">let</span> [foo] = &#123;&#125;;</span><br></pre></td></tr></table></figure></p>
<p>##1.2 默认值</p>
<p>解构赋值允许指定默认值。</p>
<h3 id="1-2-1-默认值生效条件"><a href="#1-2-1-默认值生效条件" class="headerlink" title="1.2.1 默认值生效条件"></a>1.2.1 默认值生效条件</h3><p>通过模式匹配对应的数组成员<code>===</code> <code>undefined</code>，默认值才会生效</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 生效 */</span></span><br><span class="line"><span class="keyword">var</span> [x = <span class="number">1</span>] = [<span class="literal">undefined</span>];</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 不生效 */</span></span><br><span class="line"><span class="keyword">var</span> [x = <span class="number">1</span>] = [<span class="literal">null</span>];</span><br><span class="line">x <span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-2-默认值使用表达式"><a href="#1-2-2-默认值使用表达式" class="headerlink" title="1.2.2 默认值使用表达式"></a>1.2.2 默认值使用表达式</h3><p><strong>会出现惰性求值：</strong>即只有在用到的时候（默认值生效），才会求值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不会执行，因为 x 的默认值没生效</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'aaa'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x = f()] = [<span class="number">1</span>];</span><br></pre></td></tr></table></figure>
<h3 id="1-2-3-默认值引用其它变量"><a href="#1-2-3-默认值引用其它变量" class="headerlink" title="1.2.3 默认值引用其它变量"></a>1.2.3 默认值引用其它变量</h3><p><strong>注意：</strong>该变量必须已经声明，否则报错</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 正确使用 */</span></span><br><span class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [];     <span class="comment">// x=1; y=1</span></span><br><span class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [<span class="number">2</span>];    <span class="comment">// x=2; y=2</span></span><br><span class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [<span class="number">1</span>, <span class="number">2</span>]; <span class="comment">// x=1; y=2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 错误使用 */</span></span><br><span class="line"><span class="keyword">let</span> [x = y, y = <span class="number">1</span>] = [];     <span class="comment">// ReferenceError</span></span><br></pre></td></tr></table></figure>
<p>#2 对象的解构赋值<br>对象的解构与数组有一个重要的不同</p>
<ul>
<li>数组：元素是按次序排列的，变量的取值由它的<code>位置</code>决定</li>
<li>对象：属性没有次序，变量必须与属性<code>同名</code>，才能取到正确的值</li>
</ul>
<p><code>[</code>var<code>|</code>let<code>|</code>const<code>]</code> {模式<code>:[</code>赋值变量<code>]</code>} = {属性1: 属性1值};</p>
<h2 id="2-1-变量必须与属性同名"><a href="#2-1-变量必须与属性同名" class="headerlink" title="2.1 变量必须与属性同名"></a>2.1 变量必须与属性同名</h2><p>对象的解构赋值的内部机制，是先找到同名属性，然后再赋给对应的变量。真正被赋值的是后者，而不是前者</p>
<p>如果打算让被赋值变量和模式同名，则可以省略模式<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123; bar, foo &#125; = &#123; foo: <span class="string">"aaa"</span>, bar: <span class="string">"bbb"</span> &#125;;</span><br><span class="line">foo <span class="comment">// "aaa"</span></span><br><span class="line">bar <span class="comment">// "bbb"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; baz &#125; = &#123; foo: <span class="string">"aaa"</span>, bar: <span class="string">"bbb"</span> &#125;;</span><br><span class="line">baz <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure></p>
<p>否则<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123; foo: baz &#125; = &#123; foo: <span class="string">"aaa"</span>, bar: <span class="string">"bbb"</span> &#125;;</span><br><span class="line">baz <span class="comment">// "aaa"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123; first: <span class="string">'hello'</span>, last: <span class="string">'world'</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; first: f, last: l &#125; = obj;</span><br><span class="line">f <span class="comment">// 'hello'</span></span><br><span class="line">l <span class="comment">// 'world'</span></span><br></pre></td></tr></table></figure></p>
<h2 id="2-2-变量的声明和赋值是一体的"><a href="#2-2-变量的声明和赋值是一体的" class="headerlink" title="2.2 变量的声明和赋值是一体的"></a>2.2 变量的声明和赋值是一体的</h2><p>对于<code>let</code>和`const来说，变量不能重新声明，所以一旦赋值的变量以前声明过</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> foo;</span><br><span class="line"><span class="keyword">let</span> &#123;foo&#125; = &#123;foo: <span class="number">1</span>&#125;; <span class="comment">// SyntaxError: Duplicate declaration "foo"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> baz;</span><br><span class="line"><span class="keyword">let</span> &#123;bar: baz&#125; = &#123;bar: <span class="number">1</span>&#125;; <span class="comment">// SyntaxError: Duplicate declaration "baz"</span></span><br></pre></td></tr></table></figure>
<h2 id="2-3-解构嵌套结构的对象"><a href="#2-3-解构嵌套结构的对象" class="headerlink" title="2.3 解构嵌套结构的对象"></a>2.3 解构嵌套结构的对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  p: [</span><br><span class="line">    <span class="string">"Hello"</span>,</span><br><span class="line">    &#123; y: <span class="string">"World"</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; p: [x, &#123; y &#125;] &#125; = obj;</span><br><span class="line">x <span class="comment">// "Hello"</span></span><br><span class="line">y <span class="comment">// "World"</span></span><br></pre></td></tr></table></figure>
<h2 id="2-4-指定默认值"><a href="#2-4-指定默认值" class="headerlink" title="2.4 指定默认值"></a>2.4 指定默认值</h2><p>默认值生效的条件是，对象的属性值严格等于<code>undefined</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123;x = <span class="number">3</span>&#125; = &#123;&#125;;</span><br><span class="line">x <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;x, y = <span class="number">5</span>&#125; = &#123;x: <span class="number">1</span>&#125;;</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; message: msg = <span class="string">"Something went wrong"</span> &#125; = &#123;&#125;;</span><br><span class="line">msg <span class="comment">// "Something went wrong"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="2-5-解构失败"><a href="#2-5-解构失败" class="headerlink" title="2.5 解构失败"></a>2.5 解构失败</h2><p>如果解构失败，变量的值等于<code>undefined</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1. 无法匹配到模式 */</span></span><br><span class="line"><span class="keyword">var</span> &#123;foo&#125; = &#123;bar: <span class="string">'baz'</span>&#125;;</span><br><span class="line">foo <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2. 子对象所在的父属性 */</span></span><br><span class="line"><span class="keyword">var</span> &#123;foo: &#123;bar&#125;&#125; = &#123;baz: <span class="string">'baz'</span>&#125;;<span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
<h2 id="2-6-已经声明的变量"><a href="#2-6-已经声明的变量" class="headerlink" title="2.6 已经声明的变量"></a>2.6 已经声明的变量</h2><p>如果要将一个已经声明的变量用于解构赋值，必须非常小心<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x;</span><br><span class="line"></span><br><span class="line"><span class="comment">// JavaScript引擎会将&#123;x&#125;理解成一个代码块，从而发生语法错误</span></span><br><span class="line">&#123;x&#125; = &#123;x: <span class="number">1</span>&#125;;<span class="comment">// SyntaxError: syntax error</span></span><br></pre></td></tr></table></figure></p>
<p>将整个解构赋值语句，放在一个圆括号里面，就可以正确执行<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x;</span><br><span class="line">()&#123;x&#125; = &#123;x: <span class="number">1</span>&#125;);</span><br><span class="line">x <span class="comment">// 1</span></span><br></pre></td></tr></table></figure></p>
<p>#3 字符串的解构赋值<br>字符串也可以解构赋值。这是因为此时，字符串被转换成了一个类似数组的对象。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [a, b, c, d, e] = <span class="string">'hello'</span>;</span><br><span class="line">a <span class="comment">// "h"</span></span><br><span class="line">b <span class="comment">// "e"</span></span><br><span class="line">c <span class="comment">// "l"</span></span><br><span class="line">d <span class="comment">// "l"</span></span><br><span class="line">e <span class="comment">// "o"</span></span><br></pre></td></tr></table></figure></p>
<p>类似数组的对象都有一个length属性，因此还可以对这个属性解构赋值。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;length : len&#125; = <span class="string">'hello'</span>;</span><br><span class="line">len <span class="comment">// 5</span></span><br></pre></td></tr></table></figure></p>
<p>#4 数值和布尔值的解构赋值<br><strong>说明：</strong>解构赋值时，如果等号右边是数值和布尔值，则会先转为对象<br><strong>注意：</strong><code>undefined</code>和<code>null</code>无法转为对象，所以对它们进行解构赋值，都会报错</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;toString: s&#125; = <span class="number">123</span>;</span><br><span class="line">s === <span class="built_in">Number</span>.prototype.toString <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;toString: s&#125; = <span class="literal">true</span>;</span><br><span class="line">s === <span class="built_in">Boolean</span>.prototype.toString <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; prop: x &#125; = <span class="literal">undefined</span>; <span class="comment">// TypeError</span></span><br><span class="line"><span class="keyword">let</span> &#123; prop: y &#125; = <span class="literal">null</span>; <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure>
<p>#5 函数参数的解构赋值<br>函数的参数也可以使用解构赋值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">[x, y]</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add([<span class="number">1</span>, <span class="number">2</span>]); <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]].map(([a, b]) =a + b);</span><br></pre></td></tr></table></figure>
<h2 id="5-1-默认值"><a href="#5-1-默认值" class="headerlink" title="5.1 默认值"></a>5.1 默认值</h2><p><strong>注意：</strong>分两种情况</p>
<ol>
<li><p>给解构后被赋值的变量提供默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">&#123;x = 0, y = 0&#125; = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">move(&#123;x: <span class="number">3</span>, y: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></span><br><span class="line">move(&#123;x: <span class="number">3</span>&#125;); <span class="comment">// [3, 0]</span></span><br><span class="line">move(&#123;&#125;); <span class="comment">// [0, 0]</span></span><br><span class="line">move(); <span class="comment">// [0, 0]，参数对象默认值生效，为&#123;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>给传入的参数提供默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">&#123;x, y&#125; = &#123; x: 0, y: 0 &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">move(&#123;x: <span class="number">3</span>, y: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></span><br><span class="line">move(&#123;x: <span class="number">3</span>&#125;); <span class="comment">// [3, undefined]</span></span><br><span class="line">move(&#123;&#125;); <span class="comment">// [undefined, undefined]</span></span><br><span class="line">move(); <span class="comment">// [0, 0]</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>#6 圆括号的解构赋值</p>
<p>##6.1 不能使用圆括号的情形</p>
<p><strong>说明：</strong>ES6的规则是，只要有可能导致解构的歧义，就不得使用圆括号。<br><strong>建议：</strong>只要有可能，就不要在模式中放置圆括号。</p>
<ol>
<li><p>变量声明语句中，不能带有圆括号</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全部报错</span></span><br><span class="line"><span class="keyword">var</span> [(a)] = [<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;x: (c)&#125; = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> (&#123;x: c&#125;) = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> &#123;(x: c)&#125; = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> &#123;(x): c&#125; = &#123;&#125;;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123; o: (&#123; p: p &#125;) &#125; = &#123; o: &#123; p: <span class="number">2</span> &#125; &#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数参数中，模式不能带有圆括号<br>函数参数也属于变量声明，因此不能带有圆括号</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">[(z</span>)]) </span>&#123; <span class="keyword">return</span> z; &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>赋值语句中，不能将整个模式，或嵌套模式中的一层，放在圆括号之中</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全部报错</span></span><br><span class="line">(&#123; p: a &#125;) = &#123; p: <span class="number">42</span> &#125;;</span><br><span class="line">([a]) = [<span class="number">5</span>];</span><br><span class="line">[(&#123; p: a &#125;), &#123; x: c &#125;] = [&#123;&#125;, &#123;&#125;];</span><br></pre></td></tr></table></figure>
<h2 id="6-2-可以使用圆括号的情形"><a href="#6-2-可以使用圆括号的情形" class="headerlink" title="6.2 可以使用圆括号的情形"></a>6.2 可以使用圆括号的情形</h2><p>赋值语句的非模式部分</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[(b)] = [<span class="number">3</span>]; <span class="comment">// 正确</span></span><br><span class="line">(&#123; p: (d) &#125; = &#123;&#125;); <span class="comment">// 正确</span></span><br><span class="line">[(<span class="built_in">parseInt</span>.prop)] = [<span class="number">3</span>]; <span class="comment">// 正确</span></span><br></pre></td></tr></table></figure>
<p>#7 用途的解构赋值</p>
<ol>
<li>交换变量的值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x, y] = [y, x];</span><br></pre></td></tr></table></figure>
<ol>
<li>从函数返回多个值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回一个数组</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> [a, b, c] = example();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一个对象</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    foo: <span class="number">1</span>,</span><br><span class="line">    bar: <span class="number">2</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> &#123; foo, bar &#125; = example();</span><br></pre></td></tr></table></figure>
<ol>
<li><p>函数参数的定义</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 参数是一组有次序的值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">[x, y, z]</span>) </span>&#123; ... &#125;</span><br><span class="line">f([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数是一组无次序的值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">&#123;x, y, z&#125;</span>) </span>&#123; ... &#125;</span><br><span class="line">f(&#123;z: <span class="number">3</span>, y: <span class="number">2</span>, x: <span class="number">1</span>&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取JSON数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonData = &#123;</span><br><span class="line">  id: <span class="number">42</span>,</span><br><span class="line">  status: <span class="string">"OK"</span>,</span><br><span class="line">  data: [<span class="number">867</span>, <span class="number">5309</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; id, status, data: number &#125; = jsonData;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(id, status, number);</span><br><span class="line"><span class="comment">// 42, "OK", [867, 5309]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>函数参数的默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">jQuery.ajax = <span class="function"><span class="keyword">function</span> (<span class="params">url, &#123;</span><br><span class="line">  async = true,</span><br><span class="line">  beforeSend = function (</span>) </span>&#123;&#125;,</span><br><span class="line">  cache = <span class="literal">true</span>,</span><br><span class="line">  complete = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  crossDomain = <span class="literal">false</span>,</span><br><span class="line">  global = <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// ... more config</span></span><br><span class="line">&#125;) &#123;</span><br><span class="line">  <span class="comment">// ... do stuff</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历Map结构</p>
</li>
</ol>
<p>Iterator配合解构赋值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">map.set(<span class="string">'first'</span>, <span class="string">'hello'</span>);</span><br><span class="line">map.set(<span class="string">'second'</span>, <span class="string">'world'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key + <span class="string">" is "</span> + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// first is hello</span></span><br><span class="line"><span class="comment">// second is world</span></span><br></pre></td></tr></table></figure></p>
<p>如果只想获取键名，或者只想获取键值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取键名</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取键值</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [,value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>输入模块的指定方法<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; SourceMapConsumer, SourceNode &#125; = <span class="built_in">require</span>(<span class="string">"source-map"</span>);</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_4 字符串的扩展/" itemprop="url">
                  4 字符串的扩展(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:01:44+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_4 字符串的扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_4 字符串的扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="4-1-字符的unicode表示法"><a href="#4-1-字符的unicode表示法" class="headerlink" title="4.1 字符的unicode表示法"></a>4.1 字符的unicode表示法</h2><table>
<thead>
<tr>
<th>unicode表示法</th>
<th>码点</th>
<th>兼容性</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\uxxxx</code></td>
<td>一个两个字节长度的16进制数字</td>
<td>all</td>
</tr>
<tr>
<td><code>\uxxxx\uxxxx</code></td>
<td>两个两个字节长度的16进制数字</td>
<td>all</td>
</tr>
<tr>
<td><code>\u{xx...}</code></td>
<td>码点为任意unicode编码</td>
<td>es6+</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"\u&#123;20BB7&#125;"</span></span><br><span class="line"><span class="comment">// "𠮷"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"\u&#123;41&#125;\u&#123;42&#125;\u&#123;43&#125;"</span></span><br><span class="line"><span class="comment">// "ABC"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> hello = <span class="number">123</span>;</span><br><span class="line">hell\u&#123;<span class="number">6</span>F&#125; <span class="comment">// 123</span></span><br><span class="line"></span><br><span class="line"><span class="string">'\u&#123;1F680&#125;'</span> === <span class="string">'\uD83D\uDE80'</span></span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="4-2-codePointAt"><a href="#4-2-codePointAt" class="headerlink" title="4.2 codePointAt()"></a>4.2 codePointAt()</h2><p><strong>背景：</strong><code>javascript</code>使用<code>utf-16</code>（两个字节）存储字符，使用<code>charCodeAt</code>无法正确处理四字节字符</p>
<p>类似<code>charCodeAt</code>，区别是<code>codePointAt</code>能够正确识别四字节字符（比如<code>吉祥</code>）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'吉a'</span>;</span><br><span class="line"></span><br><span class="line">s.codePointAt(<span class="number">0</span>) <span class="comment">// 134071(吉,0xD842 0xDFB7)</span></span><br><span class="line">s.codePointAt(<span class="number">1</span>) <span class="comment">// 57271（0xDFB7）</span></span><br><span class="line"></span><br><span class="line">s.charCodeAt(<span class="number">2</span>) <span class="comment">// 97</span></span><br><span class="line">s.codePointAt(<span class="number">2</span>) <span class="comment">// 97</span></span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong><code>codePointAt</code>仍会按照两个字节一个字符的方式计算字符串中字符数量，因此传递给<code>codePointAt</code>的参数和<code>charCodeAt</code>是一样的。<br><strong>扩展：</strong>使用<code>for-of</code>可以正确识别32位（4字节）UTF-16字符。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'吉a'</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> s) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(ch.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 20bb7</span></span><br><span class="line"><span class="comment">// 61</span></span><br></pre></td></tr></table></figure></p>
<p><strong>技巧：</strong>使用<code>codePointAt</code>获取字符的<code>UTF-16</code>完整编码，并判断其大小，就可以识别4字节字符。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is32Bit</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> c.codePointAt(<span class="number">0</span>) <span class="number">0xFFFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">is32Bit(<span class="string">"𠮷"</span>) <span class="comment">// true</span></span><br><span class="line">is32Bit(<span class="string">"a"</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure></p>
<h2 id="4-3-String-fromCodePoint"><a href="#4-3-String-fromCodePoint" class="headerlink" title="4.3 String.fromCodePoint()"></a>4.3 String.fromCodePoint()</h2><p><strong>背景：</strong><code>String.fromCharCode</code>用于从码点返回对应的字符，但对32位的<code>UTF-16</code>字符进行转换会发生溢出。</p>
<p><code>String.fromCodePoint</code>对应<code>codePointAt</code>，可以正确返回32为<code>UTF-16</code>字符对应的字符；当传递多个参数给<code>String.fromCodePoint</code>时，会返回每个参数（码点）对应的字符拼接成的字符串。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>)</span><br><span class="line"><span class="comment">// "𠮷"</span></span><br><span class="line"><span class="built_in">String</span>.fromCodePoint(<span class="number">0x78</span>, <span class="number">0x1f680</span>, <span class="number">0x79</span>) === <span class="string">'x\uD83D\uDE80y'</span></span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="4-4-字符串的遍历器接口"><a href="#4-4-字符串的遍历器接口" class="headerlink" title="4.4 字符串的遍历器接口"></a>4.4 字符串的遍历器接口</h2><p><strong>说明：</strong>es6为字符串添加了便利器接口，因而可以通过<code>for-of</code>遍历字符串。<br><strong>特点：</strong>能够正确识别码点大于<code>\uffff</code>的字符<br><strong>技巧：</strong>利用<code>for-of</code>计算字符串正确的字符个数（传统的<code>for</code>和<code>for-in</code>无法做到）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> text = <span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> text) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// "吉"</span></span><br></pre></td></tr></table></figure>
<h2 id="4-5-at"><a href="#4-5-at" class="headerlink" title="4.5 at()"></a>4.5 at()</h2><p><strong>说明：</strong>字符串的方法（提案状态？），能够识别码点大于<code>\uffff</code>的字符<br><strong>ES5：</strong>字符串的<code>charAt</code>方法用于返回字符串给定位置的字符，但不能正确识别码点大于<code>\uffff</code>的字符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'吉'</span>.at(<span class="number">0</span>) <span class="comment">// "吉"</span></span><br></pre></td></tr></table></figure>
<h2 id="4-6-normalize"><a href="#4-6-normalize" class="headerlink" title="4.6 normalize()"></a>4.6 normalize()</h2><p><strong>说明：</strong>es6提供字符串实例的<code>normalize</code>方法，用来将字符的不同表示方法统一为同样的形式，称为<code>unicode正规化</code>。</p>
<h2 id="4-7-includes-startsWith-endsWith"><a href="#4-7-includes-startsWith-endsWith" class="headerlink" title="4.7 includes(), startsWith(), endsWith()"></a>4.7 includes(), startsWith(), endsWith()</h2><table>
<thead>
<tr>
<th>方法</th>
<th>返回值</th>
<th>第二个参数(可选)</th>
</tr>
</thead>
<tbody>
<tr>
<td>includes</td>
<td>布尔值，表示是否找到了参数字符串</td>
<td>开始搜索的位置</td>
</tr>
<tr>
<td>startsWith</td>
<td>布尔值，表示参数字符串是否在源字符串的头部</td>
<td>开始搜索的位置</td>
</tr>
<tr>
<td>endsWith</td>
<td>布尔值，表示参数字符串是否在源字符串的尾部</td>
<td>停止搜索的位置</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</span><br><span class="line"></span><br><span class="line">s.startsWith(<span class="string">'world'</span>, <span class="number">6</span>) <span class="comment">// true</span></span><br><span class="line">s.endsWith(<span class="string">'Hello'</span>, <span class="number">5</span>) <span class="comment">// true</span></span><br><span class="line">s.includes(<span class="string">'Hello'</span>, <span class="number">6</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h2 id="4-8-repeat"><a href="#4-8-repeat" class="headerlink" title="4.8 repeat()"></a>4.8 repeat()</h2><p><strong>用途：</strong>返回一个将源字符串重复n次的新字符串<br><strong>注意：</strong>如果参数不是整数，将会按照一定规则取整<br>非整数参数|转换后<br>-|-<br>小数|向下取整<br>负数或<code>Infinity</code>|报错<br>0~-1|0<br><code>NaN</code>|0<br>字符串|相应的数字</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'x'</span>.repeat(<span class="number">3</span>) <span class="comment">// "xxx"</span></span><br><span class="line"><span class="string">'hello'</span>.repeat(<span class="number">2</span>) <span class="comment">// "hellohello"</span></span><br><span class="line"><span class="string">'na'</span>.repeat(<span class="number">0</span>) <span class="comment">// ""</span></span><br><span class="line"></span><br><span class="line"><span class="string">'na'</span>.repeat(<span class="number">-0.9</span>) <span class="comment">// ""</span></span><br><span class="line"><span class="string">'na'</span>.repeat(<span class="string">'na'</span>) <span class="comment">// ""</span></span><br><span class="line"><span class="string">'na'</span>.repeat(<span class="string">'3'</span>) <span class="comment">// "nanana"</span></span><br></pre></td></tr></table></figure>
<p>##4.9 padStart(), padEnd()</p>
<p><strong>ES7：</strong>补全字符串的长度<br>函数|用途<br>-|-<br>padStart|用于头部补全<br>padEnd|用于尾部补全</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>第一个参数</td>
<td>指定字符串的最小长度</td>
</tr>
<tr>
<td>第二个参数（可选）</td>
<td>用来补全的字符串，默认为空格。如果用来补全的字符串与原字符串，两者的长度之和超过了指定的最小长度，则会截去超出位数的补全字符串</td>
</tr>
</tbody>
</table>
<p><strong>注意：</strong>如果原字符串的长度，等于或大于指定的最小长度，则返回原字符串。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为数值补全指定位数</span></span><br><span class="line"><span class="string">'1'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000001"</span></span><br><span class="line"><span class="string">'12'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000012"</span></span><br><span class="line"><span class="string">'123456'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000123456"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 提示字符串格式</span></span><br><span class="line"><span class="string">'12'</span>.padStart(<span class="number">10</span>, <span class="string">'YYYY-MM-DD'</span>) <span class="comment">// "YYYY-MM-12"</span></span><br><span class="line"><span class="string">'09-12'</span>.padStart(<span class="number">10</span>, <span class="string">'YYYY-MM-DD'</span>) <span class="comment">// "YYYY-09-12"</span></span><br></pre></td></tr></table></figure>
<p>##4.10 模版字符串</p>
<p><strong>语法：</strong>使用反引号括起来</p>
<ul>
<li>可以当作普通字符串来使用，也可以用来定义多行字符串</li>
<li>可以在字符串中<code>嵌入变量</code></li>
<li>如果模版字符串中使用反引号，则前面要用<code>反斜杠转义</code></li>
<li>所有的<code>空格和缩进</code>都会被保留在输出之中，不需要的话可以使用<code>trim</code>方法消除</li>
<li>模板字符串中嵌入变量，需要将变量名写在<code>${}</code>之中</li>
</ul>
<h3 id="4-10-1-嵌入JS表达式"><a href="#4-10-1-嵌入JS表达式" class="headerlink" title="4.10.1 嵌入JS表达式"></a>4.10.1 嵌入<code>JS表达式</code></h3><p>大括号内部可以放入任意的JavaScript表达式，可以</p>
<ul>
<li>进行运算</li>
<li>引用对象属性</li>
<li>调用函数</li>
</ul>
<p><strong>注意：</strong></p>
<ul>
<li>如果<code>${}</code>中的值不是字符串，将按照一般的规则转为字符串</li>
<li>如果<code>${}</code>内部是一个字符串，将会原样输出</li>
<li>如果模板字符串中的变量没有声明，将报错</li>
<li>通过<code>${}</code>，模板字符串甚至还能嵌套</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// 定义返回模版字符串的函数</span><br><span class="line">const tmpl = addrs =`</span><br><span class="line">  &lt;table&gt;</span><br><span class="line">  $&#123;addrs.map(addr =`</span><br><span class="line">    &lt;tr&gt;&lt;td&gt;$&#123;addr.first&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;&lt;td&gt;$&#123;addr.last&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">  `).join('')&#125;</span><br><span class="line">  &lt;/table&gt;</span><br><span class="line">`;</span><br><span class="line"></span><br><span class="line">// 定义填充模版字符串的数据</span><br><span class="line">const data = [</span><br><span class="line">    &#123; first: '&lt;Jane&gt;', last: 'Bond' &#125;,</span><br><span class="line">    &#123; first: 'Lars', last: '&lt;Croft&gt;' &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">console.log(tmpl(data));</span><br><span class="line">// &lt;table&gt;</span><br><span class="line">//</span><br><span class="line">//   &lt;tr&gt;&lt;td&gt;&lt;Jane&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">//   &lt;tr&gt;&lt;td&gt;Bond&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">//</span><br><span class="line">//   &lt;tr&gt;&lt;td&gt;Lars&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">//   &lt;tr&gt;&lt;td&gt;&lt;Croft&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">//</span><br><span class="line">// &lt;/table&gt;</span><br></pre></td></tr></table></figure>
<p>##4.11 实例：模版编译</p>
<p><em>l04_template.vue</em><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	export default &#123;</span><br><span class="line">		data () &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				template: '',</span><br><span class="line">				templateCompiled: '',</span><br><span class="line">				templateOutput: ''</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			/**</span><br><span class="line">			* 模版编译函数</span><br><span class="line">			* @param &#123;string&#125; template 模版字符串</span><br><span class="line">			* @return &#123;string&#125; 可执行的js代码</span><br><span class="line">			*/</span><br><span class="line">			compile: function (template)&#123;</span><br><span class="line">			  var evalExpr = /&lt;%=(.+?)%&gt;/g;</span><br><span class="line">			  var expr = /&lt;%([\s\S]+?)%&gt;/g;</span><br><span class="line"></span><br><span class="line">			  template = template</span><br><span class="line">			    .replace(evalExpr, '`); \n  echo( $1 ); \n  echo(`')</span><br><span class="line">			    .replace(expr, '`); \n $1 \n  echo(`');</span><br><span class="line"></span><br><span class="line">			  template = 'echo(`' + template + '`);';</span><br><span class="line"></span><br><span class="line">			  var script =</span><br><span class="line">			  `(function parse(data)&#123;</span><br><span class="line">			    var output = "";</span><br><span class="line"></span><br><span class="line">			    function echo(html)&#123;</span><br><span class="line">			      output += html;</span><br><span class="line">			    &#125;</span><br><span class="line"></span><br><span class="line">			    $&#123; template &#125;</span><br><span class="line"></span><br><span class="line">			    return output;</span><br><span class="line">			  &#125;)`;</span><br><span class="line"></span><br><span class="line">			  return script;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		ready: function () &#123;</span><br><span class="line">			// 定义原始模版</span><br><span class="line">			this.template = `</span><br><span class="line">			&lt;ul&gt;</span><br><span class="line">			  &lt;% for(var i=0; i &lt; data.supplies.length; i++) &#123; %&gt;</span><br><span class="line">			    &lt;li&gt;&lt;%= data.supplies[i] %&gt;&lt;/li&gt;</span><br><span class="line">			  &lt;% &#125; %&gt;</span><br><span class="line">			&lt;/ul&gt;</span><br><span class="line">			`;</span><br><span class="line">			this.templateCompiled = this.compile(this.template);</span><br><span class="line"></span><br><span class="line">			// eval 中的代码会定义一个函数，并返回这个函数的引用</span><br><span class="line">			var parse = eval(this.templateCompiled);</span><br><span class="line"></span><br><span class="line">			// 调用函数完成拼接</span><br><span class="line">			this.templateOutput = parse(&#123; supplies: [ "broom", "mop", "cleaner" ] &#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;h3&gt;模版&lt;/h3&gt;</span><br><span class="line">	&lt;code&gt;&#123;&#123;template&#125;&#125;&lt;/code&gt;</span><br><span class="line">	&lt;h3&gt;编译后的模版&lt;/h3&gt;</span><br><span class="line">	&lt;code&gt;&#123;&#123;templateCompiled&#125;&#125;&lt;/code&gt;</span><br><span class="line">	&lt;h3&gt;灌入数据的模版&lt;/h3&gt;</span><br><span class="line">	&lt;code&gt;&#123;&#123;templateOutput&#125;&#125;&lt;/code&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http://localhost:8080/#!/l04</span></span><br><span class="line">$ npm start</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1469070909258.png" alt="Alt text"></p>
<p>##4.12 标签模版</p>
<p><strong>说明：</strong>一种针对模版字符串的特殊函数调用。<br><strong>语法：</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">函数名<span class="string">`模<span class="subst">$&#123;表达式1&#125;</span>版字<span class="subst">$&#123;表达式2&#125;</span>串`</span>;</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line">* @param &#123;array like&#125; 第一个参数</span><br><span class="line">* @param &#123;...string&#125; 不定参数</span><br><span class="line">*/</span></span><br><span class="line">函数名([<span class="string">'模'</span>,<span class="string">'版'</span>,<span class="string">'字'</span>,<span class="string">'符'</span>,<span class="string">'串'</span>], 表达式<span class="number">1</span>返回值, 表达式<span class="number">2</span>返回值);</span><br></pre></td></tr></table></figure></p>
<p><strong>参数：</strong>调用函数传入的第一个参数有一个<code>row</code>属性，是一个和第一个参数本身内容相同的数组，不过元素中的所有<code>\</code>都被转义了，从而可以获得字符串的原始版本。<br><strong>用途：</strong>通过实现相应的处理模版字符串的函数，<code>标签模版</code>常用于</p>
<ul>
<li>处理<code>HTML</code>字符串过滤</li>
<li>多语言转换（国际化处理）</li>
<li>为模版增加条件判断和循环处理等模版基础能力</li>
<li>嵌入其它语言</li>
</ul>
<p><em>l04_taggedTemplate.vue</em><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	export default &#123;</span><br><span class="line">		data () &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				template: "Hello $&#123; a + b &#125; world $&#123; a * b&#125;",</span><br><span class="line">				templateOutput: ''</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			/**</span><br><span class="line">			 * 将各个参数按照原来的位置拼合回去(写法1)</span><br><span class="line">			 * @param  &#123;array&#125; literals 被插入的表达式隔开的字符串组成的数组</span><br><span class="line">			 * @return &#123;string&#125;     各个参数按照原来的位置拼合的字符串     </span><br><span class="line">			 */</span><br><span class="line">			passthru1: function (literals) &#123;</span><br><span class="line">				var result = ''</span><br><span class="line">				var i = 0</span><br><span class="line">				while (i &lt; literals.length) &#123;</span><br><span class="line">					// 拼接单纯的字符串</span><br><span class="line">					result += literals[i++]</span><br><span class="line"></span><br><span class="line">					// 拼接插入的表达式运算结果</span><br><span class="line">					if (i &lt; arguments.length) &#123;</span><br><span class="line">						result += arguments[i]</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				return result;</span><br><span class="line">			&#125;,</span><br><span class="line">			/**</span><br><span class="line">			 * 将各个参数按照原来的位置拼合回去(写法2)</span><br><span class="line">			 * @param  &#123;array&#125;    literals 被插入的表达式隔开的字符串组成的数组</span><br><span class="line">			 * @param  &#123;...array&#125; values   插入的所有表达式结果（从左到右摘出来）</span><br><span class="line">			 * @return &#123;string&#125;     各个参数按照原来的位置拼合的字符串 </span><br><span class="line">			 */</span><br><span class="line">			passthru2: function (literals, ...values) &#123;</span><br><span class="line">				var output = ''</span><br><span class="line">				for (var index = 0; index &lt; values.length; index++) &#123;</span><br><span class="line">					output +=literals[index] + values[index]</span><br><span class="line">				&#125;</span><br><span class="line">				// 被插入的表达式隔开的字符串组成的数组 比 插入的所有表达式结果长度大1</span><br><span class="line">				output += literals[index]</span><br><span class="line"></span><br><span class="line">				return output</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		ready: function () &#123;</span><br><span class="line">			let a = 2</span><br><span class="line">			let b = 4</span><br><span class="line">			this.templateOutput = this.passthru2`Hello $&#123; a + b &#125; world $&#123; a * b&#125;`</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;p&gt;运行&lt;/p&gt;</span><br><span class="line">	&lt;code&gt;passthru`&#123;&#123;template&#125;&#125;`&lt;/code&gt;</span><br><span class="line">	&lt;p&gt;输出&lt;/p&gt;</span><br><span class="line">	&lt;code&gt;&#123;&#123;templateOutput&#125;&#125;&lt;/code&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p>
<p>##4.13 String.raw()</p>
<p><strong>用途：</strong>两种使用方式</p>
<ul>
<li>作为模版标签使用</li>
<li>作为普通函数调用<figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span><br><span class="line">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">		data () &#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;</span><br><span class="line">				hiHuanhang: <span class="string">''</span>,</span><br><span class="line">				hiUtf16: <span class="string">''</span>,</span><br><span class="line">				test1: <span class="string">''</span>,</span><br><span class="line">				test2: <span class="string">''</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 自己视线一个 String.raw</span><br><span class="line">			 * @param  &#123;array&#125;    strings 被插入的表达式隔开的字符串组成的类数组,需要有raw属性</span><br><span class="line">			 * @param  &#123;...string&#125; value   插入的表达式返回值</span><br><span class="line">			 * @return &#123;string&#125;            转义后的字符串</span><br><span class="line">			 */</span></span><br><span class="line">			myRaw: <span class="function"><span class="keyword">function</span> (<span class="params">strings, ...value</span>) </span>&#123;</span><br><span class="line">				<span class="keyword">var</span> output = <span class="string">''</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; values.length; index++) &#123;</span><br><span class="line">					output += strings.raw[index] + values[index];</span><br><span class="line">				&#125;</span><br><span class="line">				output += strings.raw[index];</span><br><span class="line">				<span class="keyword">return</span> output;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		ready: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* 用法1:当作模版标签使用 */</span></span><br><span class="line">			<span class="keyword">this</span>.hiHuanhang = <span class="built_in">String</span>.raw<span class="string">`Hi\n<span class="subst">$&#123;2+3&#125;</span>!`</span>;</span><br><span class="line">			<span class="comment">// "Hi\\n5!"</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">this</span>.hiUtf16 = <span class="built_in">String</span>.raw<span class="string">`Hi\u000A!`</span>;</span><br><span class="line">			<span class="comment">// 'Hi\\u000A!'</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">/* 用法2:当作普通函数调用 */</span></span><br><span class="line">			<span class="keyword">this</span>.test1 = <span class="built_in">String</span>.raw(&#123; raw: <span class="string">'test'</span> &#125;, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">			<span class="comment">// 't0e1s2t'</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// 等同于</span></span><br><span class="line">			<span class="keyword">this</span>.test2 = <span class="built_in">String</span>.raw(&#123; raw: [<span class="string">'t'</span>,<span class="string">'e'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>] &#125;, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>转换换行符<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;hiHuanhang&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>转换utf-16表示方式<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;hiUtf16&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>当做普通函数调用<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;test2&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_5 正则的扩展/" itemprop="url">
                  5 正则的扩展(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T22:01:35+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_5 正则的扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_5 正则的扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="5-1-RegExp构造函数"><a href="#5-1-RegExp构造函数" class="headerlink" title="5.1 RegExp构造函数"></a>5.1 RegExp构造函数</h2><p>与es5相比，es6<code>RegExp</code>函数支持第一个参数为正则表达式的同时，还能设置第二个参数，第二个参数设置的正则修饰符将会覆盖第一个参数中的正则修饰符<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 构造器方式 */</span></span><br><span class="line"><span class="keyword">let</span> r1 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'xzy'</span>, <span class="string">'i'</span>)<span class="comment">// 方式1(es5/es6): 第一个参数为字符串</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r2 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/xyz/i</span>)<span class="comment">// 方式2(es5/es6): 第一个参数为正则表达式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r3 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/xyz/ig</span>, <span class="string">'i'</span>)<span class="comment">//  方式3(es5/es6):第一个参数为正则表达式，且支持第二个参数设置正则表达式修饰符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 正则对象(es5/es6) */</span></span><br><span class="line"><span class="keyword">let</span> r4 = <span class="regexp">/xyz/i</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-2-字符串的正则方法"><a href="#5-2-字符串的正则方法" class="headerlink" title="5.2 字符串的正则方法"></a>5.2 字符串的正则方法</h2><p>在<code>es6</code>中，字符串的四个与正则相关的方法全部会调用<code>RegExp</code>对象定义的相应方法</p>
<table>
<thead>
<tr>
<th>字符串实例方法</th>
<th>被调用的<code>RegExp</code>的方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>String.prototype.<code>match</code></td>
<td>RegExp.prototype[Symbol.<code>match</code>]</td>
</tr>
<tr>
<td>String.prototype.<code>replace</code></td>
<td>RegExp.prototype[Symbol.<code>replace</code>]</td>
</tr>
<tr>
<td>String.prototype.<code>search</code></td>
<td>RegExp.prototype[Symbol.<code>search</code>]</td>
</tr>
<tr>
<td>String.prototype.<code>split</code></td>
<td>RegExp.prototype[Symbol.<code>split</code>]</td>
</tr>
</tbody>
</table>
<h2 id="5-3-u修饰符"><a href="#5-3-u修饰符" class="headerlink" title="5.3 u修饰符"></a>5.3 u修饰符</h2><table>
<thead>
<tr>
<th>比较点</th>
<th>场景</th>
<th>不带u修饰符</th>
<th>带u修饰符</th>
</tr>
</thead>
<tbody>
<tr>
<td>点字符(<code>.</code>)</td>
<td>(字符串中)当匹配目标码点 0xFFFF</td>
<td>无法匹配</td>
<td>正确匹配</td>
</tr>
<tr>
<td>Unicode字符表示法（<code>\u{}</code>）</td>
<td></td>
<td>当做正则量词</td>
<td>正确识别</td>
</tr>
<tr>
<td>量词（<code>{}</code>）</td>
<td>(正则表达式中)跟在码点大于<code>0xFFFF</code>的字符后面</td>
<td>无法识别</td>
<td>正确识别为量词</td>
</tr>
<tr>
<td>预定义模式</td>
<td>(字符串中)当匹配目标码点 0xFFFF</td>
<td>无法匹配</td>
<td>正确匹配</td>
</tr>
<tr>
<td><code>i</code>修饰符</td>
<td>(字符串中)当匹配目标为非规范的字符</td>
<td>无法匹配</td>
<td>正确匹配</td>
</tr>
</tbody>
</table>
<h2 id="5-4-y修饰符"><a href="#5-4-y修饰符" class="headerlink" title="5.4 y修饰符"></a>5.4 y修饰符</h2><p><strong>粘连（sticky）修饰符：</strong>类似<code>g</code>修饰符，会进行全文匹配，区别在于</p>
<ul>
<li><code>g</code>修饰符每次都从<code>lastIndex</code>属性开始，从这个位置开始往后搜索，发现匹配为止</li>
<li><code>y</code>修饰符每次也从<code>lastIndex</code>属性开始，从这个位置开始往后搜索，但要求在<code>lastIndex</code>指定的位置就发现匹配，否则返回 <code>null</code></li>
</ul>
<h3 id="5-4-1-和-g-修饰符的区别"><a href="#5-4-1-和-g-修饰符的区别" class="headerlink" title="5.4.1 和 g 修饰符的区别"></a>5.4.1 和 g 修饰符的区别</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="string">'aaa_aa_a'</span></span><br><span class="line"><span class="keyword">const</span> rg = <span class="regexp">/a+/g</span></span><br><span class="line"><span class="keyword">const</span> ry = <span class="regexp">/a+/y</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result</span><br><span class="line"><span class="comment">/* g 修饰符 */</span></span><br><span class="line"><span class="built_in">console</span>.log(rg.exec(s))<span class="comment">// ["aaa", index: 0, input: "aaa_aa_a"]</span></span><br><span class="line"><span class="built_in">console</span>.log(rg.exec(s))<span class="comment">// ["aa", index: 4, input: "aaa_aa_a"]</span></span><br><span class="line"><span class="built_in">console</span>.log(rg.exec(s))<span class="comment">// ["a", index: 7, input: "aaa_aa_a"]</span></span><br><span class="line"><span class="built_in">console</span>.log(rg.exec(s))<span class="comment">// null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* y 修饰符 */</span></span><br><span class="line"><span class="built_in">console</span>.log(ry.exec(s))<span class="comment">// ["aaa", index: 0, input: "aaa_aa_a"]</span></span><br><span class="line"><span class="built_in">console</span>.log(ry.exec(s))</span><br></pre></td></tr></table></figure>
<h3 id="5-4-2-从字符串提取-tokeb-词元"><a href="#5-4-2-从字符串提取-tokeb-词元" class="headerlink" title="5.4.2 从字符串提取 tokeb (词元)"></a>5.4.2 从字符串提取 tokeb (词元)</h3><p><strong>说明：</strong>根据<code>y</code>修饰符<code>粘连</code>的特性，可以利用这一点敏感地识别到提取词元过程中是否有异常字符出现。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	methods: &#123;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 逐个取出字符串中的词元</span><br><span class="line">		 * @param  &#123;RegExp&#125; TOKEN_REGEX 正则实例</span><br><span class="line">		 * @param  &#123;String&#125; str 目标字符串</span><br><span class="line">		 * @return &#123;Array&#125; 词元数组  </span><br><span class="line">		 */</span></span><br><span class="line">		tokenize (TOKEN_REGEX, str) &#123;</span><br><span class="line">			<span class="keyword">let</span> result = []</span><br><span class="line">			<span class="keyword">let</span> match</span><br><span class="line">			<span class="keyword">while</span> (match = TOKEN_REGEX.exec(str)) &#123;</span><br><span class="line">				result.push(match[<span class="number">1</span>])</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> result</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	ready: <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="comment">/** 从字符串提取 tokeb (词元)  */</span></span><br><span class="line">		<span class="comment">/* g 修饰符 */</span></span><br><span class="line">		<span class="keyword">const</span> TOKEN_G = <span class="regexp">/\s*(\+|[0-9]+)\s*/g</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.tokenize(TOKEN_G, <span class="string">'3 + 4'</span>))<span class="comment">// ["3", "+", "4"]</span></span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.tokenize(TOKEN_G, <span class="string">'3x + 4'</span>))<span class="comment">// ["3", "+", "4"]</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">/* y 修饰符 */</span></span><br><span class="line">		<span class="keyword">const</span> TOKEN_Y = <span class="regexp">/\s*(\+|[0-9]+)\s*/y</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.tokenize(TOKEN_Y, <span class="string">'3 + 4'</span>))<span class="comment">// ["3", "+", "4"]</span></span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.tokenize(TOKEN_Y, <span class="string">'3x + 4'</span>))<span class="comment">// ["3"]</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-5-sticky属性"><a href="#5-5-sticky属性" class="headerlink" title="5.5 sticky属性"></a>5.5 sticky属性</h2><p><code>RegExp.prototype.sticky</code>：是否设置了<code>y</code>修饰符<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> r = <span class="regexp">/hello\d/y</span></span><br><span class="line">r.sticky <span class="comment">// true</span></span><br></pre></td></tr></table></figure></p>
<h2 id="5-6-flags属性"><a href="#5-6-flags属性" class="headerlink" title="5.6 flags属性"></a>5.6 flags属性</h2><p><code>RegExp.prototype.flags</code>：返回正则表达式的修饰符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES5的source属性</span></span><br><span class="line"><span class="comment">// 返回正则表达式的正文</span></span><br><span class="line">/abc/ig.source</span><br><span class="line"><span class="comment">// "abc"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的flags属性</span></span><br><span class="line"><span class="comment">// 返回正则表达式的修饰符</span></span><br><span class="line">/abc/ig.flags</span><br><span class="line"><span class="comment">// 'gi'</span></span><br></pre></td></tr></table></figure>
<h2 id="5-7-RegExp-escape"><a href="#5-7-RegExp-escape" class="headerlink" title="5.7 RegExp.escape()"></a>5.7 RegExp.escape()</h2><p><strong>功能：</strong>将字符串中有特殊正则含义的字符转义掉<br><strong>注意：</strong>曾被建议加入<code>ES7</code>，由于安全风险没被采纳</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原始字符串</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">'hello. how are you?'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// escape 处理后的字符串</span></span><br><span class="line"><span class="keyword">const</span> regStr = <span class="keyword">this</span>.escapeRegExp(str)<span class="comment">// hello\. how are you\?</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 escape 处理后的字符串构建正则实例</span></span><br><span class="line"><span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(regStr, <span class="string">'g'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="5-8-后行断言"><a href="#5-8-后行断言" class="headerlink" title="5.8 后行断言"></a>5.8 后行断言</h2><p>提案阶段，在<code>ES7</code>中加入。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_7 数组的扩展/" itemprop="url">
                  7 数组的扩展(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T21:59:22+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_7 数组的扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_7 数组的扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="7-1-Array-from"><a href="#7-1-Array-from" class="headerlink" title="7.1 Array.from()"></a>7.1 Array.from()</h2><p><strong>功能：</strong>可以将两类对象转为真正的数组，从而使用数组丰富的方法</p>
<ul>
<li><code>类似数组的对象（array-like object）</code>：即存在 length 属性的对象</li>
<li><code>可遍历（iterable）的对象</code>，包括 ES6 新增的数据结构 Set 和 Map</li>
</ul>
<p><strong>注意：</strong> 类数组对象也可以通过 <code>call</code>或<code>apply</code>的方式强行调用<code>Array</code> 数组的方法</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>参数1</td>
<td>可以被转为数组的对象</td>
<td></td>
</tr>
<tr>
<td>参数2</td>
<td>类似数组的 map 方法</td>
</tr>
<tr>
<td>参数3</td>
<td>要绑定的上下文</td>
</tr>
</tbody>
</table>
<h3 id="7-1-1-转换类数组对象中为数组"><a href="#7-1-1-转换类数组对象中为数组" class="headerlink" title="7.1.1 转换类数组对象中为数组"></a>7.1.1 转换类数组对象中为数组</h3><ul>
<li>DOM 操作返回的 NodeList 集合</li>
<li>函数内部的 arguments 对象</li>
<li>自定义的类数组对象</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1. 自定义的类数组对象 */</span></span><br><span class="line"><span class="keyword">let</span> arrayLike = &#123;</span><br><span class="line">    <span class="string">'0'</span>: <span class="string">'a'</span>,</span><br><span class="line">    <span class="string">'1'</span>: <span class="string">'b'</span>,</span><br><span class="line">    <span class="string">'2'</span>: <span class="string">'c'</span>,</span><br><span class="line">    length: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5的写法</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [].slice.call(arrayLike); <span class="comment">// ['a', 'b', 'c']</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的写法</span></span><br><span class="line"><span class="keyword">let</span> arr2 = <span class="built_in">Array</span>.from(arrayLike); <span class="comment">// ['a', 'b', 'c']</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2. DOM 操作返回的 NodeList 集合 */</span></span><br><span class="line"><span class="comment">// NodeList对象</span></span><br><span class="line"><span class="keyword">let</span> ps = <span class="built_in">document</span>.querySelectorAll(<span class="string">'p'</span>);</span><br><span class="line"><span class="built_in">Array</span>.from(ps).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">p</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(p);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*3. 函数内部的 Arguments 对象*/</span></span><br><span class="line"><span class="comment">// arguments对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> args = <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>);</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-1-2-es5环境下的-polyfill"><a href="#7-1-2-es5环境下的-polyfill" class="headerlink" title="7.1.2 es5环境下的 polyfill"></a>7.1.2 es5环境下的 polyfill</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toArray = (() =&gt;</span><br><span class="line">	<span class="built_in">Array</span>.from ? <span class="built_in">Array</span>.from : obj =&gt; [].slice.call(obj)</span><br><span class="line">)()</span><br></pre></td></tr></table></figure>
<h3 id="7-1-3-第二个参数"><a href="#7-1-3-第二个参数" class="headerlink" title="7.1.3 第二个参数"></a>7.1.3 第二个参数</h3><p><strong>说明：</strong>租用类似于数组的 <code>map</code>方法，用来对每个元素进行处理，将处理后的值放在返回的数组中</p>
<h4 id="7-1-3-1-基础"><a href="#7-1-3-1-基础" class="headerlink" title="7.1.3.1 基础"></a>7.1.3.1 基础</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(arrayLike, x =&gt; x * x);</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="built_in">Array</span>.from(arrayLike).map(x =&gt; x * x);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.from([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], (x) =&gt; x * x)</span><br><span class="line"><span class="comment">// [1, 4, 9]</span></span><br></pre></td></tr></table></figure>
<h4 id="7-1-3-2-几个例子"><a href="#7-1-3-2-几个例子" class="headerlink" title="7.1.3.2 几个例子"></a>7.1.3.2 几个例子</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1. 取出一组DOM节点的文本内容 */</span></span><br><span class="line"><span class="keyword">let</span> spans = <span class="built_in">document</span>.querySelectorAll(<span class="string">'span.name'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// es5的方式：map()</span></span><br><span class="line"><span class="keyword">let</span> names1 = <span class="built_in">Array</span>.prototype.map.call(spans, s =&gt; s.textContent);</span><br><span class="line"></span><br><span class="line"><span class="comment">// es6的方式：Array.from()</span></span><br><span class="line"><span class="keyword">let</span> names2 = <span class="built_in">Array</span>.from(spans, s =&gt; s.textContent)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2. 将数组中不饿日志为 false 的成员转为 0 */</span></span><br><span class="line"><span class="built_in">Array</span>.from([<span class="number">1</span>, ,<span class="number">2</span>, ,<span class="number">3</span>], (n) =&gt; n || <span class="number">0</span>)</span><br><span class="line"><span class="comment">// [1, 0, 2, 0, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3. 返回各种数据的类型 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">typeof</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>, value =&gt; <span class="keyword">typeof</span> value)</span><br><span class="line">&#125;</span><br><span class="line">typedsOf(<span class="literal">null</span>, [], <span class="literal">NaN</span>)</span><br><span class="line"><span class="comment">// ['object', 'object', 'number']</span></span><br></pre></td></tr></table></figure>
<h4 id="7-1-3-3-扩展运算符"><a href="#7-1-3-3-扩展运算符" class="headerlink" title="7.1.3.3 扩展运算符"></a>7.1.3.3 扩展运算符</h4><p><strong>说明：</strong>扩展运算符也可以将可遍历对象（即部署了便利器接口<code>Symbol.iterator</code>）转换为数组，但不支持类数组对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// arguments对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> args = [...arguments];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NodeList对象</span></span><br><span class="line">[...document.querySelectorAll(<span class="string">'div'</span>)]</span><br></pre></td></tr></table></figure>
<h4 id="7-1-3-4-奇技淫巧"><a href="#7-1-3-4-奇技淫巧" class="headerlink" title="7.1.3.4 奇技淫巧"></a>7.1.3.4 奇技淫巧</h4><ul>
<li><p>利用第一个参数的 length 属性和第二个参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(&#123; length: <span class="number">2</span> &#125;, () =&gt; <span class="string">'jack'</span>)</span><br><span class="line"><span class="comment">// ['jack', 'jack']</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>返回字符串的长度（能正确处理各种<code>Unicode</code>字符， 避免 JS 将大于<code>\uFFFF</code>的Unicode的字符算作两个字符的 bug）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">countSymbols</span>(<span class="params">string</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(string).length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="7-2-Array-of"><a href="#7-2-Array-of" class="headerlink" title="7.2 Array.of()"></a>7.2 Array.of()</h2><p><strong>功能：</strong>将一组值转换为数组<br><strong>说明：</strong><code>Array.of</code>基本可以用来替代<code>Array()</code>或<code>new Array()</code>，并且不存在由于参数不同而导致的重载</p>
<h3 id="7-2-1-Array-of-vs-Array"><a href="#7-2-1-Array-of-vs-Array" class="headerlink" title="7.2.1 Array.of() vs. Array()"></a>7.2.1 Array.of() vs. Array()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>() <span class="comment">// []</span></span><br><span class="line"><span class="built_in">Array</span>(<span class="number">3</span>) <span class="comment">// [, , ,]</span></span><br><span class="line"><span class="built_in">Array</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3, 11, 8]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.of() <span class="comment">// []</span></span><br><span class="line"><span class="built_in">Array</span>.of(<span class="literal">undefined</span>) <span class="comment">// [undefined]</span></span><br><span class="line"><span class="built_in">Array</span>.of(<span class="number">1</span>) <span class="comment">// [1]</span></span><br><span class="line"><span class="built_in">Array</span>.of(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// [1, 2]</span></span><br></pre></td></tr></table></figure>
<h3 id="7-2-2-polyfill"><a href="#7-2-2-polyfill" class="headerlink" title="7.2.2 polyfill"></a>7.2.2 polyfill</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ArrayOf</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-3-数组实例的-copyWithin"><a href="#7-3-数组实例的-copyWithin" class="headerlink" title="7.3 数组实例的 copyWithin()"></a>7.3 数组实例的 copyWithin()</h2><p><code>Array 实例方法 copyWithin()</code><br><strong>功能：</strong>将指定位置的成员复制到其他位置（会覆盖原有成员），然后返回当前数组<br><strong>注意：</strong>参数都为数值，如果不是，会自动转为数值</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471704903931.png" alt="Alt text"></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>是否必需</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>target</td>
<td>目的地 起点下标</td>
<td>是</td>
</tr>
<tr>
<td>start</td>
<td>源 起点下标</td>
<td>否</td>
<td>默认为0,如果为负值，表示倒数</td>
</tr>
<tr>
<td>end</td>
<td>源 终点下标 + 1</td>
<td>否</td>
<td>默认为0，如果为负数，表示倒数</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将3号位复制到0号位</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="comment">// [4, 2, 3, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// -2相当于3号位，-1相当于4号位</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">-2</span>, <span class="number">-1</span>)</span><br><span class="line"><span class="comment">// [4, 2, 3, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将3号位复制到0号位</span></span><br><span class="line">[].copyWithin.call(&#123;length: <span class="number">5</span>, <span class="number">3</span>: <span class="number">1</span>&#125;, <span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment">// &#123;0: 1, 3: 1, length: 5&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将2号位到数组结束，复制到0号位</span></span><br><span class="line"><span class="keyword">var</span> i32a = <span class="keyword">new</span> <span class="built_in">Int32Array</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]);</span><br><span class="line">i32a.copyWithin(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// Int32Array [3, 4, 5, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对于没有部署TypedArray的copyWithin方法的平台</span></span><br><span class="line"><span class="comment">// 需要采用下面的写法</span></span><br><span class="line">[].copyWithin.call(<span class="keyword">new</span> <span class="built_in">Int32Array</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]), <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">// Int32Array [4, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
<h2 id="7-4-数组实例的-find-和-findIndex"><a href="#7-4-数组实例的-find-和-findIndex" class="headerlink" title="7.4 数组实例的 find() 和 findIndex()"></a>7.4 数组实例的 find() 和 findIndex()</h2><p><strong>注意：</strong>这两个方法都能够发现<code>NaN</code>，ni</p>
<h3 id="7-4-1-find"><a href="#7-4-1-find" class="headerlink" title="7.4.1 find()"></a>7.4.1 find()</h3><p><strong>功能：</strong>找到第一个符合条件的数组成员<br><strong>返回值：</strong>第一个返回值为<code>true</code>的成员 ，没有则返回 <code>undefined</code></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>参数1（必需）</td>
<td>一个回调函数，所有数组成员会依次执行该回调</td>
</tr>
<tr>
<td>参数2（可选）</td>
<td>回调函数执行的上下文</td>
</tr>
</tbody>
</table>
<h4 id="回调函数（第一个参数）"><a href="#回调函数（第一个参数）" class="headerlink" title="回调函数（第一个参数）"></a>回调函数（第一个参数）</h4><table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>value</td>
<td>当前成员值</td>
</tr>
<tr>
<td>index</td>
<td>当前成员下标</td>
</tr>
<tr>
<td>arr</td>
<td>原数组</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">-5</span>].find((n) =&gt; n &lt; <span class="number">0</span>)<span class="comment">//-5</span></span><br><span class="line"></span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">12</span>].find(fcuntion (value, index, arr) &#123;</span><br><span class="line">	<span class="keyword">return</span> value &gt; <span class="number">9</span></span><br><span class="line">&#125;)<span class="comment">// 10</span></span><br></pre></td></tr></table></figure>
<h3 id="7-4-1-findIndex"><a href="#7-4-1-findIndex" class="headerlink" title="7.4.1 findIndex()"></a>7.4.1 findIndex()</h3><p><strong>功能：</strong>找到第一个符合条件的数组成员的位置<br><strong>返回值：</strong>找到则返回成员位置，否则返回 -1<br><strong>注意：</strong>除了返回值是成员的位置而不是成员本身外，其它方面和 <code>find()</code>完全一致</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="literal">NaN</span>].indexOf(<span class="literal">NaN</span>)</span><br><span class="line"><span class="comment">// -1</span></span><br><span class="line"></span><br><span class="line">[<span class="literal">NaN</span>].findIndex(y =&gt; <span class="built_in">Object</span>.is(<span class="literal">NaN</span>, y))</span><br><span class="line"><span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<h2 id="7-5-数组实例的-fill"><a href="#7-5-数组实例的-fill" class="headerlink" title="7.5 数组实例的 fill()"></a>7.5 数组实例的 fill()</h2><p><strong>功能：</strong>使用给定值填充数组，数组中已有的元素会被全部抹去<br><strong>是否有副作用：</strong>是<br><strong>返回值：</strong>新数组</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>参数1（必需）</td>
<td>填充数组的元素</td>
</tr>
<tr>
<td>参数2（可选）</td>
<td>填充的开始位置</td>
</tr>
<tr>
<td>参数3（可选）</td>
<td>填充的结束位置</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].fill(<span class="number">7</span>)<span class="comment">// [7, 7, 7]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>).fill(<span class="number">7</span>)<span class="comment">// [7, 7, 7 ]</span></span><br><span class="line"></span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].fill(<span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>)<span class="comment">// ['a', 7, 'c']</span></span><br></pre></td></tr></table></figure>
<h2 id="7-6-数组实例的-entries-keys-和values"><a href="#7-6-数组实例的-entries-keys-和values" class="headerlink" title="7.6 数组实例的 entries(), keys()和values()"></a>7.6 数组实例的 entries(), keys()和values()</h2><p><strong>用途：</strong>都针对特定方面遍历数组<br><strong>返回值：</strong>便利器对象，可以通过<code>for-of</code>循环便利器对象的 <code>next</code> 方法进行遍历<br>方法|说明<br>-|-<br>keys()|返回数组中<code>key</code>的遍历器对象<br>values()|返回数组中<code>value</code>的遍历器对象<br>entries()|返回数组中<code>key-value</code>的遍历器对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> index <span class="keyword">of</span> [<span class="string">'a'</span>, <span class="string">'b'</span>].keys()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> elem <span class="keyword">of</span> [<span class="string">'a'</span>, <span class="string">'b'</span>].values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 'a'</span></span><br><span class="line"><span class="comment">// 'b'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [index, elem] <span class="keyword">of</span> [<span class="string">'a'</span>, <span class="string">'b'</span>].entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index, elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0 "a"</span></span><br><span class="line"><span class="comment">// 1 "b"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> letter = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"><span class="keyword">let</span> entries = letter.entries();</span><br><span class="line">entries.next().value; <span class="comment">// [0, 'a']</span></span><br><span class="line">entries.next().value; <span class="comment">// [1, 'b']</span></span><br><span class="line">entries.next().value; <span class="comment">// [2, 'c']</span></span><br></pre></td></tr></table></figure>
<h2 id="7-7-数组实例的-includes"><a href="#7-7-数组实例的-includes" class="headerlink" title="7.7 数组实例的 includes()"></a>7.7 数组实例的 includes()</h2><p><strong>功能：</strong>判断数组中是否包含给定的值<br><strong>返回值：</strong><code>true</code> 存在， <code>false</code> 不存在<br><strong>支持：</strong>该方法属于<code>ES7</code>，但 <code>Babel</code>转码器已经支持<br>参数|说明<br>-|-<br>参数1（必需）|要搜索的 <code>value</code><br>参数2（可选）|搜索的开始位置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>);     <span class="comment">// true</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">4</span>);     <span class="comment">// false</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="literal">NaN</span>].includes(<span class="literal">NaN</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="7-7-1-includes-vs-indexOf"><a href="#7-7-1-includes-vs-indexOf" class="headerlink" title="7.7.1 includes() vs. indexOf()"></a>7.7.1 includes() vs. indexOf()</h3><p>如果用<code>indexOf()</code>替代<code>includes()</code>来确定数组中是否包含给定的值，存在两个问题</p>
<ol>
<li>不够语意化，而且还要比较下标是否不等于-1</li>
<li><code>indexOf()</code>内部使用<code>===</code>进行判断，会导致对<code>NaN</code>的误判</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="literal">NaN</span>].indexOf(<span class="literal">NaN</span>)</span><br><span class="line"><span class="comment">// -1</span></span><br><span class="line"></span><br><span class="line">[<span class="literal">NaN</span>].includes(<span class="literal">NaN</span>)</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="7-7-2-polyfill"><a href="#7-7-2-polyfill" class="headerlink" title="7.7.2 polyfill"></a>7.7.2 polyfill</h3><p>使用<code>Array.prototype.some</code>实现<code>includes</code>功能<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> contains = (() =&gt;</span><br><span class="line">	<span class="built_in">Array</span>.prototype.includes</span><br><span class="line">		? (arr, vaue) =&gt; arr.includes(value)</span><br><span class="line">		: (arr, value) =&gt; arr.some(el =&gt; el === value)</span><br><span class="line">)()</span><br><span class="line"></span><br><span class="line">contrains([<span class="string">'foo'</span>, <span class="string">'bar'</span>], <span class="string">'baz'</span>)<span class="comment">// false</span></span><br></pre></td></tr></table></figure></p>
<h3 id="7-7-3-Map-和-Set"><a href="#7-7-3-Map-和-Set" class="headerlink" title="7.7.3 Map 和 Set"></a>7.7.3 Map 和 Set</h3><p><strong>说明：</strong><code>Map</code> 和 <code>Set</code>数据结构有一个<code>has</code>方法，需要注意和<code>includes</code>区分 </p>
<p><strong>Map 结构的<code>has</code>方法</strong>：用来查找<code>key</code></p>
<ul>
<li>Map.prototype.has(key)</li>
<li>WeakMap.prototype.has(key)</li>
<li>Reflect.has(target, propertyKey)</li>
</ul>
<p><strong>Set 结构的<code>has</code>方法</strong>：用来查找值</p>
<ul>
<li>Set.prototype.has(value)</li>
<li>WeakSet.prototype.has(value)</li>
</ul>
<h2 id="7-8-数组的空位"><a href="#7-8-数组的空位" class="headerlink" title="7.8 数组的空位"></a>7.8 数组的空位</h2><p><strong>说明：</strong>数组中没有任何值的元素就是一个数组的空位<br><strong>注意：</strong>空位不是<code>undefined</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>(<span class="number">3</span>) <span class="comment">// [, , ,]</span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span> <span class="keyword">in</span> [<span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>] <span class="comment">// true</span></span><br><span class="line"><span class="number">0</span> <span class="keyword">in</span> [, , ,] <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="7-8-1-ES5对空位的处理"><a href="#7-8-1-ES5对空位的处理" class="headerlink" title="7.8.1 ES5对空位的处理"></a>7.8.1 ES5对空位的处理</h3><table>
<thead>
<tr>
<th>数组方法</th>
<th>空位的处理</th>
</tr>
</thead>
<tbody>
<tr>
<td>forEach()</td>
<td>跳过空位</td>
</tr>
<tr>
<td>filter()</td>
<td>跳过空位</td>
</tr>
<tr>
<td>every()</td>
<td>跳过空位</td>
</tr>
<tr>
<td>some()</td>
<td>跳过空位</td>
</tr>
<tr>
<td>map()</td>
<td>跳过空位,但返回的数组中仍保留着这个空位</td>
</tr>
<tr>
<td>join()</td>
<td>将空位是为<code>undefined</code>（<code>undefined、null</code>会被处理成空字符串）</td>
</tr>
<tr>
<td>toString()</td>
<td>将空位是为<code>undefined</code>（<code>undefined、null</code>会被处理成空字符串）</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// forEach方法</span></span><br><span class="line">[,<span class="string">'a'</span>].forEach((x,i) =&gt; <span class="built_in">console</span>.log(i)); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// filter方法</span></span><br><span class="line">[<span class="string">'a'</span>,,<span class="string">'b'</span>].filter(x =&gt; <span class="literal">true</span>) <span class="comment">// ['a','b']</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// every方法</span></span><br><span class="line">[,<span class="string">'a'</span>].every(x =&gt; x===<span class="string">'a'</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// some方法</span></span><br><span class="line">[,<span class="string">'a'</span>].some(x =&gt; x !== <span class="string">'a'</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// map方法</span></span><br><span class="line">[,<span class="string">'a'</span>].map(x =&gt; <span class="number">1</span>) <span class="comment">// [,1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// join方法</span></span><br><span class="line">[,<span class="string">'a'</span>,<span class="literal">undefined</span>,<span class="literal">null</span>].join(<span class="string">'#'</span>) <span class="comment">// "#a##"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// toString方法</span></span><br><span class="line">[,<span class="string">'a'</span>,<span class="literal">undefined</span>,<span class="literal">null</span>].toString() <span class="comment">// ",a,,"</span></span><br></pre></td></tr></table></figure>
<h3 id="7-8-2-ES6对空位的处理"><a href="#7-8-2-ES6对空位的处理" class="headerlink" title="7.8.2 ES6对空位的处理"></a>7.8.2 ES6对空位的处理</h3><p><strong>注意：</strong>由于空位处理规则非常不统一，所以建议避免出现空位<br>运算|说明<br>-|-<br>Array.from()|不会忽略空位，而是将空位转为<code>undefined</code><br>扩展运算符|不会忽略空位，而是将空位转为<code>undefined</code><br>copyWithin()|连空位一起拷贝<br>fill()|将空位视为正常的数组位置<br>for-of|会遍历空位<br>entries()、keys()、values()、find()、findIndex()|会将空位处理成<code>undefined</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from([<span class="string">'a'</span>,,<span class="string">'b'</span>])</span><br><span class="line"><span class="comment">// [ "a", undefined, "b" ]</span></span><br><span class="line"></span><br><span class="line">[...[<span class="string">'a'</span>,,<span class="string">'b'</span>]]</span><br><span class="line"><span class="comment">// [ "a", undefined, "b" ]</span></span><br><span class="line"></span><br><span class="line">[,<span class="string">'a'</span>,<span class="string">'b'</span>,,].copyWithin(<span class="number">2</span>,<span class="number">0</span>) <span class="comment">// [,"a",,"a"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>).fill(<span class="string">'a'</span>) <span class="comment">// ["a","a","a"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [, ,];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> arr) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// entries()</span></span><br><span class="line">[...[,<span class="string">'a'</span>].entries()] <span class="comment">// [[0,undefined], [1,"a"]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// keys()</span></span><br><span class="line">[...[,<span class="string">'a'</span>].keys()] <span class="comment">// [0,1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// values()</span></span><br><span class="line">[...[,<span class="string">'a'</span>].values()] <span class="comment">// [undefined,"a"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// find()</span></span><br><span class="line">[,<span class="string">'a'</span>].find(x =&gt; <span class="literal">true</span>) <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// findIndex()</span></span><br><span class="line">[,<span class="string">'a'</span>].findIndex(x =&gt; <span class="literal">true</span>) <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/es6_8 函数的扩展/" itemprop="url">
                  8 函数的扩展(ECMAScript6入门)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T21:58:52+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/es6_8 函数的扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/es6_8 函数的扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="8-1-函数参数的默认值"><a href="#8-1-函数参数的默认值" class="headerlink" title="8.1 函数参数的默认值"></a>8.1 函数参数的默认值</h2><h3 id="8-1-1-ES6之前"><a href="#8-1-1-ES6之前" class="headerlink" title="8.1.1 ES6之前"></a>8.1.1 ES6之前</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span> (<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">typeof</span> y === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">		y = <span class="string">'World'</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">console</span>.log(x, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-1-2-基本用法"><a href="#8-1-2-基本用法" class="headerlink" title="8.1.2 基本用法"></a>8.1.2 基本用法</h3><p><strong>说明：</strong>ES6允许为函数的参数设置默认值，即直接写在参数定义的后面。</p>
<ul>
<li>阅读代码的人，可以立刻意识到哪些参数是可以省略的，不用查看函数或文档</li>
<li>有理由将来的代码优化，即使未来的版本在对外接口中，彻底拿掉这个参数，也不回导致以前的代码无法运行</li>
</ul>
<p><strong>注意：</strong>参数变量是默认声明的，不能用<code>let</code>或<code>const</code>再次声明，否则会报错<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span> (<span class="params">x, y = 'World'</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(x, y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">log (<span class="string">'Hello'</span>)<span class="comment">// Hello World</span></span><br><span class="line">log (<span class="string">'Hello'</span>, China)<span class="comment">// Hello China</span></span><br><span class="line">log (<span class="string">'Hello'</span>, <span class="string">''</span>)<span class="comment">// Hello</span></span><br></pre></td></tr></table></figure></p>
<h3 id="8-1-3-与解构赋值默认值结合使用"><a href="#8-1-3-与解构赋值默认值结合使用" class="headerlink" title="8.1.3 与解构赋值默认值结合使用"></a>8.1.3 与解构赋值默认值结合使用</h3><p><strong>案例1</strong>：只使用解构赋值默认值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">&#123;x, y = 5&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(&#123;&#125;) <span class="comment">// undefined, 5</span></span><br><span class="line">foo(&#123;x: <span class="number">1</span>&#125;) <span class="comment">// 1, 5</span></span><br><span class="line">foo(&#123;x: <span class="number">1</span>, y: <span class="number">2</span>&#125;) <span class="comment">// 1, 2</span></span><br><span class="line">foo() <span class="comment">// TypeError: Cannot read property 'x' of undefined</span></span><br></pre></td></tr></table></figure></p>
<p><strong>案例二</strong>：只使用解构赋值默认值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetch</span>(<span class="params">url, &#123; body = '', method = 'GET', headers = &#123;&#125; &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(method);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">'http://example.com'</span>, &#123;&#125;)</span><br><span class="line"><span class="comment">// "GET"</span></span><br><span class="line"></span><br><span class="line">fetch(<span class="string">'http://example.com'</span>)</span><br><span class="line"><span class="comment">// 报错</span></span><br></pre></td></tr></table></figure></p>
<p><strong>案例三</strong>：双重默认值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">st=&gt;start: 开始</span><br><span class="line">cond1=&gt;condition: 判断第二个参数是不是 undefined</span><br><span class="line">op1=&gt;operation: 参数默认值生效 </span><br><span class="line">cond2=&gt;condition: 参数默认值中 method 是否是 undefined</span><br><span class="line">op2=&gt;operation: 解构赋值中 method 默认值生效</span><br><span class="line">op3=&gt;operation: 参数默认值不生效</span><br><span class="line">op4=&gt;operation: method 通过结构赋值获取值</span><br><span class="line">op5=&gt;operation: 使用传入的 method 值</span><br><span class="line">cond4=&gt;condition: 判断是不是能够解构</span><br><span class="line">op7=&gt;operation: 解构失败（报错）</span><br><span class="line">op8=&gt;operation: method最终为 undefined</span><br><span class="line">e=&gt;end: 结束</span><br><span class="line"></span><br><span class="line">st-&gt;cond1</span><br><span class="line">cond1(yes)-&gt;op1</span><br><span class="line">cond1(no)-&gt;cond4</span><br><span class="line">cond4(yes)-&gt;op4-&gt;e</span><br><span class="line">cond4(no)-&gt;op7-&gt;e</span><br><span class="line">cond2(yes)-&gt;op7-&gt;e</span><br><span class="line">cond2(no)-&gt;op</span><br><span class="line">op1-&gt;cond2</span><br><span class="line">cond2(yes)-&gt;op2</span><br><span class="line">op2-&gt;e</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetch</span>(<span class="params">url, &#123; method = 'GET' &#125; = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(method);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">'http://example.com'</span>)</span><br><span class="line"><span class="comment">// "GET"</span></span><br></pre></td></tr></table></figure>
<p><strong>案例四</strong>：通过对比深入理解<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 写法一:解构中提供默认值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">m1</span>(<span class="params">&#123;x = 0, y = 0&#125; = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法二：默认参数中提供默认值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">m2</span>(<span class="params">&#123;x, y&#125; = &#123; x: 0, y: 0 &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数没有参数的情况</span></span><br><span class="line">m1() <span class="comment">// [0, 0]</span></span><br><span class="line">m2() <span class="comment">// [0, 0]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// x和y都有值的情况</span></span><br><span class="line">m1(&#123;x: <span class="number">3</span>, y: <span class="number">8</span>&#125;) <span class="comment">// [3, 8]</span></span><br><span class="line">m2(&#123;x: <span class="number">3</span>, y: <span class="number">8</span>&#125;) <span class="comment">// [3, 8]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// x有值，y无值的情况</span></span><br><span class="line">m1(&#123;x: <span class="number">3</span>&#125;) <span class="comment">// [3, 0]</span></span><br><span class="line">m2(&#123;x: <span class="number">3</span>&#125;) <span class="comment">// [3, undefined]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// x和y都无值的情况</span></span><br><span class="line">m1(&#123;&#125;) <span class="comment">// [0, 0];</span></span><br><span class="line">m2(&#123;&#125;) <span class="comment">// [undefined, undefined]</span></span><br><span class="line"></span><br><span class="line">m1(&#123;z: <span class="number">3</span>&#125;) <span class="comment">// [0, 0]</span></span><br><span class="line">m2(&#123;z: <span class="number">3</span>&#125;) <span class="comment">// [undefined, undefined]</span></span><br></pre></td></tr></table></figure></p>
<h3 id="8-1-4-参数默认值的位置"><a href="#8-1-4-参数默认值的位置" class="headerlink" title="8.1.4 参数默认值的位置"></a>8.1.4 参数默认值的位置</h3><p> <strong>说明：</strong>给函数传递参数时，可以通过<code>空位</code>省略某个参数。但如果函数定义时某个参数有默认值，传递<code>空位</code>给它会报错。<br> <strong>技巧：</strong>因为设置了默认值的参数后面有没设置默认值的参数时，前者将不能通过<code>空位</code>省略。因此应该将设置了默认值的参数都排在后面。<br> <strong>注意：</strong>传入<code>undefined</code>将触发该参数等于默认值，<code>null</code>则没有这个效果。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例一</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x = 1, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f() <span class="comment">// [1, undefined]</span></span><br><span class="line">f(<span class="number">2</span>) <span class="comment">// [2, undefined])</span></span><br><span class="line">f(, <span class="number">1</span>) <span class="comment">// 报错</span></span><br><span class="line">f(<span class="literal">undefined</span>, <span class="number">1</span>) <span class="comment">// [1, 1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 例二</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y = 5, z</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y, z];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f() <span class="comment">// [undefined, 5, undefined]</span></span><br><span class="line">f(<span class="number">1</span>) <span class="comment">// [1, 5, undefined]</span></span><br><span class="line">f(<span class="number">1</span>, ,<span class="number">2</span>) <span class="comment">// 报错</span></span><br><span class="line">f(<span class="number">1</span>, <span class="literal">undefined</span>, <span class="number">2</span>) <span class="comment">// [1, 5, 2]</span></span><br></pre></td></tr></table></figure></p>
<h3 id="8-1-5-函数的-length-属性"><a href="#8-1-5-函数的-length-属性" class="headerlink" title="8.1.5 函数的 length 属性"></a>8.1.5 函数的 length 属性</h3><p><code>length属性：</code>函数预期传入的参数个数</p>
<ul>
<li>某个参数指定默认值以后，<code>length</code>就不计入这个参数了</li>
<li>rest 参数也不会计入 <code>length</code> </li>
<li>设置了默认值的参数后面的参数，无论是否设置了默认值，都不再计入 <code>length</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 参数指定默认值 */</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;&#125;).length <span class="comment">// 1</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a = 5</span>) </span>&#123;&#125;).length <span class="comment">// 0</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a, b, c = 5</span>) </span>&#123;&#125;).length <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* rest 参数 */</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;&#125;).length <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设置了默认值的参数后面的参数 */</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a = 0, b, c</span>) </span>&#123;&#125;).length <span class="comment">// 0</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a, b = 1, c</span>) </span>&#123;&#125;).length <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h3 id="8-1-5-作用域"><a href="#8-1-5-作用域" class="headerlink" title="8.1.5 作用域"></a>8.1.5 作用域</h3><p> <strong>说明：</strong>参数和其默认值引起的一些作用域问题分析。<br> <strong>参数的作用域：</strong>参数声明的过程也是变量声明的过程，参数的作用域和函数内部是一致的<br> <code>函数局部作用域 -&gt; 全局作用域</code></p>
<ol>
<li>参数默认值为其它声明在前面的参数</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局变量 x</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 由于前面的参数又声明了一个 x， 因此 y = x 中的 x 是局部声明的这个 x。全局的 x 被屏蔽</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y = x</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f(<span class="number">2</span>)<span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<ol>
<li>参数默认值为其它全局变量</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数赋值默认值这个运算的上线文在函数定义时就形成了</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">y = x</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 内部定义的这个局部变量 x 能屏蔽全局的 x，但无法屏蔽参数默认值对全局 x 的引用，事实上，默认值赋值的过程远在内部声明 x 之前就完成了</span></span><br><span class="line">  <span class="keyword">let</span> x = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f() <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<ol>
<li>默认参数的变量在函数作用域和全局作用域都没有找到变量</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">y = x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> x = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f() <span class="comment">// ReferenceError: x is not defined</span></span><br></pre></td></tr></table></figure>
<ol>
<li>暂时性死区</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// x = x 右值部分寻找 x 时发现函数作用域内存在 x ，但此时 x 还未声明，处于暂时性死区，因而报错</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x = x</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo() <span class="comment">// ReferenceError: x is not defined</span></span><br></pre></td></tr></table></figure>
<ol>
<li>参数的默认值是一个函数<br>作为默认值的匿名函数在函数<code>bar</code>定义时被定义，JS<code>静态作用域</code>的特点决定了此时其作用域已经被确定，只能是全局作用域(因为函数定义阶段作用域链中只有全局对象，活动对象在函数调用阶段才会被创建)<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y = function(</span>) </span>&#123;<span class="comment">/* 根据静态作用域的特点，这个 x 的作用域在一开始就确定了，x 始终指向全局的那个 x */</span>x = <span class="number">2</span>; &#125;) &#123;</span><br><span class="line">  <span class="keyword">var</span> x = <span class="number">3</span>;</span><br><span class="line">  y();</span><br><span class="line">  <span class="comment">// 这个时候访问的 x 是函数作用域中声明的那个 x ，全局的 x 被屏蔽了</span></span><br><span class="line">  <span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo() <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="8-1-6-应用"><a href="#8-1-6-应用" class="headerlink" title="8.1.6 应用"></a>8.1.6 应用</h3><p>可以指定某一个参数不得省略，如果省略就抛出一个错误</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throwIfMissing</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Missing parameter'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数的默认值不是在定义时执行，而是在运行时执行（即如果参数已经赋值，默认值中的函数就不会运行）</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">mustBeProvided = throwIfMissing(</span>)) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> mustBeProvided;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// foo 函数执行时默认值 throwIfMissing() 才执行，mustBeProcided取得的 是 throwIfMissing() 的返回值</span></span><br><span class="line">foo()</span><br><span class="line"><span class="comment">// Error: Missing parameter</span></span><br></pre></td></tr></table></figure>
<h2 id="8-2-rest-参数"><a href="#8-2-rest-参数" class="headerlink" title="8.2 rest 参数"></a>8.2 rest 参数</h2><p><strong>说明：</strong>S6引入rest参数，形式为<code>...变量名</code>，用于获取函数的多余参数</p>
<ul>
<li>相比 arugments ，rest参数的写法更自然也更简洁</li>
<li>rest参数中的变量代表一个数组，所以数组特有的方法都可以用于这个变量</li>
<li>函数的<code>length</code>属性，不计入rest参数</li>
</ul>
<p><strong>用途：</strong>这样就不需要使用<code>arguments</code>对象了<br><strong>注意：</strong>rest参数之后不能再有其他参数（即只能是最后一个参数），否则会报错<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// arguments变量的写法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sortNumbers</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>).sort();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// rest参数的写法</span></span><br><span class="line"><span class="keyword">const</span> sortNumbers = (...numbers) =&gt; numbers.sort();</span><br></pre></td></tr></table></figure></p>
<h2 id="8-3-扩展运算符"><a href="#8-3-扩展运算符" class="headerlink" title="8.3 扩展运算符"></a>8.3 扩展运算符</h2><h3 id="8-3-1-含义"><a href="#8-3-1-含义" class="headerlink" title="8.3.1 含义"></a>8.3.1 含义</h3><p> <strong>扩展运算符：</strong>用于将数组变为参数序列<br> <strong>说明：</strong>相当于<code>rest</code>参数的逆运算</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">array, ...items</span>) </span>&#123;</span><br><span class="line">  array.push(...items);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> numbers = [<span class="number">4</span>, <span class="number">38</span>];</span><br><span class="line">add(...numbers) <span class="comment">// 42</span></span><br></pre></td></tr></table></figure>
<h3 id="8-3-2-替代数组的-apply-方法"><a href="#8-3-2-替代数组的-apply-方法" class="headerlink" title="8.3.2 替代数组的 apply 方法"></a>8.3.2 替代数组的 apply 方法</h3><p> <strong>说明：</strong>使用<code>apply</code>方法的一种用途就是让数组中的每个元素分别作为实参传递到方法中，但这个需求使用扩展运算符实现更加直观简洁。<br> <strong>举个栗子：</strong>下面说三个例子</p>
<ul>
<li><code>Math.max()</code></li>
<li><code>Array.prototype.push()</code></li>
<li><code>new Date()</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 案例一：Math.max() */</span></span><br><span class="line"><span class="comment">// ES5的写法</span></span><br><span class="line"><span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, [<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的写法</span></span><br><span class="line"><span class="built_in">Math</span>.max(...[<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>])<span class="comment">// Math.max(14, 3, 77);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 案例二：Array.prototype.push() */</span></span><br><span class="line"><span class="comment">// ES5的写法</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="built_in">Array</span>.prototype.push.apply(arr1, arr2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的写法</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">arr1.push(...arr2);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 案例三：new Date() */</span></span><br><span class="line"><span class="comment">// ES5</span></span><br><span class="line"><span class="keyword">new</span> (<span class="built_in">Date</span>.bind.apply(<span class="built_in">Date</span>, [<span class="literal">null</span>, <span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>]))</span><br><span class="line"><span class="comment">// ES6</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(...[<span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>]);</span><br></pre></td></tr></table></figure>
<h3 id="8-3-3-扩展运算符的应用"><a href="#8-3-3-扩展运算符的应用" class="headerlink" title="8.3.3 扩展运算符的应用"></a>8.3.3 扩展运算符的应用</h3><h4 id="8-3-3-1-合并数组"><a href="#8-3-3-1-合并数组" class="headerlink" title="8.3.3.1 合并数组"></a>8.3.3.1 合并数组</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES5</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>].concat(more)</span><br><span class="line"><span class="comment">// ES6</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, ...more]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="string">'a'</span>, <span class="string">'b'</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="string">'c'</span>];</span><br><span class="line"><span class="keyword">var</span> arr3 = [<span class="string">'d'</span>, <span class="string">'e'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5的合并数组</span></span><br><span class="line">arr1.concat(arr2, arr3);</span><br><span class="line"><span class="comment">// [ 'a', 'b', 'c', 'd', 'e' ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的合并数组</span></span><br><span class="line">[...arr1, ...arr2, ...arr3]</span><br><span class="line"><span class="comment">// [ 'a', 'b', 'c', 'd', 'e' ]</span></span><br></pre></td></tr></table></figure>
<h4 id="8-3-3-2-与解构赋值结合"><a href="#8-3-3-2-与解构赋值结合" class="headerlink" title="8.3.3.2 与解构赋值结合"></a>8.3.3.2 与解构赋值结合</h4><p> <strong>说明：</strong>可以达从数组中到获取子数组的目的<br> <strong>注意：</strong>如果将扩展运算符用于数组赋值，只能放在参数的最后一位，否则会报错</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES5</span></span><br><span class="line">a = list[<span class="number">0</span>]<span class="comment">// 获取 list 数组第一个值</span></span><br><span class="line">rest = list.slice(<span class="number">1</span>)<span class="comment">// 获取 list 数组其余的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6</span></span><br><span class="line">[a, ...rest] = list</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">first <span class="comment">// 1</span></span><br><span class="line">rest  <span class="comment">// [2, 3, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = [];</span><br><span class="line">first <span class="comment">// undefined</span></span><br><span class="line">rest  <span class="comment">// []:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="string">"foo"</span>];</span><br><span class="line">first  <span class="comment">// "foo"</span></span><br><span class="line">rest   <span class="comment">// []</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [...butLast, last] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="comment">// 报错</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [first, ...middle, last] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
<h4 id="8-3-3-3-函数的返回值"><a href="#8-3-3-3-函数的返回值" class="headerlink" title="8.3.3.3 函数的返回值"></a>8.3.3.3 函数的返回值</h4><p> <strong>说明：</strong><code>JS</code>函数如果想返回多个值，只能以数组或对象的方式返回。其中数组形式的返回值用扩展运算符处理非常合适。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dateFields = readDateFields(database);</span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(...dateFields);</span><br></pre></td></tr></table></figure>
<h4 id="8-3-3-4-字符串"><a href="#8-3-3-4-字符串" class="headerlink" title="8.3.3.4 字符串"></a>8.3.3.4 字符串</h4><p> <strong>说明：</strong>扩展运算符可以将字符串转为真正的数组<br> <strong>注意：</strong>能够正确处理<code>32</code>位的 <code>Unicode</code>字符</p>
<ul>
<li><p><strong>正确获取字符串的 length</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[...<span class="string">'hello'</span>]</span><br><span class="line"><span class="comment">// [ "h", "e", "l", "l", "o" ]</span></span><br><span class="line"></span><br><span class="line"><span class="string">'x\uD83D\uDE80y'</span>.length <span class="comment">// 4，这种方式，JavaScript会将32位Unicode字符，识别为2个字符</span></span><br><span class="line">[...<span class="string">'x\uD83D\uDE80y'</span>].length <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>正确 split 字符串</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">'x\uD83D\uDE80y'</span>;</span><br><span class="line"></span><br><span class="line">str.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</span><br><span class="line"><span class="comment">// 'y\uDE80\uD83Dx'</span></span><br><span class="line"></span><br><span class="line">[...str].reverse().join(<span class="string">''</span>)</span><br><span class="line"><span class="comment">// 'y\uD83D\uDE80x'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="8-3-3-5-实现-Iterator-接口的对象"><a href="#8-3-3-5-实现-Iterator-接口的对象" class="headerlink" title="8.3.3.5 实现 Iterator 接口的对象"></a>8.3.3.5 实现 Iterator 接口的对象</h4><p> <strong>说明：</strong>任何<code>Iterator</code>接口的对象，都可以用扩展运算符转为真正的数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nodeList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'div'</span>);</span><br><span class="line"><span class="keyword">var</span> array = [...nodeList];</span><br></pre></td></tr></table></figure>
<h4 id="8-3-3-6-Map和Set结构，Generator-函数"><a href="#8-3-3-6-Map和Set结构，Generator-函数" class="headerlink" title="8.3.3.6 Map和Set结构，Generator 函数"></a>8.3.3.6 Map和Set结构，Generator 函数</h4><p> <strong>说明：</strong>扩展运算符内部调用的是数据结构的Iterator接口，因此只要具有Iterator接口的对象，都可以使用扩展运算符，比如</p>
<ul>
<li>Map 结构</li>
<li>Set 结构</li>
<li>Generator 函数返回值</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Map 结构 */</span></span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [<span class="number">1</span>, <span class="string">'one'</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="string">'two'</span>],</span><br><span class="line">  [<span class="number">3</span>, <span class="string">'three'</span>],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// map.keys() 返回一个便利器对象</span></span><br><span class="line"><span class="keyword">let</span> arr = [...map.keys()]; <span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Set 结构 */</span></span><br><span class="line"><span class="keyword">var</span> go = <span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// go() 返回一个遍历器对象</span></span><br><span class="line">[...go()] <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure>
<h2 id="8-4-name属性"><a href="#8-4-name属性" class="headerlink" title="8.4 name属性"></a>8.4 name属性</h2><p> <strong>说明：</strong>函数的<code>name</code>属性，返回该函数的函数名</p>
<table>
<thead>
<tr>
<th>es5和es6的对比</th>
<th>es5</th>
<th>es6</th>
</tr>
</thead>
<tbody>
<tr>
<td>是否加入到标准</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>匿名函数赋值给一个变量， name 属性值</td>
<td>空字符串</td>
<td>变量名</td>
</tr>
<tr>
<td>具名函数赋值给一个变量，name 属性值</td>
<td>函数本来的名字</td>
<td>函数本来的名字</td>
</tr>
<tr>
<td>(new Function).name</td>
<td><code>anonymous</code></td>
<td><code>anonymous</code></td>
</tr>
<tr>
<td>bind返回的函数，name属性值</td>
<td>“bound 函数名”</td>
<td>“bound 函数名”</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 匿名函数赋值给一个变量 */</span></span><br><span class="line"><span class="keyword">var</span> func1 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5</span></span><br><span class="line">func1.name <span class="comment">// ""</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6</span></span><br><span class="line">func1.name <span class="comment">// "func1"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Function构造函数返回的函数实例 */</span></span><br><span class="line">(<span class="keyword">new</span> <span class="built_in">Function</span>).name <span class="comment">// "anonymous"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* bind返回的函数 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">foo.bind(&#123;&#125;).name <span class="comment">// "bound foo"</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).bind(&#123;&#125;).name <span class="comment">// "bound "</span></span><br></pre></td></tr></table></figure>
<h2 id="8-5-箭头函数"><a href="#8-5-箭头函数" class="headerlink" title="8.5 箭头函数"></a>8.5 箭头函数</h2><p> <strong>说明：</strong>是一种特殊的函数，相比传统的函数</p>
<ul>
<li>表达更加简洁</li>
<li><p>绑定<code>this</code>，没有传统函数<code>this</code>指向变化带来的困扰</p>
<p><strong>常见用途：</strong>简化回调函数</p>
</li>
</ul>
<h3 id="8-5-1-基本用法"><a href="#8-5-1-基本用法" class="headerlink" title="8.5.1 基本用法"></a>8.5.1 基本用法</h3><p><code>参数 =&gt; 表达式</code><br>参数部分|说明<br>-|-<br>没有参数|<code>()</code><br>1个参数|<code>(参数)</code>或<code>参数</code><br>>1个参数|<code>(参数1, 参数2, ...)</code></p>
<table>
<thead>
<tr>
<th>表达式部分</th>
<th>结构</th>
<th>返回值</th>
</tr>
</thead>
<tbody>
<tr>
<td>单个语句</td>
<td><code>语句</code></td>
<td>表达式本身的运算结果</td>
</tr>
<tr>
<td>多个语句</td>
<td><code>{语句1; 语句2; return 语句3}</code></td>
<td><code>return</code>的部分</td>
</tr>
<tr>
<td>直接返回对象</td>
<td><code>(对象字面量)</code></td>
<td>对象字面量</td>
</tr>
</tbody>
</table>
<ul>
<li><p>如果箭头函数不需要参数或需要多个参数，就使用一个圆括号代表参数部分</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 没有参数 */</span></span><br><span class="line"><span class="keyword">var</span> f = () =&gt; <span class="number">5</span>;<span class="comment">// var f = function () &#123; return 5 &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 单个参数 */</span></span><br><span class="line"><span class="keyword">var</span> f = v =&gt; v;</span><br><span class="line"><span class="comment">// var f = function (v) &#123;</span></span><br><span class="line"><span class="comment">//	return v;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 多个参数 */</span></span><br><span class="line"><span class="keyword">var</span> sum = (num1, num2) =&gt; num1 + num2;</span><br><span class="line"><span class="comment">// var sum = function(num1, num2) &#123;</span></span><br><span class="line"><span class="comment">//  return num1 + num2;</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果箭头函数的代码块部分多于一条语句，就要使用<code>{}</code>将它们括起来，并且使用<code>return</code>语句返回</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = (num1, num2) =&gt; &#123;</span><br><span class="line">	<span class="keyword">const</span> pi = <span class="number">3.14</span>;</span><br><span class="line">	<span class="keyword">return</span> (num1 + num2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>由于<code>{}</code>被解释为<code>代码块</code>，所以如果箭头函数直接返回一个对象，必须在对象外面加上<code>()</code></p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getTempItem = id =&gt; (&#123;id: id, name: <span class="string">"Temp"</span>&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li><p>与<code>变量解构</code>结合使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> full = (&#123;first, last&#125;) =&gt; first + <span class="string">' '</span> + last;</span><br><span class="line"><span class="comment">// function full(person) &#123;</span></span><br><span class="line"><span class="comment">//  return person.first + ' ' + person.last;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>与 rest 参数结合使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">* 将参数转换为数组</span><br><span class="line">* @param &#123;可变参数&#125; </span><br><span class="line">*/</span></span><br><span class="line"><span class="keyword">const</span> numbers = (...nums) =&gt; nums;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="8-5-2-使用注意点"><a href="#8-5-2-使用注意点" class="headerlink" title="8.5.2 使用注意点"></a>8.5.2 使用注意点</h3><ol>
<li>函数体内的<code>this</code>对象，就是定义时所在的对象，而不是使用时所在的对象</li>
<li>不可以当作构造函数，也就是说，不可以使用<code>new</code>命令，否则会抛出一个错误</li>
<li>不可以使用<code>arguments</code>对象，该对象在函数体内不存在。如果要用，可以用<code>Rest</code>参数代替</li>
<li>不可以使用<code>yield</code>命令，因此箭头函数不能用作<code>Generator</code>函数</li>
</ol>
<h4 id="箭头函数的this"><a href="#箭头函数的this" class="headerlink" title="箭头函数的this"></a>箭头函数的<code>this</code></h4><p> <strong>说明：</strong><code>this</code>指向的固定化，并不是因为箭头函数内部有绑定<code>this</code>的机制，实际原因是箭头函数根本没有自己的<code>this</code>，导致内部的this就是外层代码块的<code>this</code>。正是因为它没有<code>this</code>，所以也就不能用作构造函数。<br> <strong>用途：</strong>箭头函数可以让<code>this</code>指向固定化，这种特性很有利于封装回调函数<br> <strong>注意：</strong>由于箭头函数没有自己的<code>this</code>，所以当然也就不能用<code>call()、apply()、bind()</code>这些方法去改变<code>this</code>的指向</p>
<p><em>原理说明</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES6</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">	<span class="comment">// 箭头函数里面根本没有自己的this，而是引用外层的this</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'id:'</span>, <span class="keyword">this</span>.id);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'id:'</span>, _this.id);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>改变 this 无效</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">	<span class="comment">// 箭头函数没有自己的this，所以bind方法无效，内部的this指向外部的this</span></span><br><span class="line">    (() =&gt; <span class="keyword">this</span>.x).bind(&#123; x: <span class="string">'inner'</span> &#125;)()</span><br><span class="line">  ];</span><br><span class="line">&#125;).call(&#123; x: <span class="string">'outer'</span> &#125;);</span><br><span class="line"><span class="comment">// ['outer']</span></span><br></pre></td></tr></table></figure></p>
<h3 id="8-5-3-嵌套的箭头函数"><a href="#8-5-3-嵌套的箭头函数" class="headerlink" title="8.5.3 嵌套的箭头函数"></a>8.5.3 嵌套的箭头函数</h3><p><em>管道函数</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 管道机制：前一个函数的输出是后一个函数的输入 */</span></span><br><span class="line"><span class="keyword">const</span> pipeline = (...funcs) =&gt;</span><br><span class="line">	val =&gt; funcs.reduce((a, b) =&gt; b(a), val);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line">* @param &#123;...Function&#125; funcs 需要进行管道运算的一个一个函数</span><br><span class="line">*/</span></span><br><span class="line"><span class="comment">//var pipeline = function (...funcs) &#123;</span></span><br><span class="line"><span class="comment">//  /**</span></span><br><span class="line"><span class="comment">//  * @val &#123;Number&#125; 初始值</span></span><br><span class="line"><span class="comment">//  */</span></span><br><span class="line"><span class="comment">//	return function (val) &#123;</span></span><br><span class="line"><span class="comment">//		return funcs.reduce(function (a, b) &#123;</span></span><br><span class="line"><span class="comment">//			return b(a)</span></span><br><span class="line"><span class="comment">//		&#125;, val)</span></span><br><span class="line"><span class="comment">//	&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> plus1 = a =&gt; a + <span class="number">1</span>;<span class="comment">// 返回增加1后的值</span></span><br><span class="line"><span class="keyword">const</span> mult2 = a =&gt; a + <span class="number">2</span>;<span class="comment">// 返回增加2后的值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addThenMult = pipeline(plus1, mult2);</span><br><span class="line">addThenMult(<span class="number">5</span>)<span class="comment">// 12</span></span><br></pre></td></tr></table></figure></p>
<p><em>ℷ演算</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// λ演算的写法</span></span><br><span class="line">fix = λf.(λx.f(λv.x(x)(v)))(λx.f(λv.x(x)(v)))</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6的写法</span></span><br><span class="line"><span class="keyword">var</span> fix = f =&gt; (x =&gt; f(v =&gt; x(x)(v)))</span><br><span class="line">               (x =&gt; f(v =&gt; x(x)(v)));</span><br></pre></td></tr></table></figure></p>
<h2 id="8-6-函数绑定"><a href="#8-6-函数绑定" class="headerlink" title="8.6 函数绑定"></a>8.6 函数绑定</h2><p> <strong>函数绑定运算符：</strong><code>对象::函数名</code><br> <strong>功能：</strong>该运算符会自动将左边的对象，作为上下文环境（即 this 对象），绑定到右边的函数上面，然后返回</p>
<ul>
<li>如果左边（对象）为空，右边是一个<code>对象的方法</code>，则等于将该方法绑定到该对象上面</li>
<li><p>某些情况下可以采用链式写法</p>
<p><strong>用途：</strong>用来取代<code>call、apply、bind</code>调用<br><strong>兼容性：</strong>只是一个<code>ES7</code>的提案，但<code>Babel</code>转码器已经支持</p>
</li>
</ul>
<p><em>取代 bind、 apply</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 取代 bind */</span></span><br><span class="line">contextObj::bar</span><br><span class="line"><span class="comment">// bar.bind(contextObj)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 取代 apply */</span></span><br><span class="line">contextObj::bar(...arguments)</span><br><span class="line"><span class="comment">// bar.apply(contextObj, arguments)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hasOwnProperty = <span class="built_in">Object</span>.prototype.hasOwnProperty;</span><br><span class="line"><span class="comment">/**</span><br><span class="line">* 判断对象中是否存在某个值</span><br><span class="line">* @param &#123;obj&#125; 对象</span><br><span class="line">* @param &#123;key&#125; 属性名</span><br><span class="line">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasOwn</span>(<span class="params">obj, key</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> obj::hasOwnProperty(key);</span><br><span class="line">	<span class="comment">// return hasOwnProperty.call(obj);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>简写的情形</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> method = obj::obj.foo;</span><br><span class="line"><span class="comment">// var method = ::obj.foo;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> log = ::<span class="built_in">console</span>.log;</span><br><span class="line"><span class="comment">// var log = console.log.bind(console.log)</span></span><br></pre></td></tr></table></figure></p>
<p><em>链式写法</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 例子1 */</span></span><br><span class="line"><span class="keyword">import</span> &#123; map, takeWhile, forEach &#125; <span class="keyword">from</span> <span class="string">"iterlib"</span></span><br><span class="line"></span><br><span class="line">getPlayers()</span><br><span class="line">::map(x =&gt; x.character())</span><br><span class="line">::takeWhile(x =&gt; x.strength &gt; <span class="number">100</span>)</span><br><span class="line">::forEach(x =&gt; <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure></p>
<h2 id="8-7-尾调用优化"><a href="#8-7-尾调用优化" class="headerlink" title="8.7 尾调用优化"></a>8.7 尾调用优化</h2><h3 id="8-7-1-什么是尾调用？"><a href="#8-7-1-什么是尾调用？" class="headerlink" title="8.7.1 什么是尾调用？"></a>8.7.1 什么是尾调用？</h3><p> <strong>答：</strong>指函数的最后一步是调用另一个函数<br> <strong>注意：</strong>尾调用不一定出现在函数尾部，只要是最后一步操作即可<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 正确的尾调用 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> g(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> m(x)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> n(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 容易被误解为尾调用的情形 */</span></span><br><span class="line"><span class="comment">// 情况一：调用函数g之后，还有赋值操作</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> y = g(x);</span><br><span class="line">  <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况二：调用后还有加运算</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> g(x) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况三：最后还有一个隐含的 return undefined 的操作</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">  g(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="8-7-2-尾调用优化"><a href="#8-7-2-尾调用优化" class="headerlink" title="8.7.2 尾调用优化"></a>8.7.2 尾调用优化</h3><p> <strong>说明：</strong><code>JS</code> 引擎在处理<code>尾调用函数</code>的时候会比<code>普通函数</code>有更好的内存性能<br> <strong>调用帧：</strong>函数调用在内存中形成的一个调用记录，保存调用位置和内部变量等信息<br> <strong>调用栈：</strong>如果A调用了B，非尾调用会在A的调用帧上方形成一个B的调用帧，一次类推，形成一个<code>调用栈</code>;尾调用由于是函数的最后一步操作，所以不需要保留外层函数的调用帧，只要直接用内层函数的调用帧，取代外层函数的饿调用帧<br> <strong>注意：</strong>只有不再用到外层函数的内部变量，内层函数的调用帧才会取代外层函数的调用帧，否则就无法进行“尾调用优化”。</p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1472366383179.png" alt="Alt text"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不会进行尾调用优化，因为内层函数inner用到了外层函数addOne的内部变量one</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addOne</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> one = <span class="number">1</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">inner</span>(<span class="params">b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b + one;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> inner(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-7-3-尾递归"><a href="#8-7-3-尾递归" class="headerlink" title="8.7.3 尾递归"></a>8.7.3 尾递归</h3><p> <strong>尾递归：</strong>尾递归调用自身<br> <strong>说明：</strong>因为同时保存成千上百给调用帧，递归容易造成<code>栈溢出</code>，但尾递归不回，因为只存在一个调用帧<br> <strong>注意：</strong>ES6第一次明确规定，所有<code>ECMAScript</code>的实现，都必需部署<code>尾调用优化</code>。</p>
<h4 id="8-7-3-1-计算-n-的阶乘"><a href="#8-7-3-1-计算-n-的阶乘" class="headerlink" title="8.7.3.1 计算 n 的阶乘"></a>8.7.3.1 计算 n 的阶乘</h4><p><em>尾调用</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">* 递归计算阶乘</span><br><span class="line">* @param &#123;Number&#125; n 几的阶乘</span><br><span class="line">* @param &#123;Number&#125; total 当前一次乘积值</span><br><span class="line">* @return &#123;Number&#125; 返回的值并不使用，也没有意义，只是为了构成尾递归</span><br><span class="line">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span> (<span class="params">n, total</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</span><br><span class="line">	<span class="keyword">return</span> factorial(n - <span class="number">1</span>, n * total);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">factorial(<span class="number">5</span>, <span class="number">1</span>)<span class="comment">// 120</span></span><br></pre></td></tr></table></figure></p>
<p><em>非尾调用</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">functon factorial (n) &#123;</span><br><span class="line">	<span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> n * factional(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="8-7-3-2-fibonacci递归算法"><a href="#8-7-3-2-fibonacci递归算法" class="headerlink" title="8.7.3.2 fibonacci递归算法"></a>8.7.3.2 fibonacci递归算法</h4><p><em>尾调用</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">* 递归计算 fibonacii 数列的和</span><br><span class="line">* @param &#123;Number&#125; 在几以下的 fibonacci 数列</span><br><span class="line">* @param &#123;Number&#125; ac1 fibonacii 的第一个值</span><br><span class="line">* @param &#123;Number&#125; ac2 fibonacii 的第二个值</span><br><span class="line">* @return &#123;Number&#125; fibonacii 数列的和</span><br><span class="line">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fibonacci</span> (<span class="params">n, ac1 = 1, ac2 = 1</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (n &lt;=<span class="number">1</span>) <span class="keyword">return</span> ac2;</span><br><span class="line">	<span class="keyword">return</span> fibonacci(n <span class="number">-1</span>, ac2, ac1 + ac2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>非尾调用</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fibonacii</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (n &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> fibonacci(n - <span class="number">1</span>) + gibonacci(n - <span class="number">2</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="8-7-4-递归函数的改写"><a href="#8-7-4-递归函数的改写" class="headerlink" title="8.7.4 递归函数的改写"></a>8.7.4 递归函数的改写</h3><p> <strong>说明：</strong>把所有用到的内部变量改写成函数的参数，确保最后一步只调用自身<br> <strong>技巧：</strong>解决<code>尾递归</code>参数不太易读的问题</p>
<ol>
<li>在尾递归函数之外，再提供一个正常形式的函数</li>
<li>将函数柯里化（currying），意思是将多参数的函数转换成单参数的形式 </li>
<li>采用ES6的函数默认值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 尾递归函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tailFactorial</span>(<span class="params">n, total</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</span><br><span class="line">  <span class="keyword">return</span> tailFactorial(n - <span class="number">1</span>, n * total);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1. 在尾递归函数之外，再提供一个正常形式的函数 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial1</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> tailFactorial(n, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">factorial1(<span class="number">5</span>) <span class="comment">// 120</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2. 将函数柯里化（currying），意思是将多参数的函数转换成单参数的形式 */</span></span><br><span class="line"><span class="comment">/**</span><br><span class="line">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">currying</span>(<span class="params">fn, n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">m</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fn.call(<span class="keyword">this</span>, m, n);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> factorial2 = currying(tailFactorial, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">factorial2(<span class="number">5</span>) <span class="comment">// 120</span></span><br><span class="line"><span class="comment">/* 3. 采用ES6的函数默认值 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial3</span>(<span class="params">n, total = 1</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</span><br><span class="line">  <span class="keyword">return</span> factorial(n - <span class="number">1</span>, n * total);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">factorial3(<span class="number">5</span>) <span class="comment">// 120</span></span><br></pre></td></tr></table></figure>
<h3 id="8-7-5-严格模式"><a href="#8-7-5-严格模式" class="headerlink" title="8.7.5 严格模式"></a>8.7.5 严格模式</h3><p> <strong>说明：</strong><code>ES6</code>的尾递归优化值在严格模式下开启，正常模式是无效的<br> <strong>原理：</strong>因为在正常模式下，函数内部有两个变量，可以跟踪函数的调用栈。严格模式下，尾调用优化发生，函数的调用栈会改写，因此上面两个变量就会失真</p>
<ul>
<li>func.arguments：返回调用时函数的参数</li>
<li>func.caller：返回调用当前函数的那个函数</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">restricted</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">  "use strict"</span>;</span><br><span class="line">  restricted.caller;    <span class="comment">// 报错</span></span><br><span class="line">  restricted.arguments; <span class="comment">// 报错</span></span><br><span class="line">&#125;</span><br><span class="line">restricted();</span><br></pre></td></tr></table></figure>
<h3 id="8-7-6-尾递归优化的实现"><a href="#8-7-6-尾递归优化的实现" class="headerlink" title="8.7.6 尾递归优化的实现"></a>8.7.6 尾递归优化的实现</h3><p> <strong>说明：</strong>正常模式下，或者那些不支持该功能的环境中，可以自己实现尾递归优化。这里提供两种方式</p>
<ol>
<li>利用蹦床函数，将递归执行转为循环执行（需要改写尾递归函数本身）</li>
<li>真正的自己实现的尾递归优化（不需要改写递归函数本身）</li>
</ol>
<h4 id="8-7-6-1-利用蹦床函数"><a href="#8-7-6-1-利用蹦床函数" class="headerlink" title="8.7.6.1 利用蹦床函数"></a>8.7.6.1 利用蹦床函数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (y &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> sum.bind(<span class="literal">null</span>, x + <span class="number">1</span>, y - <span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// function sum(x, y) &#123;</span></span><br><span class="line"><span class="comment">//  if (y &gt; 0) &#123;</span></span><br><span class="line"><span class="comment">//    return sum(x + 1, y - 1);</span></span><br><span class="line"><span class="comment">//  &#125; else &#123;</span></span><br><span class="line"><span class="comment">//    return x;</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 蹦床函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trampoline</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (f &amp;&amp; f <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</span><br><span class="line">    f = f();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">trampoline(sum(<span class="number">1</span>, <span class="number">100000</span>))</span><br><span class="line"><span class="comment">// 100001</span></span><br></pre></td></tr></table></figure>
<h4 id="8-7-6-2-真正实现"><a href="#8-7-6-2-真正实现" class="headerlink" title="8.7.6.2 真正实现"></a>8.7.6.2 真正实现</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tco</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> value;</span><br><span class="line">  <span class="keyword">var</span> active = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">var</span> accumulated = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">accumulator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    accumulated.push(<span class="built_in">arguments</span>);</span><br><span class="line">    <span class="keyword">if</span> (!active) &#123;</span><br><span class="line">      active = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">while</span> (accumulated.length) &#123;</span><br><span class="line">        value = f.apply(<span class="keyword">this</span>, accumulated.shift());</span><br><span class="line">      &#125;</span><br><span class="line">      active = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum = tco(<span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (y &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> sum(x + <span class="number">1</span>, y - <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">sum(<span class="number">1</span>, <span class="number">100000</span>)</span><br><span class="line"><span class="comment">// 100001</span></span><br></pre></td></tr></table></figure>
<h2 id="8-8-函数参数的尾逗号"><a href="#8-8-函数参数的尾逗号" class="headerlink" title="8.8 函数参数的尾逗号"></a>8.8 函数参数的尾逗号</h2><p> <strong>说明：</strong>允许函数的最后一个参数有尾逗号<br> <strong>注意：</strong>目前数定义和调用时，都不允许有参数的尾逗号<br> <strong>支持：</strong><code>ES7</code>的一个提案<br> <strong>用途：</strong>在定义函数时，如果参数单独占一行，增加参数时，之前最后一个参数后面要加一个逗号，版本管理系统就会显示，添加逗号的那一行也发生了变动。如果之前最后一个参数后面就有<code>,</code>，就没有这个问题了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clownsEverywhere</span>(<span class="params"></span><br><span class="line">  param1,</span><br><span class="line">  param2,</span><br><span class="line"></span>) </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"></span><br><span class="line">clownsEverywhere(</span><br><span class="line">  <span class="string">'foo'</span>,</span><br><span class="line">  <span class="string">'bar'</span>,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/imooc_JavaScript 正则表达式/" itemprop="url">
                  未命名
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-30T21:39:18+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/imooc_JavaScript 正则表达式/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/imooc_JavaScript 正则表达式/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#JavaScript 正则表达式<br>@(慕课网学习笔记)[web, 正则表达式, js]</p>
<p>[toc]</p>
<p><strong>视频地址：</strong><a href="http://www.imooc.com/learn/706" target="_blank" rel="external">http://www.imooc.com/learn/706</a><br><strong>推荐在线练习工具：</strong><a href="http://jsbin.com/xakojudara/edit?js,console" target="_blank" rel="external">http://jsbin.com/xakojudara/edit?js,console</a></p>
<h1 id="1-课程简介"><a href="#1-课程简介" class="headerlink" title="1 课程简介"></a>1 课程简介</h1><p>课程目标</p>
<ul>
<li>了解正则表达式语法</li>
<li>在IDE中使用正则表达式处理规则复杂的字符串查找、替换需求</li>
<li>在 JavaScript 程序设计中使用正则表达式处理字符串</li>
</ul>
<h2 id="1-1-正则表达式简介及工具使用"><a href="#1-1-正则表达式简介及工具使用" class="headerlink" title="1.1 正则表达式简介及工具使用"></a>1.1 正则表达式简介及工具使用</h2><h3 id="1-1-1-什么是正则表达式"><a href="#1-1-1-什么是正则表达式" class="headerlink" title="1.1.1 什么是正则表达式"></a>1.1.1 什么是正则表达式</h3><p><code>Regular Expression</code> 使用单个字符串来描述、匹配一系列符合某个句法规则的字符串。就是按照某种规则去匹配符合条件的字符串。</p>
<h3 id="1-1-2-正则表达式工具－REGEXPER"><a href="#1-1-2-正则表达式工具－REGEXPER" class="headerlink" title="1.1.2 正则表达式工具－REGEXPER"></a>1.1.2 正则表达式工具－REGEXPER</h3><blockquote>
<p><strong>REGEXPER：</strong><a href="https://regexper.com" target="_blank" rel="external">正则表达式在线工具</a>，可以以非常形象的方式展现具体正则表达式的含义。</p>
</blockquote>
<p>＃举例：匹配邮箱<br><code>^(a-zA-Z0-9_-)+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$</code></p>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471072343598.png" alt="Alt text"></p>
<h1 id="2-认识正则表达式"><a href="#2-认识正则表达式" class="headerlink" title="2 认识正则表达式"></a>2 认识正则表达式</h1><h2 id="2-1-RegExp对象"><a href="#2-1-RegExp对象" class="headerlink" title="2.1 RegExp对象"></a>2.1 RegExp对象</h2><h3 id="2-1-1-基本用法"><a href="#2-1-1-基本用法" class="headerlink" title="2.1.1 基本用法"></a>2.1.1 基本用法</h3><p><code>JavaScript</code>通过内置对象 <code>RegExp</code>支持正则表达式。有两种方法实例化<code>RegExp</code>对象</p>
<ul>
<li><p>字面量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/\bis\b/g</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// "He IS a boy.This IS a dog. Where IS she?"</span></span><br><span class="line"><span class="string">'He is a boy.This is a dog. Where is she?'</span>.replace(reg, <span class="string">'IS'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>构造函数<br>注意：字符串本身能识别类似<code>\b</code>形式的转义字符，为了避免字符串误解，传递给<code>RegExp</code>构造函数的第一个参数中的<code>\</code>都需要转义为<code>\\</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'\\bis\\b'</span>, <span class="string">'g'</span>);</span><br><span class="line"><span class="comment">// "He IS a boy.This IS a dog. Where IS she?"</span></span><br><span class="line"><span class="string">'He is a boy.This is a dog. Where is she?'</span>.replace(reg, <span class="string">'IS'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-1-2-修饰符"><a href="#2-1-2-修饰符" class="headerlink" title="2.1.2 修饰符"></a>2.1.2 修饰符</h3><table>
<thead>
<tr>
<th>修饰符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>g</td>
<td>global。 全文搜索。默认搜索到第一个匹配停止</td>
</tr>
<tr>
<td>i</td>
<td>ignore case。忽略大小写。默认大小写敏感</td>
</tr>
<tr>
<td>m</td>
<td>multiple lines。 多行搜索，在存在<code>\n</code>的字符串中会影响表达式中<code>^</code>和<code>$</code>的行为。</td>
</tr>
</tbody>
</table>
<h2 id="2-2-元字符"><a href="#2-2-元字符" class="headerlink" title="2.2 元字符"></a>2.2 元字符</h2><blockquote>
<p>说明：正则表达式由两种基本字符类型组成<br>字符类型|说明|举例<br>-|-|-<br>原意文本字符|按照字符本身匹配|abc|<br>元字符|在正则表达式中有特殊含义的非字母字符|<code>. * + ? $ ^ \| \ () {} []</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>元字符中的转义字符</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>\t</td>
<td>水平制表符<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471075632133.png" alt="Alt text"></td>
</tr>
<tr>
<td>\v</td>
<td>垂直制表符<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471075663582.png" alt="Alt text"></td>
</tr>
<tr>
<td>\n</td>
<td>换行符<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471075688304.png" alt="Alt text"></td>
</tr>
<tr>
<td>\r</td>
<td>回车符<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471075717069.png" alt="Alt text"></td>
</tr>
<tr>
<td>\0</td>
<td>空字符<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471075742302.png" alt="Alt text"></td>
</tr>
<tr>
<td>\f</td>
<td>换页符<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471075759837.png" alt="Alt text"></td>
</tr>
<tr>
<td>\cX</td>
<td>与X对应的控制字符（ctrl + X）<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471075779742.png" alt="Alt text"></td>
</tr>
</tbody>
</table>
<h2 id="2-3-字符类"><a href="#2-3-字符类" class="headerlink" title="2.3 字符类"></a>2.3 字符类</h2><h3 id="2-3-1-基础"><a href="#2-3-1-基础" class="headerlink" title="2.3.1 基础"></a>2.3.1 基础</h3><p><code>[]</code></p>
<blockquote>
<p><strong>说明：</strong>我们可以使用元字符<code>[]</code>来构建一个简单的类。所谓类是指符合某些特性的对象，一个泛指，而不是特指某个字符。</p>
</blockquote>
<p><strong>举例</strong><br><code>[abc]</code>，把字符<code>a</code>或<code>b</code>或<code>c</code>归为一类，表达式可以匹配这类的字符。<br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471076119291.png" alt="Alt text"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// "X1X2X3d4"</span></span><br><span class="line"><span class="string">'a1b2c3d4'</span>.replace(<span class="regexp">/[abc]/g</span>, <span class="string">'X'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="2-3-2-字符类取反"><a href="#2-3-2-字符类取反" class="headerlink" title="2.3.2 字符类取反"></a>2.3.2 字符类取反</h3><blockquote>
<p><strong>说明：</strong>在<code>[]</code>中使用元字符<code>^</code>创建<code>反向类／负向类</code>,意思是不属于某类的内容。</p>
</blockquote>
<p><strong>举例</strong><br>表达式<code>[^abc]</code>，表示<em>不是字符a或b或c</em>的内容</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// "aXbXcXXX"</span></span><br><span class="line"><span class="string">'a1b2c3d4'</span>.replace(<span class="regexp">/[^abc]/g</span>, <span class="string">'X'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="2-4-范围类"><a href="#2-4-范围类" class="headerlink" title="2.4 范围类"></a>2.4 范围类</h2><p>正则表达式还提供了<code>范围类</code>。例如，可以使用<code>[a-z]</code>来连接两个字符表示<em>从 a 到 z 的任意字符</em>，这是个闭区间，也就是包涵 a 和 z 本身。<br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471076736409.png" alt="Alt text"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'a1b2c3d4Hello'</span>.replace(<span class="regexp">/[a-z]/g</span>, <span class="string">'X'</span>)</span><br><span class="line"><span class="string">"X1X2X3X4HXXXX"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：形式为<code>[字符1-字符1]</code>的正则中的<code>-</code>都会被识别为<code>范围类</code>，若真的想使用<code>-</code>本身，要么在<code>[]</code>外部使用，要么类似<code>[字符1-字符2-]</code>，其中最后一个<code>-</code>会本当做原意文本字符。</p>
<h2 id="2-5-预定义类及边界"><a href="#2-5-预定义类及边界" class="headerlink" title="2.5 预定义类及边界"></a>2.5 预定义类及边界</h2><h3 id="2-5-1-预定义类"><a href="#2-5-1-预定义类" class="headerlink" title="2.5.1 预定义类"></a>2.5.1 预定义类</h3><p>正则表达式提供<code>预定义类</code>来匹配常见的字符类<br>字符|等价类|含义<br>-|-|-<br>.|[^\r\n]|除回车符和换行符之外的所有字符<br>\d|[0-9]|数字字符<br>\D|[^0-9]|非数字字符<br>\s|[\t\n\x0B\f\r]|空白符<br>\S|[^\t\n\x\0B\f\r]|非空白符<br>\w|[a-zA-Z_0-9]|单词字符（字母、数字、下划线）<br>\W|[^a-zA-Z_0-9]|非单词字符</p>
</blockquote>
<h3 id="2-5-2-边界"><a href="#2-5-2-边界" class="headerlink" title="2.5.2 边界"></a>2.5.2 边界</h3><p>正则表达式还提供了几个常用的边界匹配字符<br>字符|含义<br>-|-<br>^|一行的开始<br>$|一行的结尾<br>\b|单词边界<br>\B|非单词边界</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'@123@abc'</span>.replace(<span class="regexp">/^@./g</span>, <span class="string">'X'</span>)</span><br><span class="line"><span class="string">"X23@abc"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：m 修饰符将会影响 $ 和 ^ 的行为</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var mulStr = '@123\n@456\n@789'</span><br><span class="line">// 使用 m 修饰符：\n 被当做多行的分隔</span><br><span class="line">mulStr.replace(/^@\d/gm, 'X')</span><br><span class="line">"X23</span><br><span class="line">X56</span><br><span class="line">X89"</span><br><span class="line"></span><br><span class="line">// 不使用 m 修饰符：\n 不会被当做多行的分隔</span><br><span class="line">mulStr.replace(/^@\d/g, 'X')</span><br><span class="line">"X23</span><br><span class="line">@456</span><br><span class="line">@789"</span><br></pre></td></tr></table></figure>
<h2 id="2-6-量词"><a href="#2-6-量词" class="headerlink" title="2.6 量词"></a>2.6 量词</h2><table>
<thead>
<tr>
<th>量词</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>最多出现一次（0次或1次）</td>
</tr>
<tr>
<td>+</td>
<td>至少出现一次（1次或多次）</td>
</tr>
<tr>
<td>*</td>
<td>出现0次或多次（任意次）</td>
</tr>
<tr>
<td>{n}</td>
<td>出现 n 次</td>
</tr>
<tr>
<td>{n,m}</td>
<td>出现 n 到 m 次</td>
</tr>
<tr>
<td>{n,}</td>
<td>至少出现 n 次</td>
</tr>
</tbody>
</table>
<p><strong>举例</strong><br><code>\d{20}\w\d?\w+\d*\d{3}\w{3,5}\d{3,}</code><br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471090337589.png" alt="Alt text"></p>
<blockquote>
<p>技巧：最多出现 n 次可以这样表示<code>{0, n}</code></p>
<h2 id="2-7-贪婪模式与非贪婪模式"><a href="#2-7-贪婪模式与非贪婪模式" class="headerlink" title="2.7 贪婪模式与非贪婪模式"></a>2.7 贪婪模式与非贪婪模式</h2><table>
<thead>
<tr>
<th>模式</th>
<th>说明</th>
<th>方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>贪婪模式｜尽可能多地匹配字符</td>
<td>默认</td>
</tr>
<tr>
<td>非贪婪模式</td>
<td>尽可能少地匹配字符，也就是说一旦成功匹配就不再继续尝试</td>
<td>在量词后使用<code>?</code>即可</td>
</tr>
</tbody>
</table>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 贪婪模式</span></span><br><span class="line"><span class="string">'123456789'</span>.match(<span class="regexp">/\d&#123;3,5&#125;/g</span>)</span><br><span class="line"><span class="comment">// ["12345", "6789"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 非贪婪模式</span></span><br><span class="line"><span class="string">'123456789'</span>.match(<span class="regexp">/\d&#123;3,5&#125;?/g</span>)</span><br><span class="line"><span class="comment">// ["123", "456", "789"]</span></span><br></pre></td></tr></table></figure>
<h2 id="2-8-分组"><a href="#2-8-分组" class="headerlink" title="2.8 分组"></a>2.8 分组</h2><h3 id="2-8-1-基础"><a href="#2-8-1-基础" class="headerlink" title="2.8.1 基础"></a>2.8.1 基础</h3><p>使用<code>()</code>可以达到分组的功能，使量词作用于分组</p>
<p><strong>例子</strong><br><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471097284500.png" alt="Alt text"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'a1b2c3d4'</span>.match(<span class="regexp">/([a-z]\d)&#123;3&#125;/g</span>)</span><br><span class="line"><span class="comment">// ["a1b2c3"]</span></span><br></pre></td></tr></table></figure>
<h3 id="2-8-2-或"><a href="#2-8-2-或" class="headerlink" title="2.8.2 或"></a>2.8.2 或</h3><p>使用<code>|</code>可以达到或的效果</p>
<p><strong>例子</strong><br><code>/Byr(on|Ca)sper/g</code>：<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471097817285.png" alt="Alt text"></p>
<p><code>/Byron|Casper/g</code>：<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471097772183.png" alt="Alt text"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 有分组</span></span><br><span class="line"><span class="string">'ByronsperByrCasper'</span>.match(<span class="regexp">/Byr(on|Ca)sper/g</span>)</span><br><span class="line"><span class="comment">// ["Byronsper", "ByrCasper"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 无分组</span></span><br><span class="line"><span class="string">'ByronsperByrCasper'</span>.match(<span class="regexp">/Byron|Casper/g</span>)</span><br><span class="line"><span class="comment">// ["Byron", "Casper"]</span></span><br></pre></td></tr></table></figure>
<h3 id="2-8-3-反向引用"><a href="#2-8-3-反向引用" class="headerlink" title="2.8.3 反向引用"></a>2.8.3 反向引用</h3><p><strong>例子</strong><br>2016-8-13 =&gt; 8/13/2016</p>
<p><code>/(\d+)-(\d+)-(\d+)/g</code>：<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471098062069.png" alt="Alt text"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'2016-8-13'</span>.replace(<span class="regexp">/(\d+)-(\d+)-(\d+)/g</span>, <span class="string">'$2/$3/$1'</span>)</span><br><span class="line"><span class="comment">// "8/13/2016"</span></span><br></pre></td></tr></table></figure>
<h3 id="2-8-4-忽略分组"><a href="#2-8-4-忽略分组" class="headerlink" title="2.8.4 忽略分组"></a>2.8.4 忽略分组</h3><p>不希望捕获某些分组，只需要在分组內加上<code>?:</code>就可以<br><code>(?:Byron).(ok)</code>：<img src="http://o6ul1xz4z.bkt.clouddn.com/img/1471098192119.png" alt="Alt text"></p>
<h2 id="2-9-前瞻"><a href="#2-9-前瞻" class="headerlink" title="2.9 前瞻"></a>2.9 前瞻</h2><blockquote>
<p><strong>说明：</strong>正则表达式从文本头部向尾部解析，文本尾部方向，称为<code>前</code>。<code>前瞻</code>就是在正则表达式匹配到规则的时候，向前检查是否符合断言，<code>后顾/后瞻</code>方向和<code>前瞻</code>相反。符合和不符合特定断言称为<code>肯定/正向</code>匹配和<code>否定/负向</code>匹配。<br><strong>注意</strong></p>
<ul>
<li><code>JS</code>不支持<code>后瞻/后顾</code></li>
<li><code>断言</code>部分的正则表达式只是用来断言，匹配的结果不会包括<code>断言</code>匹配到的部分</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th>名称</th>
<th>正则</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>正向前瞻</td>
<td>exp(?=assert)</td>
<td>字符串匹配到<code>exp</code>部分还不够，后面的部分必需同时配<code>assert</code></td>
</tr>
<tr>
<td>负向前瞻</td>
<td>exp(?!assert)</td>
<td>字符串匹配到<code>exp</code>部分还不够，后面的部分必需同时不能匹配配<code>assert</code></td>
</tr>
<tr>
<td>正向后顾（JS不支持）</td>
<td>exp(?=assert)</td>
<td></td>
</tr>
<tr>
<td>负向后顾（JS不支持）</td>
<td>exp(?!assert)</td>
<td></td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'a2*34v8'</span>.match(<span class="regexp">/\w(?=\d)/g</span>)</span><br><span class="line"><span class="comment">// ["a", "3", "v"]</span></span><br></pre></td></tr></table></figure>
<h2 id="2-10-对象属性"><a href="#2-10-对象属性" class="headerlink" title="2.10 对象属性"></a>2.10 对象属性</h2><p><code>RegExp</code>对象常用属性<br>属性|说明<br>-|-<br>global|是否全文搜索，默认<code>false</code><br>ignoreCase|是否大小写敏感，默认使<code>false</code><br>multiline|多行搜索，默认值是<code>false</code><br>laseIndex|是当前表达式匹配内容的最后一个字符的下一个位置，也就是下一次搜索开始的位置，在没有使用<code>g</code>修饰符时，该值始终为0<br>source|正则表达式的文本字符串</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/\bis\b/gi</span></span><br><span class="line"><span class="string">'I do because I love.This is fun. IS NOT IT?'</span>.match(reg)</span><br><span class="line"><span class="comment">// ["is", "IS"]</span></span><br><span class="line"></span><br><span class="line">reg.global</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">reg.ignoreCase</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">reg.multiline</span><br><span class="line"><span class="comment">// false</span></span><br><span class="line">reg.lastIndex</span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line">reg.source</span><br><span class="line"><span class="comment">// "\bis\b"</span></span><br></pre></td></tr></table></figure>
<h2 id="2-11-test-和-exec方法"><a href="#2-11-test-和-exec方法" class="headerlink" title="2.11 test 和 exec方法"></a>2.11 test 和 exec方法</h2><h3 id="2-11-1-RegExp-prototype-test-str"><a href="#2-11-1-RegExp-prototype-test-str" class="headerlink" title="2.11.1 RegExp.prototype.test(str)"></a>2.11.1 RegExp.prototype.test(str)</h3><blockquote>
<p><strong>功能：</strong>用于测试字符串参数中是否存在匹配正则表达式模式的字符串<br><strong>返回值：</strong>存在返回 true, 不存在返回 false</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reg1 = <span class="regexp">/\w/</span></span><br><span class="line"><span class="keyword">const</span> reg2 = <span class="regexp">/\w/g</span></span><br><span class="line"></span><br><span class="line">reg1.test(<span class="string">'abc'</span>)</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加 g 修饰符会干扰 test 函数，因为每次匹配的起点（lastIndex）会不断向后移动，最后一次匹配返回的结果一定是是false</span></span><br><span class="line"><span class="keyword">while</span>(reg2.test(<span class="string">'abc'</span>)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(reg2.lastIndex)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<h3 id="2-11-2-RegExp-prototype-exec-str"><a href="#2-11-2-RegExp-prototype-exec-str" class="headerlink" title="2.11.2 RegExp.prototype.exec(str)"></a>2.11.2 RegExp.prototype.exec(str)</h3><p><strong>非全局调用（不使用<code>g</code>修饰符）</strong></p>
<blockquote>
<p><strong>返回值：</strong>调用非全局的 <code>RegExp</code>对象的 <code>exec</code>时，返回数组</p>
<ul>
<li>第1个元素：与正则表达式相匹配的文本</li>
<li>第2个元素：与<code>RegExpObject</code>的第1个子表达式相匹配的文本（如果有的话）</li>
<li>第3个元素：与<code>RegExpObject</code>的第2个子表达式相匹配的文本（如果有的话）<br>…</li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reg = <span class="regexp">/\d(\w)(\w)\d/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = reg.exec(<span class="string">'1az2bb3cv4d5eee'</span>)</span><br><span class="line"></span><br><span class="line">result<span class="comment">// ["1az2", "a", "z"]</span></span><br></pre></td></tr></table></figure>
<p><strong>全局调用（使用<code>g</code>修饰符）</strong></p>
<blockquote>
<p><strong>功能：</strong>使用正则表达式模式对字符串执行搜索，并将更新全局 (使用g)<code>RegExp</code>对象的属性以反应匹配结果<br><strong>返回值：</strong>如果没有匹配的文本则返回<code>null</code>，否则返回一个结果数组：</p>
<ul>
<li>index：声明匹配文本的第一个字符的位置</li>
<li>input：存放被检索的字符串</li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reg = <span class="regexp">/\d(\w)(\w)\d/g</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result, str = <span class="string">'1az2bb3cv4d5eee'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(result = reg.exec(str)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(reg.lastIndex)</span><br><span class="line">  <span class="built_in">console</span>.log(result.index)</span><br><span class="line">  <span class="built_in">console</span>.log(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 6</span></span><br><span class="line"><span class="comment">// ["3cv4", "c", "v"]</span></span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ["1az2", "a", "z"]</span></span><br><span class="line"><span class="comment">// 10</span></span><br><span class="line"><span class="comment">// 6</span></span><br><span class="line"><span class="comment">// ["3cv4", "c", "v"]</span></span><br></pre></td></tr></table></figure>
<h2 id="2-12-字符串对象方法"><a href="#2-12-字符串对象方法" class="headerlink" title="2.12 字符串对象方法"></a>2.12 字符串对象方法</h2><h3 id="2-12-1-String-prototype-search"><a href="#2-12-1-String-prototype-search" class="headerlink" title="2.12.1 String.prototype.search"></a>2.12.1 String.prototype.search</h3><p><strong>功能：</strong>用于检索字符串中指定的子字符串，或检索与正则表达式相匹配的子字符串<br><strong>参数（1）：</strong><code>Regexp</code>对象（如果是其它类型，将会被当做正则表达式字符串处理）<br><strong>返回值：</strong>返回第一个匹配到的结果的 index， 查找不到返回 -1<br><strong>注意：</strong>该方法将忽略修饰符<code>g</code>，不执行全文匹配，并且总是从字符串的开始进行检索</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result, str = <span class="string">'1az2bb3cv4d51eee'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 正则表达式</span></span><br><span class="line">str.search(<span class="regexp">/v4/</span>)<span class="comment">// 8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串</span></span><br><span class="line">str.search(<span class="string">'1'</span>)<span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数字，会被转为字符串</span></span><br><span class="line">str.search(<span class="number">1</span>)<span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<h3 id="2-12-2-String-prototype-match"><a href="#2-12-2-String-prototype-match" class="headerlink" title="2.12.2 String.prototype.match"></a>2.12.2 String.prototype.match</h3><blockquote>
<p><strong>功能：</strong>将检索字符串，以找到一个或多个与 regexp 匹配的文本<br><strong>参数（1）：</strong><code>RegExp</code>对象（如果是其它类型，将会被当做正则表达式字符串处理，内部仍旧会处理为一个 <code>RegExp</code>对象）<br><strong>返回值：</strong>如果没有找到任何匹配的文本，将返回 <code>null</code>；否则将返回一个数组，其中存放了与它找到的匹配文本有关的信息</p>
</blockquote>
<p>＃非全局调用<br>返回数组的元素下标|说明<br>-|-<br>0|匹配的文本<br>其它|与正则表达式的子表达式匹配的文本</p>
<table>
<thead>
<tr>
<th>返回数组的对象属性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>index</td>
<td>声明匹配文本的起始字符在字符串的位置</td>
</tr>
<tr>
<td>input</td>
<td>声明对 stringObject 的引用</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'1az2bb3cv4d51eee6f7'</span>.match(<span class="regexp">/\d(\w)\d/</span>)<span class="comment">// ["4d5", "d"]</span></span><br></pre></td></tr></table></figure>
<p>＃全局调用<br>如果 <code>RegExp</code>具有标志<code>g</code>则 <code>match</code>方法将执行全文搜索，找到字符串中的所有匹配子字符串。返回的数组没有 <code>index</code> 属性或<code>input</code>属性<br>返回数组的元素下标|说明<br>-|-<br>all|所有匹配的子串</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'1az2bb3cv4d51eee6f7'</span>.match(<span class="regexp">/\d(\w)\d/g</span>)<span class="comment">// ["4d5", "6f7"]</span></span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 如果<code>RegExp</code>没有标志<code>g</code>，那么<code>match</code>方法只能在字符串中执行一次匹配</p>
<h3 id="2-12-3-String-prototype-split"><a href="#2-12-3-String-prototype-split" class="headerlink" title="2.12.3 String.prototype.split"></a>2.12.3 String.prototype.split</h3><blockquote>
<p><strong>功能：</strong>我们经常使用<code>split</code>方法把字符串分割为字符数组，在一些复杂的分割情况下我们可以使用正则表达式解决<br><strong>参数（1）：</strong><code>RegExp</code>对象（如果是其它类型，将会被当做正则表达式字符串处理，内部仍旧会处理为一个 <code>RegExp</code>对象）</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'a,b,c,d'</span>.split(<span class="string">','</span>)<span class="comment">// ["a", "b", "c", "d"]</span></span><br><span class="line"><span class="string">'a1b2c3d'</span>.split(<span class="regexp">/\d/</span>)<span class="comment">// ["a", "b", "c", "d"]</span></span><br></pre></td></tr></table></figure>
<h3 id="2-12-4-String-prototype-replace"><a href="#2-12-4-String-prototype-replace" class="headerlink" title="2.12.4 String.prototype.replace"></a>2.12.4 String.prototype.replace</h3><blockquote>
<p><strong>功能：</strong>将匹配到的字符串中的字串替换为指定字符串并返回<br><strong>参数（2）：</strong></p>
<ul>
<li>String.prototype.replace(str, replaceStr)</li>
<li>String.prototype.replace(reg, replaceStr)</li>
<li>String.prototype.replace(reg, <code>function</code>)</li>
</ul>
</blockquote>
<p><code>function</code>会在每次匹配替换的时候调用，有4个参数<br>参数|说明<br>-|-<br>1|匹配字符串<br>2|正则表达式分组内容，没有分组则没有该参数<br>3|匹配项在字符串中的 index<br>4|原字符串<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* str, replaceStr */</span></span><br><span class="line"><span class="string">'a1b1c1d'</span>.replace(<span class="string">'1'</span>, <span class="string">'2'</span>)<span class="comment">// "a2b1c1d"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* reg, replaceStr */</span></span><br><span class="line"><span class="string">'a1b1c1d'</span>.replace(<span class="regexp">/1/g</span>, <span class="string">'2'</span>)<span class="comment">// "a2b2c2d"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* reg, function */</span></span><br><span class="line"><span class="comment">// 不带分组</span></span><br><span class="line"><span class="string">'a1b1c1d'</span>.replace(<span class="regexp">/\d/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">match, index, origin</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">parseInt</span>(match) + <span class="number">1</span></span><br><span class="line">&#125;)<span class="comment">// "a2b2c2d"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 带分组</span></span><br><span class="line"><span class="string">'a1b2c3d4e5'</span>.replace(<span class="regexp">/(\d)(\w)(\d)/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">match, group1, group2, group3, index, origin</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> group1 + group3</span><br><span class="line">&#125;)<span class="comment">// "a12c34e5"</span></span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/24/Blog_webpack入坑之旅/" itemprop="url">
                  webpack入坑之旅
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-24T11:29:16+08:00" content="2016-08-24">
              2016-08-24
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/24/Blog_webpack入坑之旅/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/24/Blog_webpack入坑之旅/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><strong>博客链接：</strong><a href="http://guowenfh.github.io/2016/03/24/vue-webpack-01-base/" target="_blank" rel="external">http://guowenfh.github.io/2016/03/24/vue-webpack-01-base/</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ npm i webpack -g</span><br><span class="line"></span><br><span class="line"><span class="comment"># 项目初始化</span></span><br><span class="line">$ mkdir vue_by_webpack_blog &amp;&amp; <span class="built_in">cd</span> vue_by_webpack_blog</span><br><span class="line">$ npm init</span><br><span class="line">$ npm i webpack -D <span class="comment"># --save-dev</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><em>目录</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── bundle.js</span><br><span class="line">├── entry.js</span><br><span class="line">├── index.html</span><br><span class="line">├── node_modules</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure></p>
<h1 id="1-最简单的开始"><a href="#1-最简单的开始" class="headerlink" title="1 最简单的开始"></a>1 最简单的开始</h1><p>不使用 <code>webpack</code> 配置文件</p>
<p><em>目录</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── bundle.js</span><br><span class="line">├── entry.js <span class="comment">#1</span></span><br><span class="line">├── first.js <span class="comment">#2</span></span><br><span class="line">├── index.html <span class="comment">#3</span></span><br><span class="line">├── index.html</span><br><span class="line">├── node_modules</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure></p>
<hr>
<p><em>#1 entry.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** entry.js **/</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'app'</span>).innerHTML = <span class="string">"第一个成功打包的程序"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./first.js'</span>);</span><br></pre></td></tr></table></figure></p>
<p><em># 2 first.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> h2 = <span class="built_in">document</span>.createElement(<span class="string">'h2'</span>);</span><br><span class="line">h2.innerHTML = <span class="string">'不是吧，那么快就第二个打包程序了'</span>;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(h2);</span><br></pre></td></tr></table></figure></p>
<p><em>#3 index.html</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 引入 webpack 生成的文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ webpack entry.js bundle.js <span class="comment"># 打包</span></span><br><span class="line"></span><br><span class="line">Hash: bd78725bb04725a3c1f9</span><br><span class="line">Version: webpack 1.13.1</span><br><span class="line">Time: 88ms</span><br><span class="line">    Asset     Size  Chunks             Chunk Names</span><br><span class="line">bundle.js  1.67 kB       0  [emitted]  main</span><br><span class="line">   [0] ./entry.js 97 bytes &#123;0&#125; [built]</span><br><span class="line">   [1] ./first.js 104 bytes &#123;0&#125; [built]</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1468494421937.png" alt="Alt text"></p>
<h1 id="2-loader"><a href="#2-loader" class="headerlink" title="2 loader"></a>2 loader</h1><h2 id="2-1-处理css"><a href="#2-1-处理css" class="headerlink" title="2.1 处理css"></a>2.1 处理css</h2><p><strong>目录</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── bundle.js</span><br><span class="line">├── entry.js <span class="comment"># 1</span></span><br><span class="line">├── first.js</span><br><span class="line">├── index.html</span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">└── style.css <span class="comment"># 2</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm i css-loader -D <span class="comment"># 读取 css 的 loader</span></span><br><span class="line">$ npm i style-loader -D <span class="comment"># 将 css 插入页面的 loader</span></span><br></pre></td></tr></table></figure>
<hr>
<p><em># 1 entry.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">require(<span class="string">'!style!css!./style.css'</span>);<span class="comment">// 需要 !style!css! 前缀</span></span><br></pre></td></tr></table></figure></p>
<p><em>#2 style.css</em><br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">bady</span> &#123;</span><br><span class="line">	<span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ webpack entry.js bundle.js</span><br></pre></td></tr></table></figure>
<p><img src="http://o6ul1xz4z.bkt.clouddn.com/img/1468494451555.png" alt="Alt text"></p>
<h2 id="2-2-根据扩展名自动绑定-loader"><a href="#2-2-根据扩展名自动绑定-loader" class="headerlink" title="2.2 根据扩展名自动绑定 loader"></a>2.2 根据扩展名自动绑定 loader</h2><p><code>entry.js</code>中的<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'!style!css!./style.css'</span>)</span><br></pre></td></tr></table></figure></p>
<p>可以省略前缀<code>!style!css!</code>，改为:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'./style.css'</span>)</span><br></pre></td></tr></table></figure></p>
<p>但相应的打包命令就变为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ webpack ./entry.js bundle.js --module-bind <span class="string">"css=style\!css"</span></span><br></pre></td></tr></table></figure></p>
<h1 id="3-webpack-config"><a href="#3-webpack-config" class="headerlink" title="3 webpack.config"></a>3 webpack.config</h1><p><strong>目录</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── bundle.js</span><br><span class="line">├── entry.js</span><br><span class="line">├── first.js</span><br><span class="line">├── index.html</span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">├── style.css</span><br><span class="line">└── webpack.config.js <span class="comment"># 1</span></span><br></pre></td></tr></table></figure></p>
<hr>
<p><em>#1 webpack.config.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);<span class="comment">// 必须引入</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 指入口文件的配置项，它是一个数组的原因是webpack允许多个入口点。 当然如果你只有一个入口的话，也可以直接使用双引号"./entry.js"</span><br><span class="line">	 * @type &#123;Array&#125;</span><br><span class="line">	 */</span></span><br><span class="line">	entry: [</span><br><span class="line">		<span class="string">"./entry.js"</span></span><br><span class="line">	],</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 置打包结果，path定义了输出的文件夹，filename则定义了打包结果文件的名称</span><br><span class="line">	 * @type &#123;Object&#125;</span><br><span class="line">	 */</span></span><br><span class="line">	output: &#123;</span><br><span class="line">		path: __dirname,</span><br><span class="line">		filename: <span class="string">'bundle.js'</span></span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 定义了对模块的处理逻辑，这里可以用loaders定义了一系列的加载器，以及一些正则。当需要加载的文件匹配test的正则时，就会调用后面的loader对文件进行处理</span><br><span class="line">	 * @type &#123;Object&#125;</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="built_in">module</span>: &#123;</span><br><span class="line">		loaders: [</span><br><span class="line">			<span class="comment">/* 针对所有的 css 后缀的文件，使用 css-loader 读取，并使用 style-loader 插入到页面 */</span></span><br><span class="line">			&#123;</span><br><span class="line">				test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">				loader: <span class="string">'style!css'</span></span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 插件可以完成更多loader不能完成的功能</span><br><span class="line">	 * @type &#123;Array&#125;</span><br><span class="line">	 */</span></span><br><span class="line">	plugins: [</span><br><span class="line">		<span class="keyword">new</span> Webpack.BannerPlugin(<span class="string">"这里是打包文件头部注释！"</span>)</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ webpack <span class="comment"># 会自动在当前目录中查找webpack.config.js的配置文件</span></span><br><span class="line">Hash: 4bd595f27c8112d7d21f</span><br><span class="line">Version: webpack 1.13.1</span><br><span class="line">Time: 2059ms</span><br><span class="line">    Asset   Size  Chunks             Chunk Names</span><br><span class="line">bundle.js  12 kB       0  [emitted]  main</span><br><span class="line">   [0] multi main 28 bytes &#123;0&#125; [built]</span><br><span class="line">   [1] ./entry.js 133 bytes &#123;0&#125; [built]</span><br><span class="line">   [2] ./first.js 104 bytes &#123;0&#125; [built]</span><br><span class="line">    + 4 hidden modules</span><br></pre></td></tr></table></figure>
<h1 id="4-高级"><a href="#4-高级" class="headerlink" title="4 高级"></a>4 高级</h1><h2 id="4-1-图片"><a href="#4-1-图片" class="headerlink" title="4.1 图片"></a>4.1 图片</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install file-loader -D</span><br><span class="line">$ npm install url-loader -D <span class="comment"># 用来处理图片</span></span><br></pre></td></tr></table></figure>
<p><strong>目录</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── bundle.js</span><br><span class="line">├── entry.js</span><br><span class="line">├── first.js</span><br><span class="line">├── img</span><br><span class="line">│   ├── big.png</span><br><span class="line">│   └── small.png</span><br><span class="line">├── index.html <span class="comment"># 1</span></span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">├── selectarea.mov</span><br><span class="line">├── style.css <span class="comment"># 2</span></span><br><span class="line">└── webpack.config.js <span class="comment"># 3</span></span><br></pre></td></tr></table></figure></p>
<hr>
<p><em>#1 index.html</em><br><figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">...</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/small.png"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"big"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"small"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">...</span></span><br></pre></td></tr></table></figure></p>
<p><em>#2 style.css</em><br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="selector-id">#big</span> &#123;</span><br><span class="line">	<span class="attribute">background-image</span>: <span class="built_in">url</span>(img/big.png);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#small</span> &#123;</span><br><span class="line">	<span class="attribute">background-image</span>: <span class="built_in">url</span>(img/small.png);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>#3 webpack.config.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);<span class="comment">// 必须引入</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">	module: &#123;</span><br><span class="line">		loaders: [</span><br><span class="line">			...</span><br><span class="line">			<span class="comment">/* 图片处理 */</span></span><br><span class="line">			&#123;</span><br><span class="line">				test: <span class="regexp">/\.(png|jpg)$/</span>,</span><br><span class="line">				loader: <span class="string">'url-loader?limit=8192'</span><span class="comment">// 设置limit，小于8K的图片图片转化成了base64的编码，而大于8k的图片则不会转化</span></span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;,</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ webpack</span><br></pre></td></tr></table></figure>
<h2 id="4-2-webpack命令选项"><a href="#4-2-webpack命令选项" class="headerlink" title="4.2 webpack命令选项"></a>4.2 webpack命令选项</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">webpack <span class="comment">#最基本的启动webpack命令</span></span><br><span class="line">webpack -w <span class="comment">#提供watch方法，实时进行打包更新</span></span><br><span class="line">webpack -p <span class="comment">#对打包后的文件进行压缩</span></span><br><span class="line">webpack <span class="_">-d</span> <span class="comment">#提供SourceMaps，方便调试</span></span><br><span class="line">webpack --colors <span class="comment">#输出结果带彩色，比如：会用红色显示耗时较长的步骤</span></span><br><span class="line">webpack --profile <span class="comment">#输出性能数据，可以看到每一步的耗时</span></span><br><span class="line">webpack --display-modules <span class="comment">#默认情况下 node_modules 下的模块会被隐藏，加上这个参数可以显示这些被隐藏的模块</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-1-watch-热加载"><a href="#4-2-1-watch-热加载" class="headerlink" title="4..2.1 watch(热加载)"></a>4..2.1 watch(热加载)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ webpack --watch <span class="comment"># webpack -w</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-2-liveload-自动刷新-vue"><a href="#4-2-2-liveload-自动刷新-vue" class="headerlink" title="4.2.2 liveload(自动刷新) + vue"></a>4.2.2 liveload(自动刷新) + vue</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># liveload</span></span><br><span class="line">$ npm i webpack-dev-server -g</span><br><span class="line"></span><br><span class="line"><span class="comment"># vue</span></span><br><span class="line">$ npm i vue -S</span><br></pre></td></tr></table></figure>
<p><strong>目录</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">├── bundle.js</span><br><span class="line">├── entry.js <span class="comment"># 1</span></span><br><span class="line">├── first.js</span><br><span class="line">├── img</span><br><span class="line">├── index.html <span class="comment"># 2</span></span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">├── selectarea.mov</span><br><span class="line">├── style.css</span><br><span class="line">└── webpack.config.js</span><br></pre></td></tr></table></figure></p>
<hr>
<p><em># 1 entry.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'./first.js'</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'!style!css!./style.css'</span>);</span><br><span class="line"><span class="keyword">var</span> Vue = <span class="built_in">require</span>(<span class="string">'vue'</span>);</span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">	el: <span class="string">'body'</span>,</span><br><span class="line">	data: &#123;</span><br><span class="line">		message: <span class="string">'Hello Vue.js'</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><em># 2 index.html</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">	&#123;&#123; message &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ webpack-dev-server <span class="comment"># 实时预览：http://localhost:8080/webpack-dev-server/</span></span><br></pre></td></tr></table></figure>
<h1 id="5-加载vue单文件组织"><a href="#5-加载vue单文件组织" class="headerlink" title="5 加载vue单文件组织"></a>5 加载vue单文件组织</h1><p><strong>初始目录</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── index.html</span><br><span class="line">├── src</span><br><span class="line">│   ├── components <span class="comment"># 组件</span></span><br><span class="line">│   └── main.js <span class="comment"># 入口</span></span><br><span class="line">└── webpack.config.js</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>初始化依赖</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># package.json</span></span><br><span class="line">$ npm init</span><br><span class="line"></span><br><span class="line"><span class="comment"># vue</span></span><br><span class="line">$ npm i vue -S</span><br><span class="line"></span><br><span class="line"><span class="comment"># webpack</span></span><br><span class="line">$ npm i webpack -D</span><br><span class="line"></span><br><span class="line"><span class="comment"># babel</span></span><br><span class="line">$ npm i babel -D <span class="comment"># es6</span></span><br><span class="line">$ npm i babel-core -D</span><br><span class="line">$ npm i babel-plugin-transform-runtime -D</span><br><span class="line">$ npm i babel-preset-es2015 -D <span class="comment"># babel</span></span><br><span class="line">$ npm i babel-runtime -D</span><br><span class="line"></span><br><span class="line"><span class="comment"># webpack loader</span></span><br><span class="line">$ npm i autoprefixer-loader -D <span class="comment"># css 浏览器前缀</span></span><br><span class="line">$ npm i babel-loader -D</span><br><span class="line">$ npm i css-loader -D</span><br><span class="line">$ npm i file-loader -D</span><br><span class="line">$ npm i html-loader -D</span><br><span class="line">$ npm i node-sass -D</span><br><span class="line">$ npm i sass-loader -D</span><br><span class="line">$ npm i style-loader -D</span><br><span class="line">$ npm i url-loader -D</span><br><span class="line">$ npm i vue-html-loader -D</span><br><span class="line">$ npm i vue-loader -D</span><br><span class="line">$ npm i vue-style-loader -D</span><br><span class="line">$ npm i vue-hot-reload-api -D</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>完成后目录</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">├── index.html <span class="comment"># 1</span></span><br><span class="line">├── node_modules</span><br><span class="line">├── npm-debug.log</span><br><span class="line">├── package.json <span class="comment"># 2</span></span><br><span class="line">├── src</span><br><span class="line">│   ├── components</span><br><span class="line">│   │   └── app.vue <span class="comment"># 3</span></span><br><span class="line">│   └── main.js <span class="comment"># 4</span></span><br><span class="line">└── webpack.config.js <span class="comment"># 5</span></span><br></pre></td></tr></table></figure></p>
<hr>
<p><em>#1 index.html</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>webpack vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span><br><span class="line">        <span class="selector-id">#app</span> &#123;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">20px</span> auto;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">800px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">600px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"dist/main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><em>#2 package.json</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"vue_by_webpack_blog_spa"</span>,</span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="string">"description"</span>: <span class="string">"study vue"</span>,</span><br><span class="line">  <span class="string">"main"</span>: <span class="string">"webpack.config.js"</span>,</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"webpack-dev-server --inline"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"author"</span>: <span class="string">"mengqingshen"</span>,</span><br><span class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"vue"</span>: <span class="string">"^1.0.26"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"autoprefixer-loader"</span>: <span class="string">"^3.2.0"</span>,</span><br><span class="line">    <span class="string">"babel"</span>: <span class="string">"^6.5.2"</span>,</span><br><span class="line">    <span class="string">"babel-core"</span>: <span class="string">"^6.10.4"</span>,</span><br><span class="line">    <span class="string">"babel-loader"</span>: <span class="string">"^6.2.4"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-transform-runtime"</span>: <span class="string">"^6.9.0"</span>,</span><br><span class="line">    <span class="string">"babel-preset-es2015"</span>: <span class="string">"^6.9.0"</span>,</span><br><span class="line">    <span class="string">"babel-runtime"</span>: <span class="string">"^6.9.2"</span>,</span><br><span class="line">    <span class="string">"css-loader"</span>: <span class="string">"^0.23.1"</span>,</span><br><span class="line">    <span class="string">"file-loader"</span>: <span class="string">"^0.9.0"</span>,</span><br><span class="line">    <span class="string">"html-loader"</span>: <span class="string">"^0.4.3"</span>,</span><br><span class="line">    <span class="string">"node-sass"</span>: <span class="string">"^3.8.0"</span>,</span><br><span class="line">    <span class="string">"sass-loader"</span>: <span class="string">"^4.0.0"</span>,</span><br><span class="line">    <span class="string">"style-loader"</span>: <span class="string">"^0.13.1"</span>,</span><br><span class="line">    <span class="string">"url-loader"</span>: <span class="string">"^0.5.7"</span>,</span><br><span class="line">    <span class="string">"vue-hot-reload-api"</span>: <span class="string">"^2.0.5"</span>,</span><br><span class="line">    <span class="string">"vue-html-loader"</span>: <span class="string">"^1.2.3"</span>,</span><br><span class="line">    <span class="string">"vue-loader"</span>: <span class="string">"^8.5.3"</span>,</span><br><span class="line">    <span class="string">"vue-style-loader"</span>: <span class="string">"^1.0.0"</span>,</span><br><span class="line">    <span class="string">"webpack"</span>: <span class="string">"^1.13.1"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>#3 app.vue</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span><br><span class="line">    <span class="comment">/* es6 */</span></span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">        el:<span class="string">"#app"</span>,</span><br><span class="line">         <span class="comment">/* data:function()&#123;&#125;，下面是es6写法 */</span></span><br><span class="line">         data () &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                name:<span class="string">"laputa"</span>,</span><br><span class="line">                age:<span class="string">"2q1"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"sass"</span>&gt;</span><span class="undefined"></span><br><span class="line">    /* 一定要加 lang 不然无法编译 */</span><br><span class="line">    /*测试一下对sass的编译*/</span><br><span class="line">    $qwe:#098;</span><br><span class="line">    body&#123;</span><br><span class="line">        background-color: $qwe;</span><br><span class="line">        h1&#123;</span><br><span class="line">            background-color: #eee;</span><br><span class="line">            color: red;</span><br><span class="line">            transform: translate(10%, 10%);/*测试自动添加前缀*/</span><br><span class="line">        &#125;</span><br><span class="line">        h1:hover&#123;</span><br><span class="line">            height:100px;</span><br><span class="line">        &#125;</span><br><span class="line">        h2&#123;</span><br><span class="line">            background-color: #999;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><em>#4 main.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//es6语法，其实不用写完，会自动查找。可以直接写import Vue from "vue";</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"../node_modules/vue/dist/vue.min.js"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//引入我们编写的测试用vue文件。</span></span><br><span class="line"><span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">'./components/app'</span>;</span><br><span class="line">Vue.config.debug = <span class="literal">true</span>;<span class="comment">//开启错误提示</span></span><br><span class="line"><span class="keyword">new</span> Vue(app);</span><br></pre></td></tr></table></figure></p>
<p><em>#5 webpack.config.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * NodeJS中的Path对象，用于处理目录的对象，提高开发效率。</span><br><span class="line"> * @type &#123;Object&#125;</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 模块导入 */</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 入口文件地址，不需要写完，会自动查找</span><br><span class="line">     * @type &#123;String|Array&#125;</span><br><span class="line">     */</span></span><br><span class="line">    entry: <span class="string">'./src/main'</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 输出</span><br><span class="line">     * @type &#123;Object&#125;</span><br><span class="line">     */</span></span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>),<span class="comment">// 文件地址，使用绝对路径形式</span></span><br><span class="line">        filename: <span class="string">'[name].js'</span>,<span class="comment">// [name]这里是 webpack 提供的根据入口文件自动生成的名字</span></span><br><span class="line">        publicPath: <span class="string">'/dist/'</span><span class="comment">// 公共文件生成的地址</span></span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 服务器配置相关，自动刷新!</span><br><span class="line">     * @type &#123;Object&#125;</span><br><span class="line">     */</span></span><br><span class="line">    devServer: &#123;</span><br><span class="line">        historyApiFallback: <span class="literal">true</span>,</span><br><span class="line">        hot: <span class="literal">false</span>,<span class="comment">// 全局刷新</span></span><br><span class="line">        inline: <span class="literal">true</span>,</span><br><span class="line">        progress: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 加载器</span><br><span class="line">     * @type &#123;Object&#125;</span><br><span class="line">     */</span></span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        loaders: [</span><br><span class="line">            <span class="comment">/* 解析.vue文件 */</span></span><br><span class="line">            &#123; test: <span class="regexp">/\.vue$/</span>, loader: <span class="string">'vue'</span> &#125;,</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/* 转化ES6的语法 */</span></span><br><span class="line">            &#123; test: <span class="regexp">/\.js$/</span>, loader: <span class="string">'babel'</span>, exclude: <span class="regexp">/node_modules/</span> &#125;,</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/* 编译css并自动添加css前缀 */</span></span><br><span class="line">            &#123; test: <span class="regexp">/\.css$/</span>, loader: <span class="string">'style!css!autoprefixer'</span>&#125;,</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/* .scss 文件想要编译，scss就需要这些东西！来编译处理 </span><br><span class="line">            install css-loader style-loader sass-loader node-sass --save-dev */</span></span><br><span class="line">            &#123; test: <span class="regexp">/\.scss$/</span>, loader: <span class="string">'style!css!sass?sourceMap'</span>&#125;,</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 图片转化，小于8K自动转化为base64的编码 */</span></span><br><span class="line">            &#123; test: <span class="regexp">/\.(png|jpg|gif)$/</span>, loader: <span class="string">'url-loader?limit=8192'</span>&#125;,</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/* html模板编译 */</span></span><br><span class="line">            &#123; test: <span class="regexp">/\.(html|tpl)$/</span>, loader: <span class="string">'html-loader'</span> &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * .vue的配置。需要单独出来配置，其实没什么必要--因为我删了也没保错，不过这里就留这把，因为官网文档里是可以有单独的配置的。</span><br><span class="line">     * @type &#123;Object&#125;</span><br><span class="line">     */</span></span><br><span class="line">    vue: &#123;</span><br><span class="line">        loaders: &#123;</span><br><span class="line">            css: <span class="string">'style!css!autoprefixer'</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 转化成es5的语法</span><br><span class="line">     * @type &#123;Object&#125;</span><br><span class="line">     */</span></span><br><span class="line">    babel: &#123;</span><br><span class="line">        presets: [<span class="string">'es2015'</span>],</span><br><span class="line">        plugins: [<span class="string">'transform-runtime'</span>]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    resolve: &#123;</span><br><span class="line">        <span class="comment">/* require时省略的扩展名，如：require('module') 不需要module.js */</span></span><br><span class="line">        extensions: [<span class="string">''</span>, <span class="string">'.js'</span>, <span class="string">'.vue'</span>],</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 别名，可以直接使用别名来代表设定的路径以及其他 */</span></span><br><span class="line">        alias: &#123;</span><br><span class="line">            filter: path.join(__dirname, <span class="string">'./src/filters'</span>),</span><br><span class="line">            components: path.join(__dirname, <span class="string">'./src/components'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 开启source-map，webpack有多种source-map，在官网文档可以查到 */</span></span><br><span class="line">    devtool: <span class="string">'eval-source-map'</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http://localhost:8080/</span></span><br><span class="line">$ npm start</span><br></pre></td></tr></table></figure>
<h1 id="6-vue组件"><a href="#6-vue组件" class="headerlink" title="6 vue组件"></a>6 vue组件</h1><h1 id="7-vue-router"><a href="#7-vue-router" class="headerlink" title="7 vue-router"></a>7 vue-router</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i vue-loader -D</span><br></pre></td></tr></table></figure>
<p><strong>目录</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── dist</span><br><span class="line">│   └── main.js</span><br><span class="line">├── index.html<span class="comment"># 1 页面入口</span></span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">├── src</span><br><span class="line">│   ├── components</span><br><span class="line">│   │   ├── app.vue <span class="comment"># 2 组件1，嵌套了组件2</span></span><br><span class="line">│   │   ├── hello.vue <span class="comment"># 3 组件2</span></span><br><span class="line">│   │   └── list.vue <span class="comment"># 4 组件3</span></span><br><span class="line">│   └── main.js <span class="comment"># 5 实例化 vue 组件；初始化路由</span></span><br><span class="line">└── webpack.config.js</span><br></pre></td></tr></table></figure></p>
<hr>
<p><em># 1 index.html</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>webpack vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span><br><span class="line">        *, *<span class="selector-pseudo">:beofre</span>, *<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">            <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-tag">body</span>, <span class="selector-tag">html</span> &#123;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">            <span class="attribute">overflow</span>: hidden;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-id">#app</span> &#123;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">20px</span> auto;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">800px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">600px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 路由视图 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"dist/main.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><em>#2 app.vue</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span><br><span class="line">    <span class="keyword">import</span> hello <span class="keyword">from</span> <span class="string">'./hello.vue'</span></span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">        data () &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                name: <span class="string">'laputa'</span>,</span><br><span class="line">                age: <span class="string">'26'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            golist () &#123;</span><br><span class="line">                <span class="keyword">this</span>.$route.router.go(&#123;name: <span class="string">'list'</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        components: &#123;</span><br><span class="line">            hello</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"overflow: hidden;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"golist"</span>&gt;</span>$toute.router.go查看<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">v-link</span>=<span class="string">"&#123;name: 'list'&#125;"</span>&gt;</span>v-link查看列表<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">v-link</span>=<span class="string">"&#123;name: 'index'&#125;"</span>&gt;</span>回去主页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">v-link</span>=<span class="string">"&#123;name: 'hello'&#125;"</span>&gt;</span>嵌套的路由<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 嵌套其它 vue 组件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hello</span>&gt;</span><span class="tag">&lt;/<span class="name">hello</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 嵌套路由显示视图 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"sass"</span>&gt;</span><span class="undefined"></span><br><span class="line">    $qwe:pink;</span><br><span class="line">    body &#123;</span><br><span class="line">        background-color: $qwe;</span><br><span class="line">        color: red;</span><br><span class="line">    &#125;</span><br><span class="line">    h1 &#123;</span><br><span class="line">        background-color: blue;</span><br><span class="line">        color: red;</span><br><span class="line">    &#125;</span><br><span class="line">    h2 &#123;</span><br><span class="line">        background-color: purple;</span><br><span class="line">    &#125;</span><br><span class="line">    a &#123;</span><br><span class="line">        display: block;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">    &#125;</span><br><span class="line">    button &#123;</span><br><span class="line">        float: left;</span><br><span class="line">    &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><em># 3 组件2</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">        data () &#123;</span><br><span class="line">           <span class="keyword">return</span> &#123;</span><br><span class="line">                hello:<span class="string">"这里是嵌套路由！！！1"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;hello&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span><br><span class="line">    <span class="selector-tag">div</span>&#123;</span><br><span class="line">        <span class="attribute">text-shadow</span>: <span class="number">1px</span> <span class="number">1px</span> <span class="number">10px</span> <span class="number">#000</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><em>#4 组件3</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span><br><span class="line">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">		data () &#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;</span><br><span class="line">				peoples: [&#123;</span><br><span class="line">					name: <span class="string">'小红'</span>,</span><br><span class="line">					age: <span class="number">20</span></span><br><span class="line">				&#125;, &#123;</span><br><span class="line">					name: <span class="string">'张三'</span>,</span><br><span class="line">					age: <span class="number">12</span></span><br><span class="line">				&#125;, &#123;</span><br><span class="line">					name: <span class="string">'三五'</span>,</span><br><span class="line">					age: <span class="number">78</span></span><br><span class="line">				&#125;, &#123;</span><br><span class="line">					name: <span class="string">'阿文'</span>,</span><br><span class="line">					age: <span class="number">22</span></span><br><span class="line">				&#125;,</span><br><span class="line">				&#123;</span><br><span class="line">					name: <span class="string">'李六'</span>,</span><br><span class="line">					age: <span class="number">87</span></span><br><span class="line">				&#125;]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"person in peoples"</span>&gt;</span></span><br><span class="line">			&#123;&#123;person.name&#125;&#125;: &#123;&#123;person.age&#125;&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span><br><span class="line">	<span class="selector-tag">li</span> &#123;</span><br><span class="line">		<span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">		<span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">		<span class="attribute">list-style</span>: none;</span><br><span class="line">	&#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><em>#5 main.js</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//es6语法，其实不用写完，会自动查找。可以直接写import Vue from "vue";</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 引入第三方库 */</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'../node_modules/vue/dist/vue.min.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(VueRouter);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 引入自定义的 vue 组件 */</span></span><br><span class="line"><span class="keyword">import</span> index <span class="keyword">from</span> <span class="string">'./components/app.vue'</span>;</span><br><span class="line"><span class="keyword">import</span> list <span class="keyword">from</span> <span class="string">'./components/list'</span>;</span><br><span class="line"><span class="keyword">import</span> hello <span class="keyword">from</span> <span class="string">'./components/hello'</span>;</span><br><span class="line"></span><br><span class="line">Vue.config.debug = <span class="literal">true</span>;<span class="comment">//开启错误提示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 创建根组件 */</span></span><br><span class="line"><span class="keyword">var</span> App = Vue.extend(&#123;&#125;);<span class="comment">// 路由器需要一个根组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 创建一个路由器实例 */</span></span><br><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter();<span class="comment">// 创建实例时可以传入配置参数进行定制，为保持简单，这里使用默认配置</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义路由规则 */</span></span><br><span class="line"><span class="comment">// 每条路由规则应该映射到一个组件。这里的“组件”可以是一个使用 Vue.extend</span></span><br><span class="line"><span class="comment">// 创建的组件构造函数，也可以是一个组件选项对象。</span></span><br><span class="line">router.map(&#123;</span><br><span class="line">	<span class="string">'index'</span>: &#123;</span><br><span class="line">		name: <span class="string">'index'</span>,</span><br><span class="line">		component: index,</span><br><span class="line">		<span class="comment">// 在/index下设置一个子路由</span></span><br><span class="line">		<span class="comment">// 当匹配到/index/hello时，会在index的&lt;router-view&gt;内渲染</span></span><br><span class="line">		subRoutes: &#123;</span><br><span class="line">			<span class="string">'hello'</span>: &#123;</span><br><span class="line">				name: <span class="string">'hello'</span>,</span><br><span class="line">				component: hello</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">'/list'</span>: &#123;</span><br><span class="line">		name: <span class="string">'list'</span>,</span><br><span class="line">		component: list</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.redirect(&#123;</span><br><span class="line">	<span class="string">'*'</span>: <span class="string">'index'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 启动应用 */</span></span><br><span class="line">router.start(App, <span class="string">'#app'</span>);<span class="comment">// 路由器会创建一个 App 实例，并且挂载到选择符 #app 匹配的元素上。</span></span><br></pre></td></tr></table></figure></p>
<hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm start</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Sean" />
          <p class="site-author-name" itemprop="name">Sean</p>
          <p class="site-description motion-element" itemprop="description">整理了一批过去一段时间ios相关的笔记，其它的笔记也整理下？源码分享出来？再说吧...反正也只有自己会看吧...</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">94</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sean</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"lapuda-er"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  

</body>
</html>
